/*!
 * vwo-fme-node-sdk - v1.37.0
 * URL - https://github.com/wingify/vwo-fme-node-sdk
 *
 * Copyright 2024-2026 Wingify Software Pvt. Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Dependencies used -
 *  1. murmurhash - ^2.0.1
 *  2. superstruct - ^0.14.x
 *  3. uuid - ^9.0.1
 *  4. vwo-fme-sdk-log-messages - ^1.3.0
 */
(()=>{var e={119:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkManager=void 0;var o=n(5576),i=n(9717),a=n(7666),s=n(477),u=n(7173),c=n(8341),l=n(7005),g=n(5076),p=n(2974),d=n(3388),f=function(){function e(e,t,o,i){if(void 0===i&&(i=!1),this.logManager=e,!this.retryConfig||o){var u=s.Constants.DEFAULT_RETRY_CONFIG,f=r(r({},u),o||{});this.retryConfig=this.validateRetryConfig(f),i&&(this.retryConfig.shouldRetry=!1)}if("undefined"==typeof process)"undefined"==typeof XMLHttpRequest?this.client=t||new c.NetworkServerLessClient(this.logManager):(this.logManager.debug((0,g.buildMessage)(p.DebugLogMessagesEnum.USING_API_WITH_PROCESS,{api:"xhr",process:"undefined"})),this.client=t||new l.NetworkBrowserClient(this.logManager));else{this.logManager.debug((0,g.buildMessage)(p.DebugLogMessagesEnum.USING_API_WITH_PROCESS,{api:d.HTTPS_PROTOCOL,process:"defined"}));var h=n(6787).NetworkClient;this.client=t||new h(this.logManager)}this.config=new a.GlobalRequestModel(null,null,null,null)}return e.prototype.validateRetryConfig=function(e){var t=r({},e);return(0,u.isBoolean)(t.shouldRetry)||(t.shouldRetry=s.Constants.DEFAULT_RETRY_CONFIG.shouldRetry,this.isInvalidRetryConfig=!0),(!(0,u.isNumber)(t.maxRetries)||!Number.isInteger(t.maxRetries)||t.maxRetries<1)&&(t.maxRetries=s.Constants.DEFAULT_RETRY_CONFIG.maxRetries,this.isInvalidRetryConfig=!0),(!(0,u.isNumber)(t.initialDelay)||!Number.isInteger(t.initialDelay)||t.initialDelay<1)&&(t.initialDelay=s.Constants.DEFAULT_RETRY_CONFIG.initialDelay,this.isInvalidRetryConfig=!0),(!(0,u.isNumber)(t.backoffMultiplier)||!Number.isInteger(t.backoffMultiplier)||t.backoffMultiplier<2)&&(t.backoffMultiplier=s.Constants.DEFAULT_RETRY_CONFIG.backoffMultiplier,this.isInvalidRetryConfig=!0),this.isInvalidRetryConfig?s.Constants.DEFAULT_RETRY_CONFIG:t},e.prototype.getIsInvalidRetryConfig=function(){return this.isInvalidRetryConfig},e.prototype.getRetryConfig=function(){return r({},this.retryConfig)},e.prototype.injectServiceContainer=function(e){this.serviceContainer=e},e.prototype.setConfig=function(e){this.config=e},e.prototype.getConfig=function(){return this.config},e.prototype.createRequest=function(e){return(new i.RequestHandler).createRequest(e,this.config)},e.prototype.get=function(e){var t=new o.Deferred,n=this.createRequest(e);return n.getUrl()?this.client.GET(n).then((function(e){t.resolve(e)})).catch((function(e){t.reject(e)})):t.reject(new Error("no url found")),t.promise},e.prototype.post=function(e){var t=new o.Deferred,n=this.createRequest(e);return n.getUrl()?this.client.POST(n).then((function(e){t.resolve(e)})).catch((function(e){t.reject(e)})):t.reject(new Error("no url found")),t.promise},e}();t.NetworkManager=f},477:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Constants=void 0;var o,i,a=n(2550),s=n(3388),u=r(n(5017)).default.version;"undefined"==typeof process?(o={name:"vwo-fme-javascript-sdk",version:u},i=a.PlatformEnum.CLIENT):(o={name:"vwo-fme-node-sdk",version:u},i=a.PlatformEnum.SERVER),t.Constants={SDK_NAME:o.name,SDK_VERSION:o.version,PLATFORM:i,MAX_TRAFFIC_PERCENT:100,MAX_TRAFFIC_VALUE:1e4,STATUS_RUNNING:"RUNNING",SEED_VALUE:1,MAX_EVENTS_PER_REQUEST:5e3,DEFAULT_REQUEST_TIME_INTERVAL:600,DEFAULT_EVENTS_PER_REQUEST:100,SEED_URL:s.SEED_URL,HTTP_PROTOCOL:s.HTTP_PROTOCOL,HTTPS_PROTOCOL:s.HTTPS_PROTOCOL,SETTINGS:"settings",SETTINGS_EXPIRY:1e7,SETTINGS_TIMEOUT:5e4,EVENTS_CALL_TIMEOUT:1e4,SETTINGS_TTL:72e5,ALWAYS_USE_CACHED_SETTINGS:!1,MIN_TTL_MS:6e4,HOST_NAME:"dev.visualwebsiteoptimizer.com",SETTINGS_ENDPOINT:"/server-side/v2-settings",WEBHOOK_SETTINGS_ENDPOINT:"/server-side/v2-pull",LOCATION_ENDPOINT:"/getLocation",VWO_FS_ENVIRONMENT:"vwo_fs_environment",RANDOM_ALGO:1,API_VERSION:"1",VWO_META_MEG_KEY:"_vwo_meta_meg_",DEFAULT_RETRY_CONFIG:{shouldRetry:!0,initialDelay:2,maxRetries:3,backoffMultiplier:2},DEFAULT_SETTINGS_STORAGE_KEY:"vwo_fme_settings",POLLING_INTERVAL:6e5,PRODUCT_NAME:"fme",V2_SETTINGS:"v2-settings",POLLING:"polling",BATCH_EVENTS:"batch-events",STORAGE:"storage",FLAG_DECISION_GIVEN:"FLAG_DECISION_GIVEN",NETWORK_CALL_FAILURE_AFTER_MAX_RETRIES:"NETWORK_CALL_FAILURE_AFTER_MAX_RETRIES",NETWORK_CALL_SUCCESS_WITH_RETRIES:"NETWORK_CALL_SUCCESS_WITH_RETRIES",IMPACT_ANALYSIS:"IMPACT_ANALYSIS"}},596:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getFromGatewayService=function(e,t,n,a){return r(this,void 0,void 0,(function(){var r,l,g,p,d,f,h;return o(this,(function(o){if(r=new c.Deferred,l=e.getNetworkManager(),g=l.getRetryConfig(),!e.getSettingsService().isGatewayServiceProvided)return e.getLogManager().errorLog("INVALID_GATEWAY_URL",{},{an:i.ApiEnum.GET_FLAG,uuid:a.getUuid(),sId:a.getSessionId()}),r.resolve(!1),[2,r.promise];t.accountId=e.getSettingsService().accountId,p=null,d=null,f=null,null!=e.getSettingsService().gatewayServiceConfig.hostname?(p=e.getSettingsService().gatewayServiceConfig.hostname,d=e.getSettingsService().gatewayServiceConfig.port,f=e.getSettingsService().gatewayServiceConfig.protocol):(p=e.getSettingsService().hostname,d=e.getSettingsService().port,f=e.getSettingsService().protocol);try{return h=new u.RequestModel(p,s.HttpMethodEnum.GET,n,t,null,null,f,d,g),l.get(h).then((function(e){r.resolve(e.getData())})).catch((function(e){r.reject(e)})),[2,r.promise]}catch(e){return r.resolve(!1),[2,r.promise]}return[2]}))}))},t.getQueryParams=function(e){for(var t={},n=0,r=Object.entries(e);n<r.length;n++){var o=r[n],i=o[0],a=o[1],s=encodeURIComponent(String(a));t[i]=s}return t},t.addIsGatewayServiceRequiredFlag=function(e){for(var t=/\b(country|region|city|os|device_type|browser_string|ua|browser_version|os_version)\b/g,n=/"custom_variable"\s*:\s*{[^}]*inlist\([^)]*\)/g,r=0,o=e.getFeatures();r<o.length;r++)for(var i=o[r],s=0,u=i.getRulesLinkedCampaign();s<u.length;s++){var c,l=u[s];if(c=l.getType()===a.CampaignTypeEnum.PERSONALIZE||l.getType()===a.CampaignTypeEnum.ROLLOUT?l.getVariations()[0].getSegments():l.getSegments()){var g=JSON.stringify(c),p=g.match(t),d=g.match(n);if(p&&p.length>0||d&&d.length>0){i.setIsGatewayServiceRequired(!0);break}}}};var i=n(6167),a=n(6947),s=n(5212),u=n(4464),c=n(5576)},689:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateRule=void 0;var i=n(7173),a=n(9455),s=n(9284);t.evaluateRule=function(e,t,n,u,c,l,g,p){return r(void 0,void 0,void 0,(function(){var r,d,f;return o(this,(function(o){switch(o.label){case 0:return[4,(0,a.checkWhitelistingAndPreSeg)(e,t,n,u,c,l,g,p)];case 1:return r=o.sent(),d=r[0],f=r[1],d&&(0,i.isObject)(f)&&Object.keys(f).length>0?(Object.assign(p,{experimentId:n.getId(),experimentKey:n.getKey(),experimentVariationId:f.variationId}),e.getShouldWaitForTrackingCalls()?[4,(0,s.createAndSendImpressionForVariationShown)(e,n.getId(),f.variation.id,u,t.getKey())]:[3,3]):[3,4];case 2:return o.sent(),[3,4];case 3:(0,s.createAndSendImpressionForVariationShown)(e,n.getId(),f.variation.id,u,t.getKey()),o.label=4;case 4:return[2,{preSegmentationResult:d,whitelistedObject:f,updatedDecision:p}]}}))}))}},834:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.StorageDecorator=void 0;var i=n(1522),a=n(5576),s=n(6167),u=function(){function e(){}return e.prototype.getFeatureFromStorage=function(e,t,n,s){return r(this,void 0,void 0,(function(){var r;return o(this,(function(o){return r=new a.Deferred,n.getDataInStorage(e,t,s).then((function(e){switch(e){case i.StorageEnum.STORAGE_UNDEFINED:case i.StorageEnum.NO_DATA_FOUND:r.resolve(null);break;case i.StorageEnum.INCORRECT_DATA:r.resolve(i.StorageEnum.INCORRECT_DATA);break;case i.StorageEnum.CAMPAIGN_PAUSED:r.resolve(null);break;case i.StorageEnum.VARIATION_NOT_FOUND:r.resolve(i.StorageEnum.VARIATION_NOT_FOUND);break;case i.StorageEnum.WHITELISTED_VARIATION:r.resolve(null);break;default:r.resolve(e)}})),[2,r.promise]}))}))},e.prototype.setDataInStorage=function(e,t,n){var r=new a.Deferred,o=e.featureKey,i=e.featureId,u=e.context,c=e.rolloutId,l=e.rolloutKey,g=e.rolloutVariationId,p=e.experimentId,d=e.experimentKey,f=e.experimentVariationId;return o?u.id?!l||d||g?d&&!f?(n.getLogManager().errorLog("ERROR_STORING_DATA_IN_STORAGE",{key:"Variation:(experimentKey or rolloutVariationId)"},{an:s.ApiEnum.GET_FLAG,uuid:u._vwo_uuid,sId:u._vwo_sessionId}),void r.reject()):(t.setDataInStorage({featureKey:o,featureId:i,userId:u.id,rolloutId:c,rolloutKey:l,rolloutVariationId:g,experimentId:p,experimentKey:d,experimentVariationId:f},n),r.resolve(),r.promise):(n.getLogManager().errorLog("ERROR_STORING_DATA_IN_STORAGE",{key:"Variation:(rolloutKey, experimentKey or rolloutVariationId)"},{an:s.ApiEnum.GET_FLAG,uuid:u._vwo_uuid,sId:u._vwo_sessionId}),void r.reject()):(n.getLogManager().errorLog("ERROR_STORING_DATA_IN_STORAGE",{key:"Context or Context.id"},{an:s.ApiEnum.GET_FLAG,uuid:u._vwo_uuid,sId:u._vwo_sessionId}),void r.reject()):(n.getLogManager().errorLog("ERROR_STORING_DATA_IN_STORAGE",{key:"featureKey"},{an:s.ApiEnum.GET_FLAG,uuid:u._vwo_uuid,sId:u._vwo_sessionId}),void r.reject())},e}();t.StorageDecorator=u},976:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetricModel=void 0;var n=function(){function e(){}return e.prototype.modelFromDictionary=function(e){return this.identifier=e.identifier||e.key,this.id=e.i||e.id,this.type=e.t||e.type,this},e.prototype.getId=function(){return this.id},e.prototype.getIdentifier=function(){return this.identifier},e.prototype.getType=function(){return this.type},e}();t.MetricModel=n},1007:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserStorageConnector=void 0;var i=n(477),a=n(5576),s=n(7173),u=n(6089),c=function(e){function t(t,n,r){var o=e.call(this)||this;return o.SETTINGS_KEY=i.Constants.DEFAULT_SETTINGS_STORAGE_KEY,o.storageKey=(null==t?void 0:t.key)||n,o.logManager=r,o.storage=(null==t?void 0:t.provider)||window.localStorage,o.isDisabled=(null==t?void 0:t.isDisabled)||!1,o.alwaysUseCachedSettings=(null==t?void 0:t.alwaysUseCachedSettings)||!1,!(0,s.isNumber)(null==t?void 0:t.ttl)||t.ttl<i.Constants.MIN_TTL_MS?(o.logManager.debug("TTL is not passed or invalid (less than 1 minute), using default value of 2 hours"),o.ttl=i.Constants.SETTINGS_TTL):o.ttl=(null==t?void 0:t.ttl)||i.Constants.SETTINGS_TTL,(0,s.isBoolean)(null==t?void 0:t.alwaysUseCachedSettings)?o.alwaysUseCachedSettings=(null==t?void 0:t.alwaysUseCachedSettings)||!1:(o.logManager.debug("AlwaysUseCachedSettings is not passed or invalid, using default value of false"),o.alwaysUseCachedSettings=!1),o}return o(t,e),t.prototype.getStoredData=function(){if(this.isDisabled)return{};try{var e=this.storage.getItem(this.storageKey);return e?JSON.parse(e):{}}catch(e){return this.logManager.errorLog("ERROR_READING_DATA_FROM_BROWSER_STORAGE",{err:(0,u.getFormattedErrorMessage)(e)},{an:i.Constants.STORAGE}),{}}},t.prototype.storeData=function(e){if(!this.isDisabled)try{var t=JSON.stringify(e);this.storage.setItem(this.storageKey,t)}catch(e){this.logManager.errorLog("ERROR_STORING_DATA_IN_BROWSER_STORAGE",{err:(0,u.getFormattedErrorMessage)(e)},{an:i.Constants.STORAGE})}},t.prototype.set=function(e){var t=new a.Deferred;if(this.isDisabled)t.resolve();else try{var n=this.getStoredData(),r="".concat(e.featureKey,"_").concat(e.userId);n[r]=e,this.storeData(n),this.logManager.info("Stored data in storage for key: ".concat(r)),t.resolve()}catch(e){this.logManager.errorLog("ERROR_STORING_DATA_IN_BROWSER_STORAGE",{err:(0,u.getFormattedErrorMessage)(e)},{an:i.Constants.STORAGE}),t.reject(e)}return t.promise},t.prototype.get=function(e,t){var n,r=new a.Deferred;if(this.isDisabled)r.resolve({});else try{var o=this.getStoredData(),s="".concat(e,"_").concat(t),c=null!==(n=o[s])&&void 0!==n?n:{};this.logManager.info("Retrieved data from storage for key: ".concat(s)),r.resolve(c)}catch(e){this.logManager.errorLog("ERROR_READING_DATA_FROM_BROWSER_STORAGE",{err:(0,u.getFormattedErrorMessage)(e)},{an:i.Constants.STORAGE}),r.resolve({})}return r.promise},t.prototype.getSettings=function(e,t){var n=new a.Deferred;if(this.isDisabled)n.resolve({});else try{var r=this.getStoredData()[this.SETTINGS_KEY];if(r&&r.settings&&r.settings.sdkKey)try{r.settings.sdkKey=atob(r.settings.sdkKey)}catch(e){this.logManager.errorLog("ERROR_DECODING_SDK_KEY_FROM_STORAGE",{err:(0,u.getFormattedErrorMessage)(e)},{an:i.Constants.STORAGE})}n.resolve(r)}catch(e){n.resolve({})}return n.promise},t.prototype.setSettings=function(e){var t=new a.Deferred;if(this.isDisabled)t.resolve();else try{var n=this.getStoredData();e.settings&&e.settings.sdkKey&&(e.settings.sdkKey=btoa(e.settings.sdkKey)),n[this.SETTINGS_KEY]=e,this.storeData(n),t.resolve()}catch(e){t.reject(e)}return t.promise},t}(n(9376).Connector);t.BrowserStorageConnector=c},1013:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.AliasingUtil=void 0;var i=n(4464),a=n(5212),s=n(2478),u=n(5576),c=function(){function e(){}return e.getAlias=function(e,t){return r(this,void 0,void 0,(function(){var n,r,s,c,l,g,p;return o(this,(function(o){n=new u.Deferred;try{return r=null,s=null,c=null,l=t.getNetworkManager().getRetryConfig(),null!=t.getSettingsService().gatewayServiceConfig.hostname?(r=t.getSettingsService().gatewayServiceConfig.hostname,s=t.getSettingsService().gatewayServiceConfig.port,c=t.getSettingsService().gatewayServiceConfig.protocol):(r=t.getSettingsService().hostname,s=t.getSettingsService().port,c=t.getSettingsService().protocol),(g={}).accountId=t.getSettingsService().accountId,g.sdkKey=t.getSettingsService().sdkKey,g[this.KEY_USER_ID]=JSON.stringify([e]),p=new i.RequestModel(r,a.HttpMethodEnum.GET,this.GET_ALIAS_URL,g,null,null,c,s,l),t.getNetworkManager().get(p).then((function(e){n.resolve(e.getData())})).catch((function(e){n.reject(e)})),[2,n.promise]}catch(e){return n.resolve(!1),[2,n.promise]}return[2]}))}))},e.setAlias=function(e,t,n){return r(this,void 0,void 0,(function(){var r,s,c,l,g,p,d,f,h;return o(this,(function(o){r=new u.Deferred;try{return s=null,c=null,l=null,g=n.getNetworkManager().getRetryConfig(),null!=n.getSettingsService().gatewayServiceConfig.hostname?(s=n.getSettingsService().gatewayServiceConfig.hostname,c=n.getSettingsService().gatewayServiceConfig.port,l=n.getSettingsService().gatewayServiceConfig.protocol):(s=n.getSettingsService().hostname,c=n.getSettingsService().port,l=n.getSettingsService().protocol),(p={}).accountId=n.getSettingsService().accountId,p.sdkKey=n.getSettingsService().sdkKey,p[this.KEY_USER_ID]=e,p[this.KEY_ALIAS_ID]=t,(h={})[this.KEY_USER_ID]=e,h[this.KEY_ALIAS_ID]=t,d=h,f=new i.RequestModel(s,a.HttpMethodEnum.POST,this.SET_ALIAS_URL,p,d,null,l,c,g),n.getNetworkManager().post(f).then((function(e){r.resolve(e.getData())})).catch((function(e){r.reject(e)})),[2,r.promise]}catch(e){return r.resolve(!1),[2,r.promise]}return[2]}))}))},e.KEY_USER_ID="userId",e.KEY_ALIAS_ID="aliasId",e.GET_ALIAS_URL=s.UrlEnum.GET_ALIAS,e.SET_ALIAS_URL=s.UrlEnum.SET_ALIAS,e}();t.AliasingUtil=c},1155:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.StatusEnum=void 0,function(e){e.PASSED="passed",e.FAILED="failed"}(n||(t.StatusEnum=n={}))},1202:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogTransportManager=t.LogLevelNumberEnum=void 0;var r,o=n(8858),i=n(7846),a=n(7173),s=n(8671);!function(e){e[e.TRACE=0]="TRACE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR"}(r||(t.LogLevelNumberEnum=r={}));var u=function(){function e(e){this.transports=[],this.config=e,this.consoleTransport=new s.ConsoleTransport({level:e.level})}return e.prototype.addTransport=function(e){this.transports.push(e)},e.prototype.shouldLog=function(e,t){return r[e.toUpperCase()]>=r[(t||this.config.level).toUpperCase()]},e.prototype.trace=function(e){this.log(o.LogLevelEnum.TRACE,e)},e.prototype.debug=function(e){this.log(o.LogLevelEnum.DEBUG,e)},e.prototype.info=function(e){this.log(o.LogLevelEnum.INFO,e)},e.prototype.warn=function(e){this.log(o.LogLevelEnum.WARN,e)},e.prototype.error=function(e){this.log(o.LogLevelEnum.ERROR,e)},e.prototype.log=function(e,t){var n=new i.LogMessageBuilder(this.config,this.consoleTransport).formatMessage(e,t);this.config.level&&(0===this.transports.length||this.transports.length>0&&this.config.shouldLogToStandardOutput)&&this.shouldLog(e,this.config.level)&&this.consoleTransport[e](n);for(var r=0;r<this.transports.length;r++)this.shouldLog(e,this.transports[r].level)&&this.transports[r].log&&(0,a.isFunction)(this.transports[r].log)&&this.transports[r].log(e,t)},e}();t.LogTransportManager=u},1271:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=1271,e.exports=t},1463:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VariationModel=void 0;var r=n(2160),o=function(){function e(){this.variables=[],this.variations=[]}return e.prototype.modelFromDictionary=function(t){var n=this;return this.id=t.i||t.id,this.key=t.n||t.key||t.name,this.weight=t.w||t.weight,this.ruleKey=t.ruleKey,this.salt=t.salt,this.type=t.type,this.setStartRange(t.startRangeVariation),this.setEndRange(t.endRangeVariation),(t.seg||t.segments)&&(this.segments=t.seg||t.segments),t.variables&&(t.variables.constructor==={}.constructor?this.variables=[]:t.variables.forEach((function(e){n.variables.push(r.VariableModel.modelFromDictionary(e))}))),t.variations&&(t.variations.constructor==={}.constructor?this.variations=[]:t.variations.forEach((function(t){n.variations.push((new e).modelFromDictionary(t))}))),this},e.prototype.setStartRange=function(e){this.startRangeVariation=e},e.prototype.setEndRange=function(e){this.endRangeVariation=e},e.prototype.setWeight=function(e){this.weight=e},e.prototype.getId=function(){return this.id},e.prototype.getKey=function(){return this.key},e.prototype.getRuleKey=function(){return this.ruleKey},e.prototype.getWeight=function(){return this.weight},e.prototype.getSegments=function(){return this.segments},e.prototype.getStartRangeVariation=function(){return this.startRangeVariation},e.prototype.getEndRangeVariation=function(){return this.endRangeVariation},e.prototype.getVariables=function(){return this.variables},e.prototype.getVariations=function(){return this.variations},e.prototype.getType=function(){return this.type},e.prototype.getSalt=function(){return this.salt},e}();t.VariationModel=o},1522:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.StorageEnum=void 0,function(e){e[e.STORAGE_UNDEFINED=0]="STORAGE_UNDEFINED",e[e.INCORRECT_DATA=1]="INCORRECT_DATA",e[e.NO_DATA_FOUND=2]="NO_DATA_FOUND",e[e.CAMPAIGN_PAUSED=3]="CAMPAIGN_PAUSED",e[e.VARIATION_NOT_FOUND=4]="VARIATION_NOT_FOUND",e[e.WHITELISTED_VARIATION=5]="WHITELISTED_VARIATION"}(n||(t.StorageEnum=n={}))},1566:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.StorageService=void 0;var a=n(1522),s=n(7173),u=n(5576),c=n(6167),l=n(6089),g=n(477),p=n(5600),d=n(5076),f=n(2974),h=function(){function e(e){this.storageData={},this.serviceContainer=e}return e.prototype.getDataInStorage=function(e,t){return o(this,void 0,void 0,(function(){var n,r=this;return i(this,(function(o){return n=new u.Deferred,(0,s.isNull)(this.serviceContainer.getStorageConnector())||(0,s.isUndefined)(this.serviceContainer.getStorageConnector())?n.resolve(a.StorageEnum.STORAGE_UNDEFINED):this.serviceContainer.getStorageConnector().get(e,t.getId()).then((function(e){n.resolve(e)})).catch((function(e){r.serviceContainer.getLogManager().errorLog("ERROR_READING_STORED_DATA_IN_STORAGE",{err:e},{an:c.ApiEnum.GET_FLAG,uuid:t.getUuid(),sId:t.getSessionId()}),n.resolve(a.StorageEnum.NO_DATA_FOUND)})),[2,n.promise]}))}))},e.prototype.setDataInStorage=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){return t=new u.Deferred,null===this.serviceContainer.getStorageConnector()||void 0===this.serviceContainer.getStorageConnector()?t.resolve(!1):this.serviceContainer.getStorageConnector().set(e).then((function(){t.resolve(!0)})).catch((function(){t.resolve(!1)})),[2,t.promise]}))}))},e.prototype.getSettingsFromStorage=function(e,t){return o(this,arguments,void 0,(function(e,t,n){var r,o,a,c,p,h,v,E;return void 0===n&&(n=!0),i(this,(function(i){switch(i.label){case 0:r=new u.Deferred,i.label=1;case 1:return i.trys.push([1,5,,6]),this.serviceContainer.getStorageConnector()&&"function"==typeof this.serviceContainer.getStorageConnector().getSettings?[4,this.serviceContainer.getStorageConnector().getSettings(e,t)]:[3,3];case 2:if(!(o=i.sent())||(0,s.isEmptyObject)(o))return r.resolve({}),[2,r.promise];if(a=o.settings,c=o.timestamp,!a||a.sdkKey!==t||String(null!==(E=a.accountId)&&void 0!==E?E:a.a)!==String(e))return this.serviceContainer.getLogManager().info((0,d.buildMessage)(f.InfoLogMessagesEnum.SETTINGS_CACHE_MISS_KEY_ACCOUNT_ID_MISMATCH)),r.resolve({}),[2,r.promise];if(this.serviceContainer.getStorageConnector().alwaysUseCachedSettings||g.Constants.ALWAYS_USE_CACHED_SETTINGS)return this.serviceContainer.getLogManager().info((0,d.buildMessage)(f.InfoLogMessagesEnum.SETTINGS_USING_CACHED_SETTINGS)),r.resolve(a),[2,r.promise];if(p=Date.now(),h=this.serviceContainer.getStorageConnector().ttl||g.Constants.SETTINGS_TTL,p-c>h)this.serviceContainer.getLogManager().info((0,d.buildMessage)(f.InfoLogMessagesEnum.SETTINGS_EXPIRED)),r.resolve({});else{if(this.serviceContainer.getLogManager().info((0,d.buildMessage)(f.InfoLogMessagesEnum.SETTINGS_RETRIEVED_FROM_STORAGE)),n&&this.setFreshSettingsInStorage(e,t),a&&a.sdkKey)try{a.sdkKey=atob(a.sdkKey)}catch(e){this.serviceContainer.getLogManager().errorLog("ERROR_DECODING_SDK_KEY_FROM_STORAGE",{err:(0,l.getFormattedErrorMessage)(e)},{an:g.Constants.STORAGE})}r.resolve(a)}return[3,4];case 3:r.resolve({}),i.label=4;case 4:return[3,6];case 5:return v=i.sent(),this.serviceContainer.getLogManager().errorLog("ERROR_READING_SETTINGS_FROM_STORAGE",{err:(0,l.getFormattedErrorMessage)(v)},{an:g.Constants.STORAGE}),r.resolve({}),[3,6];case 6:return[2,r.promise]}}))}))},e.prototype.setSettingsInStorage=function(e,t,n){return o(this,void 0,void 0,(function(){var e,t,o,a;return i(this,(function(i){switch(i.label){case 0:e=new u.Deferred,i.label=1;case 1:return i.trys.push([1,5,,6]),this.serviceContainer.getStorageConnector()&&"function"==typeof this.serviceContainer.getStorageConnector().setSettings?(t=r({},n),o={settings:t,timestamp:Date.now()},[4,this.serviceContainer.getStorageConnector().setSettings(o)]):[3,3];case 2:return i.sent(),this.serviceContainer.getLogManager().info((0,d.buildMessage)(f.InfoLogMessagesEnum.SETTINGS_SUCCESSFULLY_STORED)),e.resolve(),[3,4];case 3:e.resolve(),i.label=4;case 4:return[3,6];case 5:return a=i.sent(),this.serviceContainer.getLogManager().errorLog("ERROR_STORING_SETTINGS_IN_STORAGE",{err:(0,l.getFormattedErrorMessage)(a)},{an:g.Constants.STORAGE}),e.resolve(),[3,6];case 6:return[2,e.promise]}}))}))},e.prototype.setFreshSettingsInStorage=function(e,t){return o(this,void 0,void 0,(function(){var n,r=this;return i(this,(function(a){return n=new u.Deferred,this.serviceContainer.getSettingsService()&&this.serviceContainer.getStorageConnector()&&"function"==typeof this.serviceContainer.getStorageConnector().setSettings?(this.serviceContainer.getSettingsService().fetchSettings().then((function(a){return o(r,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return a&&(new p.SettingsSchema).isSettingsValid(a)?[4,this.setSettingsInStorage(e,t,a)]:[3,2];case 1:r.sent(),this.serviceContainer.getLogManager().info((0,d.buildMessage)(f.InfoLogMessagesEnum.SETTINGS_UPDATED_WITH_FRESH_DATA)),r.label=2;case 2:return n.resolve(),[2]}}))}))})).catch((function(e){r.serviceContainer.getLogManager().errorLog("ERROR_STORING_FRESH_SETTINGS_IN_STORAGE",{err:(0,l.getFormattedErrorMessage)(e)},{an:g.Constants.STORAGE}),n.resolve()})),[2,n.promise]):[2]}))}))},e}();t.StorageService=h},1913:function(e,t,n){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&o(t,e,n[a]);return i(t,e),t}),s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.sendGetCall=function(e,t){return y(c.HttpMethodEnum.GET,e,t)},t.sendPostCall=function(e,t){return y(c.HttpMethodEnum.POST,e,t)};var c=n(5212),l=n(6089),g=n(5076),p=n(2974),d=n(7111),f=n(3647),h=null,v=null;function E(e){return s(this,void 0,void 0,(function(){var t=this;return u(this,(function(r){return h?[2,h]:(v||(v=s(t,void 0,void 0,(function(){var t,r,o;return u(this,(function(i){switch(i.label){case 0:if("undefined"!=typeof fetch)return e.debug((0,g.buildMessage)(p.DebugLogMessagesEnum.USING_API_WITH_PROCESS,{api:"Global fetch",process:"undefined"==typeof process?"undefined":"defined"})),h=fetch,[2,fetch];i.label=1;case 1:return i.trys.push([1,3,,4]),e.debug((0,g.buildMessage)(p.DebugLogMessagesEnum.USING_API_WITH_PROCESS,{api:"Node-fetch",process:"undefined"==typeof process?"undefined":"defined"})),[4,Promise.resolve("".concat("node-fetch")).then((function(e){return a(n(1271)(e))}))];case 2:return t=i.sent(),r=t.default||t,h=r,[2,r];case 3:return o=i.sent(),e.error((0,g.buildMessage)(p.ErrorLogMessagesEnum.ERROR_INITIALIZING_FETCH,{error:(0,l.getFormattedErrorMessage)(o)})),[3,4];case 4:return[2]}}))}))),[2,v])}))}))}function y(e,t,n){return s(this,void 0,void 0,(function(){var r,o,i,a,s,g,p,h,v,y,m;return u(this,(function(u){switch(u.label){case 0:r=new f.ResponseModel,o=t.getOptions(),i="".concat(o.scheme,"://").concat(o.hostname).concat(o.path),o.port&&(i="".concat(o.scheme,"://").concat(o.hostname,":").concat(o.port).concat(o.path)),a=0,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,E(n)];case 2:return s=u.sent(),g=t.getRetryConfig(),p=g.shouldRetry,h=g.maxRetries,e===c.HttpMethodEnum.POST&&(o.body=JSON.stringify(o.body)),v=function(){return new Promise((function(n,u){s(i,o).then((function(o){return o.text().then((function(i){r.setStatusCode(o.status),a>0&&(r.setTotalAttempts(a),r.setError(t.getLastError()));try{e===c.HttpMethodEnum.GET?r.setData(JSON.parse(i)):r.setData(i)}catch(e){r.setError((0,l.getFormattedErrorMessage)(e)),u(r)}200===o.status?n(r):400===o.status?(r.setError((0,l.getFormattedErrorMessage)(o.statusText)),r.setTotalAttempts(a),u(r)):y("".concat(o.statusText,", status: ").concat(o.status),n,u)}))})).catch((function(e){var t=(0,l.getFormattedErrorMessage)(e);e&&e.cause&&(t="".concat(t," ").concat(e.cause)),y(t,n,u)}))}))},y=function(e,s,u){var c=String(o.path||i).split("?")[0];if(p&&a<h){var f=g.initialDelay*Math.pow(g.backoffMultiplier,a)*1e3;a++,n.errorLog("ATTEMPTING_RETRY_FOR_FAILED_NETWORK_CALL",{endPoint:c,err:(0,l.getFormattedErrorMessage)(e),delay:f/1e3,attempt:a,maxRetries:h},{},!1),t.setLastError((0,l.getFormattedErrorMessage)(e)),setTimeout((function(){v().then(s).catch(u)}),f)}else String(o.path).includes(d.EventEnum.VWO_DEBUGGER_EVENT)||n.errorLog("NETWORK_CALL_FAILURE_AFTER_MAX_RETRIES",{extraData:c,attempts:a,err:(0,l.getFormattedErrorMessage)(e)},{},!1),r.setError((0,l.getFormattedErrorMessage)(e)),r.setTotalAttempts(a),u(r)},[2,v()];case 3:throw m=u.sent(),r.setError((0,l.getFormattedErrorMessage)(m)),r.setTotalAttempts(a),r;case 4:return[2]}}))}))}},1943:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getSettingsPath=function(e,t){return{i:"".concat(e),r:Math.random(),a:t}},t.getTrackEventPath=function(e,t,n){return{event_type:e,account_id:t,uId:n,u:(0,s.getUUID)(n,t),sdk:u.Constants.SDK_NAME,"sdk-v":u.Constants.SDK_VERSION,random:(0,a.getRandomNumber)(),ap:u.Constants.PLATFORM,sId:(0,a.getCurrentUnixTimestamp)(),ed:JSON.stringify({p:"server"})}},t.getEventsBaseProperties=function(e,t,n,r,o,i){void 0===n&&(n=""),void 0===r&&(r=""),void 0===o&&(o=!1),void 0===i&&(i=null);var s=Object.assign({en:t,a:e.accountId.toString(),eTime:(0,a.getCurrentUnixTimestampInMillis)(),random:(0,a.getRandomNumber)(),p:"FS",visitor_ua:n,visitor_ip:r,sn:u.Constants.SDK_NAME,sv:u.Constants.SDK_VERSION});return o?s.a=i:s.env=e.sdkKey,s},t._getEventBasePayload=T,t.getTrackUserPayloadData=function(e,t,n,r,o){var i=o.getId(),a=o.getUserAgent(),s=o.getIpAddress(),u=o.getCustomVariables(),c=o.getPostSegmentationVariables(),l=T(e.getSettingsService(),i,t,a,s);if(0!==o.getSessionId()&&(l.d.sessionId=o.getSessionId()),l.d.event.props.id=n,l.d.event.props.variation=r,l.d.event.props.isFirst=1,c&&c.length>0&&u&&Object.keys(u).length>0)for(var g=0,d=c;g<d.length;g++){var f=d[g];u[f]&&(l.d.visitor.props[f]=u[f])}return s&&(l.d.visitor.props.ip=s),e.getLogManager().debug((0,v.buildMessage)(p.DebugLogMessagesEnum.IMPRESSION_FOR_TRACK_USER,{accountId:e.getSettingsService().accountId.toString(),userId:i,campaignId:n})),l},t.getTrackGoalPayloadData=function(e,t,n,r){var o=T(e.getSettingsService(),r.getId(),t,r.getUserAgent(),r.getIpAddress());if(0!==r.getSessionId()&&(o.d.sessionId=r.getSessionId()),o.d.event.props.isCustomEvent=!0,o.d.event.props.variation=1,o.d.event.props.id=1,n&&(0,h.isObject)(n)&&Object.keys(n).length>0)for(var i in n)o.d.event.props[i]=n[i];return e.getLogManager().debug((0,v.buildMessage)(p.DebugLogMessagesEnum.IMPRESSION_FOR_TRACK_GOAL,{eventName:t,accountId:e.getSettingsService().accountId.toString(),userId:r.getId()})),o},t.getAttributePayloadData=function(e,t,n,r){var o=T(e.getSettingsService(),r.getId(),t,r.getUserAgent(),r.getIpAddress());0!==r.getSessionId()&&(o.d.sessionId=r.getSessionId()),o.d.event.props.isCustomEvent=!0,o.d.event.props[u.Constants.VWO_FS_ENVIRONMENT]=e.getSettingsService().sdkKey;for(var i=0,a=Object.entries(n);i<a.length;i++){var s=a[i],c=s[0],l=s[1];o.d.visitor.props[c]=l}return e.getLogManager().debug((0,v.buildMessage)(p.DebugLogMessagesEnum.IMPRESSION_FOR_SYNC_VISITOR_PROP,{eventName:t,accountId:e.getSettingsService().accountId.toString(),userId:r.getId()})),o},t.sendPostApiRequest=function(e,t,n,r){return o(this,arguments,void 0,(function(e,t,n,r,o,s){var u,d,h,E,m,T,O;return void 0===o&&(o={}),void 0===s&&(s={}),i(this,(function(i){switch(i.label){case 0:return u=e.getNetworkManager().getRetryConfig(),d={},h=n.d.visitor_ua,E=n.d.visitor_ip,h&&(d[c.HeadersEnum.USER_AGENT]=h),E&&(d[c.HeadersEnum.IP]=E),(m=new f.RequestModel(e.getSettingsService().hostname,l.HttpMethodEnum.POST,e.getUpdatedEndpointWithCollectionPrefix(g.UrlEnum.EVENTS),t,n,d,e.getSettingsService().protocol,e.getSettingsService().port,u)).setEventName(t.en),m.setUuid(n.d.visId),t.en===y.EventEnum.VWO_VARIATION_SHOWN?(T=_.ApiEnum.GET_FLAG,O=s.campaignType===I.CampaignTypeEnum.ROLLOUT||s.campaignType===I.CampaignTypeEnum.PERSONALIZE?"feature: ".concat(s.featureKey,", rule: ").concat(s.variationName):"feature: ".concat(s.featureKey,", rule: ").concat(s.campaignKey," and variation: ").concat(s.variationName),m.setCampaignId(n.d.event.props.id)):t.en!=y.EventEnum.VWO_VARIATION_SHOWN&&(t.en===y.EventEnum.VWO_SYNC_VISITOR_PROP?(T=_.ApiEnum.SET_ATTRIBUTE,O=T):t.en!==y.EventEnum.VWO_DEBUGGER_EVENT&&t.en!==y.EventEnum.VWO_LOG_EVENT&&t.en!==y.EventEnum.VWO_INIT_CALLED&&(T=_.ApiEnum.TRACK_EVENT,O="event: ".concat(t.en)),Object.keys(o).length>0&&m.setEventProperties(o)),[4,e.getNetworkManager().post(m).then((function(o){if(o.getTotalAttempts()>0){var i=b(o,n,T,O);i.uuid=m.getUuid(),(0,S.sendDebugEventToVWO)(e,i)}e.getLogManager().info((0,v.buildMessage)(p.InfoLogMessagesEnum.NETWORK_CALL_SUCCESS,{event:t.en,endPoint:g.UrlEnum.EVENTS,accountId:e.getSettingsService().accountId.toString(),userId:r,uuid:n.d.visId}))})).catch((function(t){var r=b(t,n,T,O);r.uuid=m.getUuid(),(0,S.sendDebugEventToVWO)(e,r),e.getLogManager().errorLog("NETWORK_CALL_FAILED",{method:l.HttpMethodEnum.POST,err:(0,a.getFormattedErrorMessage)(t)},{},!1)}))];case 1:return i.sent(),[2]}}))}))},t.getMessagingEventPayload=function(e,t,n,o,i){void 0===i&&(i={});var s=T(e,e.accountId+"_"+e.sdkKey,o);s.d.event.props[u.Constants.VWO_FS_ENVIRONMENT]=e.sdkKey,s.d.event.props.product=u.Constants.PRODUCT_NAME;var c={type:t,content:{title:n,dateTime:(0,a.getCurrentUnixTimestampInMillis)()},metaInfo:r({},i)};return s.d.event.props.data=c,s},t.getSDKInitEventPayload=function(e,t,n,r){var o=T(e,e.accountId+"_"+e.sdkKey,t);o.d.event.props[u.Constants.VWO_FS_ENVIRONMENT]=e.sdkKey,o.d.event.props.product=u.Constants.PRODUCT_NAME;var i={isSDKInitialized:!0,settingsFetchTime:n,sdkInitTime:r};return o.d.event.props.data=i,o},t.getSDKUsageStatsEventPayload=function(e,t,n,r){var o=T(e,e.accountId+"_"+e.sdkKey,t,"","",!0,n);return o.d.event.props.product=u.Constants.PRODUCT_NAME,o.d.event.props.vwoMeta=r.getUsageStats(),o},t.getDebuggerEventPayload=function(e,t){void 0===t&&(t={});var n,o=e.accountId.toString(),i=e.sdkKey;t.uuid?n=t.uuid:(n=(0,s.getUUID)(o+"_"+i,o),t.uuid=n);var a=T(e,n,y.EventEnum.VWO_DEBUGGER_EVENT,"","",!1,null,!1);return a.d.event.props={},t.sId?a.d.sessionId=t.sId:t.sId=a.d.sessionId,t.an||(t.an=y.EventEnum.VWO_DEBUGGER_EVENT),a.d.event.props.vwoMeta=r(r({},t),{a:e.accountId.toString(),product:u.Constants.PRODUCT_NAME,sn:u.Constants.SDK_NAME,sv:u.Constants.SDK_VERSION,eventId:(0,s.getRandomUUID)(e.sdkKey)}),a},t.sendEvent=function(e,t,n,r){return o(this,void 0,void 0,(function(){var o,a,s;return i(this,(function(i){o=new E.Deferred,a=e.getNetworkManager().getRetryConfig(),r===y.EventEnum.VWO_DEBUGGER_EVENT&&(a.shouldRetry=!1);try{return(s=new f.RequestModel(e.getSettingsService().hostname,l.HttpMethodEnum.POST,e.getUpdatedEndpointWithCollectionPrefix(g.UrlEnum.EVENTS),t,n,null,e.getSettingsService().protocol,e.getSettingsService().port,a)).setEventName(t.en),e.getNetworkManager().post(s).then((function(e){o.resolve(e.getData())})).catch((function(e){o.reject(e)})),[2,o.promise]}catch(e){return o.resolve(!1),[2,o.promise]}return[2]}))}))},t.createNetWorkAndRetryDebugEvent=b;var a=n(6089),s=n(4334),u=n(477),c=n(2209),l=n(5212),g=n(2478),p=n(2974),d=n(6178),f=n(4464),h=n(7173),v=n(5076),E=n(5576),y=n(7111),m=n(7294),S=n(7543),_=n(6167),I=n(6947);function T(e,t,n,r,o,i,c,l){void 0===r&&(r=""),void 0===o&&(o=""),void 0===i&&(i=!1),void 0===c&&(c=null),void 0===l&&(l=!0);var g,p=e.accountId;i&&(p=c),g=l?(0,s.getUUID)(t.toString(),p.toString()):t.toString();var d={vwo_sdkName:u.Constants.SDK_NAME,vwo_sdkVersion:u.Constants.SDK_VERSION};i||(d.vwo_envKey=e.sdkKey);var f={d:{msgId:"".concat(g,"-").concat((0,a.getCurrentUnixTimestampInMillis)()),visId:g,sessionId:(0,a.getCurrentUnixTimestamp)(),visitor_ua:r,visitor_ip:o,event:{props:d,name:n,time:(0,a.getCurrentUnixTimestampInMillis)()}}};return i||(f.d.visitor={props:{vwo_fs_environment:e.sdkKey}}),f}function b(e,t,n,r){var o;try{var i=m.DebuggerCategoryEnum.RETRY,s=u.Constants.NETWORK_CALL_SUCCESS_WITH_RETRIES,c=(0,v.buildMessage)(p.InfoLogMessagesEnum.NETWORK_CALL_SUCCESS_WITH_RETRIES,{extraData:r,attempts:e.getTotalAttempts(),err:(0,a.getFormattedErrorMessage)(e.getError())}),l=d.LogLevelEnum.INFO.toString();200!==e.getStatusCode()&&(i=m.DebuggerCategoryEnum.NETWORK,s=u.Constants.NETWORK_CALL_FAILURE_AFTER_MAX_RETRIES,c=(0,v.buildMessage)(p.ErrorLogMessagesEnum.NETWORK_CALL_FAILURE_AFTER_MAX_RETRIES,{extraData:r,attempts:e.getTotalAttempts(),err:(0,a.getFormattedErrorMessage)(e.getError())}),l=d.LogLevelEnum.ERROR.toString());var g={cg:i,msg_t:s,msg:c,lt:l};return n&&(g.an=n),(null===(o=null==t?void 0:t.d)||void 0===o?void 0:o.sessionId)?g.sId=t.d.sessionId:g.sId=(0,a.getCurrentUnixTimestamp)(),g}catch(e){return{cg:m.DebuggerCategoryEnum.NETWORK,an:n,msg_t:"NETWORK_CALL_FAILED",msg:(0,v.buildMessage)(p.ErrorLogMessagesEnum.NETWORK_CALL_FAILED,{method:r,err:(0,a.getFormattedErrorMessage)(e)}),lt:d.LogLevelEnum.ERROR.toString(),sId:(0,a.getCurrentUnixTimestamp)()}}}},1946:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=void 0;var n=function(){function e(e){var t,n,r,o;"class"===(null===(o=null===(r=null===(n=null===(t=null==e?void 0:e.prototype)||void 0===t?void 0:t.constructor)||void 0===n?void 0:n.toString())||void 0===r?void 0:r.trim())||void 0===o?void 0:o.substring(0,5))?this.connector=new e:this.connector=e}return e.prototype.getConnector=function(){return this.connector},e}();t.Storage=n},2106:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentOperatorValueEnum=void 0,function(e){e.AND="and",e.NOT="not",e.OR="or",e.CUSTOM_VARIABLE="custom_variable",e.USER="user",e.COUNTRY="country",e.REGION="region",e.CITY="city",e.OPERATING_SYSTEM="os",e.DEVICE_TYPE="device_type",e.DEVICE="device",e.BROWSER_AGENT="browser_string",e.UA="ua",e.FEATURE_ID="featureId",e.IP="ip_address",e.BROWSER_VERSION="browser_version",e.OS_VERSION="os_version"}(n||(t.SegmentOperatorValueEnum=n={}))},2160:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VariableModel=void 0;var n=function(){function e(e,t,n,r){this.value=r,this.type=t,this.key=n,this.id=e}return e.modelFromDictionary=function(t){var n,r,o;return new e(null!==(n=t.i)&&void 0!==n?n:t.id,t.type,null!==(r=t.k)&&void 0!==r?r:t.key,null!==(o=t.val)&&void 0!==o?o:t.value)},e.prototype.setValue=function(e){this.value=e},e.prototype.setKey=function(e){this.key=e},e.prototype.setType=function(e){this.type=e},e.prototype.getId=function(){return this.id},e.prototype.getValue=function(){return this.value},e.prototype.getType=function(){return this.type},e.prototype.getKey=function(){return this.key},e}();t.VariableModel=n},2209:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.HeadersEnum=void 0,function(e){e.USER_AGENT="X-Device-User-Agent",e.IP="VWO-X-Forwarded-For"}(n||(t.HeadersEnum=n={}))},2258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RuleModel=void 0;var n=function(){function e(){}return e.prototype.modelFromDictionary=function(e){return this.type=e.type,this.status=e.status,this.variationId=e.variationId,this.campaignId=e.campaignId,this.ruleKey=e.ruleKey,this},e.prototype.getCampaignId=function(){return this.campaignId},e.prototype.getVariationId=function(){return this.variationId},e.prototype.getStatus=function(){return this.status},e.prototype.getType=function(){return this.type},e.prototype.getRuleKey=function(){return this.ruleKey},e}();t.RuleModel=n},2404:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentationManager=void 0;var i=n(7385),a=n(596),s=n(2478),u=n(3166),c=n(7173),l=n(6167),g=n(6089),p=n(3904),d=function(){function e(){this.evaluator=new i.SegmentEvaluator}return e.prototype.setContextualData=function(e,t,n){return r(this,void 0,void 0,(function(){var r,i,d,f;return o(this,(function(o){switch(o.label){case 0:if(this.evaluator.serviceContainer=e,this.evaluator.context=n,this.evaluator.feature=t,this.evaluator.segmentOperandEvaluator=new p.SegmentOperandEvaluator(e),null===(null==n?void 0:n.getUserAgent())&&null===(null==n?void 0:n.getIpAddress()))return[2];if(!0!==t.getIsGatewayServiceRequired())return[3,4];if(!e.getSettingsService().isGatewayServiceProvided||!(0,c.isUndefined)(n.getVwo())&&null!==n.getVwo())return[3,4];r={},(null==n?void 0:n.getUserAgent())&&(r.userAgent=n.getUserAgent()),(null==n?void 0:n.getIpAddress())&&(r.ipAddress=n.getIpAddress()),o.label=1;case 1:return o.trys.push([1,3,,4]),i=(0,a.getQueryParams)(r),[4,(0,a.getFromGatewayService)(e,i,s.UrlEnum.GET_USER_DATA,n)];case 2:return d=o.sent(),n.setVwo((new u.ContextVWOModel).modelFromDictionary(d)),this.evaluator.context=n,[3,4];case 3:return f=o.sent(),e.getLogManager().errorLog("ERROR_SETTING_SEGMENTATION_CONTEXT",{err:(0,g.getFormattedErrorMessage)(f)},{an:l.ApiEnum.GET_FLAG,uuid:n.getUuid(),sId:n.getSessionId()}),[3,4];case 4:return[2]}}))}))},e.prototype.validateSegmentation=function(e,t){return r(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,this.evaluator.isSegmentationValid(e,t)];case 1:return[2,n.sent()]}}))}))},e}();t.SegmentationManager=d},2478:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.UrlEnum=void 0,function(e){e.EVENTS="/events/t",e.ATTRIBUTE_CHECK="/check-attribute",e.GET_USER_DATA="/get-user-details",e.BATCH_EVENTS="/server-side/batch-events-v2",e.SET_ALIAS="/user-alias/setUserAlias",e.GET_ALIAS="/user-alias/getAliasUserId"}(n||(t.UrlEnum=n={}))},2550:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformEnum=void 0,function(e){e.CLIENT="client",e.SERVER="server"}(n||(t.PlatformEnum=n={}))},2676:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.VWOBuilder=void 0;var a=n(6178),s=n(4464),u=n(4059),c=n(3860),l=n(9600),g=n(2974),p=n(7173),d=n(6089),f=n(5076),h=n(5576),v=n(4334),E=n(5946),y=n(477),m=n(6167),S=n(8634),_=n(8296),I=function(){function e(e){this.originalSettings={},this.isValidPollIntervalPassedFromInit=!1,this.isSettingsValid=!1,this.settingsFetchTime=void 0,this.options=e,this.defaultServiceContainer=new _.ServiceContainer(this.options)}return e.prototype.setNetworkManager=function(){var e,t,n,r;return this.options.edgeConfig&&!(0,p.isEmptyObject)(null===(e=this.options)||void 0===e?void 0:e.edgeConfig)&&(this.options.shouldWaitForTrackingCalls=!0),this.networkManager=new s.NetworkManager(this.logManager,null===(n=null===(t=this.options)||void 0===t?void 0:t.network)||void 0===n?void 0:n.client,null===(r=this.options)||void 0===r?void 0:r.retryConfig),this.logManager.debug((0,f.buildMessage)(g.DebugLogMessagesEnum.SERVICE_INITIALIZED,{service:"Network Layer"})),this.defaultServiceContainer.setNetworkManager(this.networkManager),this},e.prototype.initBatching=function(){var e;if(this.options.edgeConfig&&!(0,p.isEmptyObject)(null===(e=this.options)||void 0===e?void 0:e.edgeConfig)){var t=(new S.EdgeConfigModel).modelFromDictionary(this.options.edgeConfig);this.options.batchEventData={eventsPerRequest:t.getMaxEventsToBatch(),isEdgeEnvironment:!0}}return this.options.batchEventData&&(this.settingFileManager.isGatewayServiceProvided?this.logManager.info((0,f.buildMessage)(g.InfoLogMessagesEnum.GATEWAY_AND_BATCH_EVENTS_CONFIG_MISMATCH)):(!(0,p.isNumber)(this.options.batchEventData.eventsPerRequest)||this.options.batchEventData.eventsPerRequest<=0)&&(!(0,p.isNumber)(this.options.batchEventData.requestTimeInterval)||this.options.batchEventData.requestTimeInterval<=0)?this.logManager.errorLog("INVALID_BATCH_EVENTS_CONFIG",{},{an:m.ApiEnum.INIT}):(this.options.batchEventData.accountId=parseInt(this.options.accountId),this.batchEventsQueue=new E.BatchEventsQueue(Object.assign({},this.options.batchEventData),this.logManager),this.batchEventsQueue.flushAndClearTimer.bind(this.batchEventsQueue))),this.defaultServiceContainer.setBatchEventsQueue(this.batchEventsQueue),this.defaultServiceContainer.injectServiceContainer(this.defaultServiceContainer),this},e.prototype.fetchSettings=function(){var e=this,t=new h.Deferred;return this.isSettingsFetchInProgress?(t.resolve(this.originalSettings),t.promise):(this.isSettingsFetchInProgress=!0,this.settingFileManager.getSettings().then((function(n){e.isSettingsValid=e.settingFileManager.isSettingsValid,e.settingsFetchTime=e.settingFileManager.settingsFetchTime,e.isSettingsFetchInProgress=!1,t.resolve(n)})),t.promise)},e.prototype.getSettings=function(){var e=new h.Deferred;try{this.settings?(this.logManager.info("Using already fetched and cached settings"),e.resolve(this.settings)):this.fetchSettings().then((function(t){e.resolve(t)}))}catch(t){this.logManager.errorLog("ERROR_FETCHING_SETTINGS",{err:(0,d.getFormattedErrorMessage)(t)},{an:m.ApiEnum.INIT},!1),e.resolve({})}return e.promise},e.prototype.setStorage=function(){var e,t,o,i;if(this.options.storage)this.storage=new u.Storage(this.options.storage),this.settingFileManager.isStorageServiceProvided=!0;else if("undefined"==typeof process&&"undefined"!=typeof window&&window.localStorage){var a=n(1007).BrowserStorageConnector,s=btoa(this.options.sdkKey),c="".concat(y.Constants.PRODUCT_NAME,"_").concat(this.options.accountId,"_").concat(s);this.storage=new u.Storage(new a(r(r({},this.options.clientStorage),{alwaysUseCachedSettings:null===(e=this.options.clientStorage)||void 0===e?void 0:e.alwaysUseCachedSettings,ttl:null===(t=this.options.clientStorage)||void 0===t?void 0:t.ttl}),c,this.logManager)),this.logManager.debug((0,f.buildMessage)(g.DebugLogMessagesEnum.SERVICE_INITIALIZED,{service:(null===(i=null===(o=this.options)||void 0===o?void 0:o.clientStorage)||void 0===i?void 0:i.provider)===sessionStorage?"Session Storage":"Local Storage"})),this.settingFileManager.isStorageServiceProvided=!0}else this.storage=null;return this.defaultServiceContainer.setStorage(this.storage),this},e.prototype.setSettingsService=function(){return this.settingFileManager=new l.SettingsService(this.options,this.logManager),this.defaultServiceContainer.setSettingsService(this.settingFileManager),this},e.prototype.getLogger=function(){return this.logManager},e.prototype.getSettingsService=function(){return this.settingFileManager},e.prototype.getStorage=function(){return this.storage},e.prototype.setLogger=function(){return this.logManager=new a.LogManager(this.options.logger||{}),this.logManager.debug((0,f.buildMessage)(g.DebugLogMessagesEnum.SERVICE_INITIALIZED,{service:"Logger"})),this.defaultServiceContainer.setLogManager(this.logManager),this},e.prototype.getRandomUserId=function(){var e="getRandomUserId";try{return this.logManager.debug((0,f.buildMessage)(g.DebugLogMessagesEnum.API_CALLED,{apiName:e})),(0,v.getRandomUUID)(this.options.sdkKey)}catch(t){this.logManager.errorLog("EXECUTION_FAILED",{apiName:e,err:(0,d.getFormattedErrorMessage)(t)})}},e.prototype.initPolling=function(){var e=this.options.pollInterval;return null!=e&&(0,p.isNumber)(e)&&e>=1e3?(this.isValidPollIntervalPassedFromInit=!0,this.checkAndPoll()):null!=e&&this.logManager.errorLog("INVALID_POLLING_CONFIGURATION",{key:"pollInterval",correctType:"number >= 1000"},{an:m.ApiEnum.INIT}),this},e.prototype.build=function(e){return this.originalSettings=e,this.vwoInstance=new c.VWOClient(e,this.options,this.defaultServiceContainer),this.updatePollIntervalAndCheckAndPoll(e,!0),this.vwoInstance},e.prototype.checkAndPoll=function(){var e,t=this,n=function(){return o(t,void 0,void 0,(function(){var e,t,r,o,a;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),[4,this.getSettings()];case 1:return(e=i.sent())&&Object.keys(e).length>0&&JSON.stringify(e)!==JSON.stringify(this.originalSettings)?(this.originalSettings=e,t=(0,d.cloneObject)(e),this.logManager.info(g.InfoLogMessagesEnum.POLLING_SET_SETTINGS),this.vwoInstance.updateSettings(t,!1),this.updatePollIntervalAndCheckAndPoll(e,!1)):e&&this.logManager.info(g.InfoLogMessagesEnum.POLLING_NO_CHANGE_IN_SETTINGS),[3,4];case 2:return r=i.sent(),this.logManager.errorLog("ERROR_FETCHING_SETTINGS_WITH_POLLING",{err:(0,d.getFormattedErrorMessage)(r)},{an:y.Constants.POLLING}),[3,4];case 3:return o=null!==(a=this.options.pollInterval)&&void 0!==a?a:y.Constants.POLLING_INTERVAL,setTimeout(n,o),[7];case 4:return[2]}}))}))},r=null!==(e=this.options.pollInterval)&&void 0!==e?e:y.Constants.POLLING_INTERVAL;setTimeout(n,r)},e.prototype.updatePollIntervalAndCheckAndPoll=function(e,t){var n;if(!this.isValidPollIntervalPassedFromInit){var r=null!==(n=null==e?void 0:e.pollInterval)&&void 0!==n?n:y.Constants.POLLING_INTERVAL;this.logManager.debug((0,f.buildMessage)(g.DebugLogMessagesEnum.USING_POLL_INTERVAL_FROM_SETTINGS,{source:(null==e?void 0:e.pollInterval)?"settings":"default",pollInterval:r.toString()})),this.options.pollInterval=r}t&&!this.isValidPollIntervalPassedFromInit&&this.checkAndPoll()},e}();t.VWOBuilder=I},2974:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorLogMessagesEnum=t.InfoLogMessagesEnum=t.DebugLogMessagesEnum=void 0;var o=r(n(6826)),i=o.default.default||o.default,a=i.debugMessages;t.DebugLogMessagesEnum=a;var s=i.infoMessages;t.InfoLogMessagesEnum=s;var u=i.errorMessagesV2;t.ErrorLogMessagesEnum=u},3090:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.FlagApi=t.Flag=void 0;var a=n(834),s=n(6167),u=n(6947),c=n(2974),l=n(8198),g=n(2160),p=n(1463),d=n(6178),f=n(1566),h=n(5479),v=n(7173),E=n(9455),y=n(6089),m=n(9284),S=n(5076),_=n(5576),I=n(689),T=n(7543),b=n(7294),O=n(477),A=n(5479),C=function(){function e(e,t,n){this.enabled=e,this.variation=n,this.sessionId=t}return e.prototype.isEnabled=function(){return this.enabled},e.prototype.getSessionId=function(){return this.sessionId},e.prototype.getVariables=function(){var e;return(null===(e=this.variation)||void 0===e?void 0:e.getVariables())||[]},e.prototype.getVariable=function(e,t){var n,r,o=null===(r=null===(n=this.variation)||void 0===n?void 0:n.getVariables().find((function(t){return g.VariableModel.modelFromDictionary(t).getKey()===e})))||void 0===r?void 0:r.getValue();return void 0!==o?o:t},e}();t.Flag=C;var R=function(){function e(){}return e.get=function(e,t,n){return o(this,void 0,void 0,(function(){var o,g,R,M,w,N,V,D,P,U,G,F,k,x,j,K,W,H,B,q,Y,Q,X,Z,J,z,$,ee,te,ne,re,oe,ie,ae,se;return i(this,(function(i){switch(i.label){case 0:return o=!1,g=null,R=null,M=!1,w={},N=new _.Deferred,V=new Map,D=(0,y.getFeatureFromKey)(n.getSettings(),e),P={featureName:null==D?void 0:D.getName(),featureId:null==D?void 0:D.getId(),featureKey:null==D?void 0:D.getKey(),userId:null==t?void 0:t.getId(),api:s.ApiEnum.GET_FLAG},U={an:s.ApiEnum.GET_FLAG,uuid:t.getUuid(),fk:null==D?void 0:D.getKey(),sId:t.getSessionId()},G=new f.StorageService(n),[4,(new a.StorageDecorator).getFeatureFromStorage(e,t,G,n)];case 1:if((null==(F=i.sent())?void 0:F.featureId)&&(0,A.isFeatureIdPresentInSettings)(n.getSettings(),F.featureId))if(null==F?void 0:F.experimentVariationId){if(F.experimentKey&&(re=(0,h.getVariationFromCampaignKey)(n.getSettings(),F.experimentKey,F.experimentVariationId)))return n.getLogManager().info((0,S.buildMessage)(c.InfoLogMessagesEnum.STORED_VARIATION_FOUND,{variationKey:re.getKey(),userId:t.getId(),experimentType:"experiment",experimentKey:F.experimentKey})),N.resolve(new C(!0,t.getSessionId(),re)),[2,N.promise]}else(null==F?void 0:F.rolloutKey)&&(null==F?void 0:F.rolloutId)&&(re=(0,h.getVariationFromCampaignKey)(n.getSettings(),F.rolloutKey,F.rolloutVariationId))&&(n.getLogManager().info((0,S.buildMessage)(c.InfoLogMessagesEnum.STORED_VARIATION_FOUND,{variationKey:re.getKey(),userId:t.getId(),experimentType:"rollout",experimentKey:F.rolloutKey})),n.getLogManager().debug((0,S.buildMessage)(c.DebugLogMessagesEnum.EXPERIMENTS_EVALUATION_WHEN_ROLLOUT_PASSED,{userId:t.getId()})),o=!0,M=!0,g=re,k={rolloutId:F.rolloutId,rolloutKey:F.rolloutKey,rolloutVariationId:F.rolloutVariationId},V.set(e,k),Object.assign(w,k));return(0,v.isObject)(D)&&void 0!==D?[4,n.getSegmentationManager().setContextualData(n,D,t)]:(n.getLogManager().errorLog("FEATURE_NOT_FOUND",{featureKey:e},U),N.reject({}),[2,N.promise]);case 2:if(i.sent(),!((x=(0,y.getSpecificRulesBasedOnType)(D,u.CampaignTypeEnum.ROLLOUT)).length>0)||o)return[3,10];j=[],K=0,W=x,i.label=3;case 3:return K<W.length?(J=W[K],[4,(0,I.evaluateRule)(n,D,J,t,V,null,G,P)]):[3,6];case 4:return H=i.sent(),$=H.preSegmentationResult,te=H.updatedDecision,Object.assign(P,te),$?(j.push(J),V.set(e,{rolloutId:J.getId(),rolloutKey:J.getKey(),rolloutVariationId:null===(oe=J.getVariations()[0])||void 0===oe?void 0:oe.getId()}),[3,6]):[3,5];case 5:return K++,[3,3];case 6:return j.length>0?(B=(new l.CampaignModel).modelFromDictionary(j[0]),re=(0,E.evaluateTrafficAndGetVariation)(n,B,t.getId()),(0,v.isObject)(re)&&Object.keys(re).length>0?(o=!0,M=!0,g=re,L(B,re,w,P),n.getShouldWaitForTrackingCalls()?[4,(0,m.createAndSendImpressionForVariationShown)(n,B.getId(),re.getId(),t,e)]:[3,8]):[3,9]):[3,9];case 7:return i.sent(),[3,9];case 8:(0,m.createAndSendImpressionForVariationShown)(n,B.getId(),re.getId(),t,e),i.label=9;case 9:return[3,11];case 10:0===x.length&&(n.getLogManager().debug(c.DebugLogMessagesEnum.EXPERIMENTS_EVALUATION_WHEN_NO_ROLLOUT_PRESENT),M=!0),i.label=11;case 11:if(!M)return[3,18];q=[],Y=(0,y.getAllExperimentRules)(D),Q=new Map,X=0,Z=Y,i.label=12;case 12:return X<Z.length?(J=Z[X],[4,(0,I.evaluateRule)(n,D,J,t,V,Q,G,P)]):[3,15];case 13:return z=i.sent(),$=z.preSegmentationResult,ee=z.whitelistedObject,te=z.updatedDecision,Object.assign(P,te),$?(null===ee?q.push(J):(o=!0,R=ee.variation,Object.assign(w,{experimentId:J.getId(),experimentKey:J.getKey(),experimentVariationId:ee.variationId})),[3,15]):[3,14];case 14:return X++,[3,12];case 15:return q.length>0?(ne=(new l.CampaignModel).modelFromDictionary(q[0]),re=(0,E.evaluateTrafficAndGetVariation)(n,ne,t.getId()),(0,v.isObject)(re)&&Object.keys(re).length>0?(o=!0,R=re,L(ne,re,w,P),n.getShouldWaitForTrackingCalls()?[4,(0,m.createAndSendImpressionForVariationShown)(n,ne.getId(),re.getId(),t,e)]:[3,17]):[3,18]):[3,18];case 16:return i.sent(),[3,18];case 17:(0,m.createAndSendImpressionForVariationShown)(n,ne.getId(),re.getId(),t,e),i.label=18;case 18:return o&&(new a.StorageDecorator).setDataInStorage(r({featureKey:e,featureId:D.getId(),context:t},w),G,n),n.getHooksService().set(P),n.getHooksService().execute(n.getHooksService().get()),D.getIsDebuggerEnabled()&&(U.cg=b.DebuggerCategoryEnum.DECISION,U.lt=d.LogLevelEnum.INFO.toString(),U.msg_t=O.Constants.FLAG_DECISION_GIVEN,function(e,t){var n=(0,T.extractDecisionKeys)(t),r="Flag decision given for feature:".concat(t.featureKey,".");t.rolloutKey&&t.rolloutVariationId&&(r+=" Got rollout:".concat(t.rolloutKey.substring((t.featureKey+"_").length)," with variation:").concat(t.rolloutVariationId)),t.experimentKey&&t.experimentVariationId&&(r+=" and experiment:".concat(t.experimentKey.substring((t.featureKey+"_").length)," with variation:").concat(t.experimentVariationId)),e.msg=r,Object.assign(e,n)}(U,P),(0,T.sendDebugEventToVWO)(n,U)),(null===(ie=D.getImpactCampaign())||void 0===ie?void 0:ie.getCampaignId())?(n.getLogManager().info((0,S.buildMessage)(c.InfoLogMessagesEnum.IMPACT_ANALYSIS,{userId:t.getId(),featureKey:e,status:o?"enabled":"disabled"})),n.getShouldWaitForTrackingCalls()?[4,(0,m.createAndSendImpressionForVariationShown)(n,null===(ae=D.getImpactCampaign())||void 0===ae?void 0:ae.getCampaignId(),o?2:1,t,e)]:[3,20]):[3,21];case 19:return i.sent(),[3,21];case 20:(0,m.createAndSendImpressionForVariationShown)(n,null===(se=D.getImpactCampaign())||void 0===se?void 0:se.getCampaignId(),o?2:1,t,e),i.label=21;case 21:return N.resolve(new C(o,t.getSessionId(),(new p.VariationModel).modelFromDictionary(null!=R?R:g))),[2,N.promise]}}))}))},e}();function L(e,t,n,r){e.getType()===u.CampaignTypeEnum.ROLLOUT?Object.assign(n,{rolloutId:e.getId(),rolloutKey:e.getKey(),rolloutVariationId:t.getId()}):Object.assign(n,{experimentId:e.getId(),experimentKey:e.getKey(),experimentVariationId:t.getId()}),Object.assign(r,n)}t.FlagApi=R},3166:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextVWOModel=void 0;var n=function(){function e(){}return e.prototype.modelFromDictionary=function(e){return(null==e?void 0:e.location)&&(this.location=e.location),(null==e?void 0:e.userAgent)&&(this.userAgent=e.userAgent),this},e.prototype.getLocation=function(){return this.location},e.prototype.getUaInfo=function(){return this.userAgent},e}();t.ContextVWOModel=n},3289:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7173),o=function(){function e(e){var t;this.callback=null===(t=e.integrations)||void 0===t?void 0:t.callback,this.isCallBackFunction=(0,r.isFunction)(this.callback),this.decision={}}return e.prototype.execute=function(e){this.isCallBackFunction&&this.callback(e)},e.prototype.set=function(e){this.isCallBackFunction&&(this.decision=e)},e.prototype.get=function(){return this.decision},e}();t.default=o},3388:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HTTPS_PROTOCOL=t.HTTP_PROTOCOL=t.SEED_URL=t.HTTPS=t.HTTP=void 0,t.HTTP="http",t.HTTPS="https",t.SEED_URL="https://vwo.com",t.HTTP_PROTOCOL="".concat(t.HTTP,"://"),t.HTTPS_PROTOCOL="".concat(t.HTTPS)},3585:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentOperandRegexEnum=void 0,function(e){e.LOWER="^lower",e.LOWER_MATCH="^lower\\((.*)\\)",e.WILDCARD="^wildcard",e.WILDCARD_MATCH="^wildcard\\((.*)\\)",e.REGEX="^regex",e.REGEX_MATCH="^regex\\((.*)\\)",e.STARTING_STAR="^\\*",e.ENDING_STAR="\\*$",e.GREATER_THAN_MATCH="^gt\\((\\d+(?:\\.\\d+)*|\\.\\d+)\\)",e.GREATER_THAN_EQUAL_TO_MATCH="^gte\\((\\d+(?:\\.\\d+)*|\\.\\d+)\\)",e.LESS_THAN_MATCH="^lt\\((\\d+(?:\\.\\d+)*|\\.\\d+)\\)",e.LESS_THAN_EQUAL_TO_MATCH="^lte\\((\\d+(?:\\.\\d+)*|\\.\\d+)\\)"}(n||(t.SegmentOperandRegexEnum=n={}))},3647:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseModel=void 0;var r=n(6089),o=function(){function e(){}return e.prototype.setStatusCode=function(e){this.statusCode=e},e.prototype.setHeaders=function(e){this.headers=e},e.prototype.setData=function(e){this.data=e},e.prototype.setError=function(e){this.error=(0,r.getFormattedErrorMessage)(e)},e.prototype.getHeaders=function(){return this.headers},e.prototype.getData=function(){return this.data},e.prototype.getStatusCode=function(){return this.statusCode},e.prototype.getError=function(){return this.error},e.prototype.setTotalAttempts=function(e){this.totalAttempts=e},e.prototype.getTotalAttempts=function(){return this.totalAttempts},e}();t.ResponseModel=o},3725:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.RequestModel=void 0;var o=n(5212),i=n(3388),a=n(477),s=n(7173),u=n(6089),c=function(){function e(e,t,n,r,s,u,c,l,g){void 0===t&&(t=o.HttpMethodEnum.GET),void 0===c&&(c=i.HTTPS),this.whiteListedKeys=["eventName","uuid","campaignId","eventProperties"],this.url=e,this.method=t,this.path=n,this.query=r,this.body=s,this.headers=u,this.scheme=c,this.port=l,this.retryConfig=g||a.Constants.DEFAULT_RETRY_CONFIG}return e.prototype.getMethod=function(){return this.method},e.prototype.setMethod=function(e){this.method=e},e.prototype.getBody=function(){return this.body},e.prototype.setBody=function(e){this.body=e},e.prototype.setQuery=function(e){this.query=e},e.prototype.getQuery=function(){return this.query},e.prototype.setHeaders=function(e){return this.headers=e,this},e.prototype.getHeaders=function(){return this.headers},e.prototype.setTimeout=function(e){return this.timeout=e,this},e.prototype.getTimeout=function(){return this.timeout},e.prototype.getUrl=function(){return this.url},e.prototype.setUrl=function(e){return this.url=e,this},e.prototype.getScheme=function(){return this.scheme},e.prototype.setScheme=function(e){return this.scheme=e,this},e.prototype.getPort=function(){return this.port},e.prototype.setPort=function(e){return this.port=e,this},e.prototype.getPath=function(){return this.path},e.prototype.setPath=function(e){return this.path=e,this},e.prototype.getRetryConfig=function(){return r({},this.retryConfig)},e.prototype.setRetryConfig=function(e){return this.retryConfig=e,this},e.prototype.setEventName=function(e){return this.eventName=e,this},e.prototype.getEventName=function(){return this.eventName},e.prototype.setUuid=function(e){return this.uuid=e,this},e.prototype.getUuid=function(){return this.uuid},e.prototype.setCampaignId=function(e){return this.campaignId=e,this},e.prototype.getCampaignId=function(){return this.campaignId},e.prototype.setEventProperties=function(e){return this.eventProperties=e,this},e.prototype.getEventProperties=function(){return this.eventProperties},e.prototype.getLastError=function(){return this.lastError},e.prototype.setLastError=function(e){return this.lastError=(0,u.getFormattedErrorMessage)(e),this},e.prototype.getOptions=function(){var e="";for(var t in this.query)e+="".concat(t,"=").concat(this.query[t],"&");var n=this.url.split("/"),r=n[0],o=n[1],i={hostname:r,agent:!1};if(this.scheme&&(i.scheme=this.scheme),this.port&&(i.port=this.port),this.headers&&(i.headers=this.headers),this.method&&(i.method=this.method),this.body){var a=JSON.stringify(this.body);i.headers=i.headers||{},i.headers["Content-Type"]="application/json","undefined"==typeof Buffer?i.headers["Content-Length"]=(new TextEncoder).encode(a).length:i.headers["Content-Length"]=Buffer.byteLength(a),i.body=this.body}return this.path&&(i.path=""!==e?this.path+"?"+e||"":this.path),o&&(i.path="/".concat(o)+i.path),this.timeout&&(i.timeout=this.timeout),"&"===i.path.charAt(i.path.length-1)&&(i.path=i.path.substring(0,i.path.length-1)),i.retryConfig=this.retryConfig,i},e.prototype.getExtraInfo=function(){var e=this;return Object.fromEntries(Object.entries(this).filter((function(t){var n=t[0],r=t[1];return!(0,s.isNull)(r)&&!(0,s.isUndefined)(r)&&e.whiteListedKeys.includes(n)})))},e}();t.RequestModel=c},3860:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.VWOClient=void 0;var a=n(3090),s=n(5810),u=n(9955),c=n(2974),l=n(5600),g=n(8606),p=n(7173),d=n(5076),f=n(5576),h=n(7788),v=n(1463),E=n(6167),y=n(1013),m=n(6887),S=n(7173),_=n(6089),I=n(9308),T=n(5291),b=n(1566),O=function(){function e(e,t,n){try{this.options=t,this.serviceContainer=n,this.isSettingsValid=(new l.SettingsSchema).isSettingsValid(e),this.isAliasingEnabled=t.isAliasingEnabled||!1,this.isSettingsValid&&!this.serviceContainer.getSettingsService().isSettingsProvidedInInit?this.serviceContainer.getLogManager().info(c.InfoLogMessagesEnum.SETTINGS_FETCH_SUCCESS):!this.isSettingsValid&&this.options.settings&&this.serviceContainer.getLogManager().errorLog("INVALID_SETTINGS_SCHEMA",{},{an:E.ApiEnum.INIT},!1),(0,h.setSettingsAndAddCampaignsToRules)(e,this,this.serviceContainer.getLogManager()),this.serviceContainer.setSettings(this.settings),this.serviceContainer.injectServiceContainer(this.serviceContainer),this.serviceContainer.setShouldWaitForTrackingCalls(this.options.shouldWaitForTrackingCalls||!1),this.serviceContainer.getLogManager().info(c.InfoLogMessagesEnum.CLIENT_INITIALIZED),this.vwoClientInstance=this;var r=new T.UsageStatsUtil(this.options);return this.sendSdkInitAndUsageStatsEvents(r),this}catch(e){this.serviceContainer.getLogManager().errorLog("EXECUTION_FAILED",{apiName:E.ApiEnum.INIT,err:(0,_.getFormattedErrorMessage)(e)},{an:E.ApiEnum.INIT},!1)}}return e.prototype.sendSdkInitAndUsageStatsEvents=function(e){return o(this,void 0,void 0,(function(){var t,n,r,o,a,s,u;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,7,,8]),t=this.serviceContainer.getSettingsService().settingsFetchTime,this.serviceContainer.getSettingsService().isSettingsProvidedInInit&&(t=0),n=Date.now()-this.serviceContainer.getSettingsService().startTimeForInit,!this.isSettingsValid||(null===(s=null===(a=this.originalSettings)||void 0===a?void 0:a.sdkMetaInfo)||void 0===s?void 0:s.wasInitializedEarlier)?[3,3]:this.options.shouldWaitForTrackingCalls?[4,(0,I.sendSdkInitEvent)(t,n,this.serviceContainer)]:[3,2];case 1:return i.sent(),[3,3];case 2:(0,I.sendSdkInitEvent)(t,n,this.serviceContainer),i.label=3;case 3:return(r=null===(u=this.originalSettings)||void 0===u?void 0:u.usageStatsAccountId)?this.options.shouldWaitForTrackingCalls?[4,(0,I.sendSDKUsageStatsEvent)(r,this.serviceContainer,e)]:[3,5]:[3,6];case 4:return i.sent(),[3,6];case 5:(0,I.sendSDKUsageStatsEvent)(r,this.serviceContainer,e),i.label=6;case 6:return[3,8];case 7:return o=i.sent(),this.serviceContainer.getLogManager().error((0,d.buildMessage)(c.ErrorLogMessagesEnum.SDK_INIT_EVENT_FAILED,{err:(0,_.getFormattedErrorMessage)(o)})),[3,8];case 8:return[2]}}))}))},e.prototype.getFlag=function(e,t){return o(this,void 0,void 0,(function(){var n,o,s,u,l,h,y,S;return i(this,(function(i){switch(i.label){case 0:n=E.ApiEnum.GET_FLAG,o=new f.Deferred,s=new a.Flag(!1,null!==(S=null==t?void 0:t.sessionId)&&void 0!==S?S:(0,_.getCurrentUnixTimestamp)(),new v.VariationModel),i.label=1;case 1:if(i.trys.push([1,3,,4]),this.serviceContainer.getLogManager().debug((0,d.buildMessage)(c.DebugLogMessagesEnum.API_CALLED,{apiName:n})),!(0,p.isString)(e))throw this.serviceContainer.getLogManager().errorLog("INVALID_PARAM",{apiName:n,key:"featureKey",type:(0,p.getType)(e),correctType:"string"},{an:E.ApiEnum.GET_FLAG},!1),new TypeError("TypeError: featureKey should be a string, got "+(0,p.getType)(e));if(!this.isSettingsValid)throw this.serviceContainer.getLogManager().errorLog("INVALID_SETTINGS_SCHEMA",{},{an:E.ApiEnum.GET_FLAG},!1),new Error("TypeError: Invalid Settings");if(!t||!t.id)throw this.serviceContainer.getLogManager().errorLog("INVALID_CONTEXT_PASSED",{},{an:E.ApiEnum.GET_FLAG},!1),new TypeError("TypeError: Invalid context");return[4,(0,m.getUserId)(t.id,this.isAliasingEnabled,this.serviceContainer)];case 2:return u=i.sent(),(l=r({},t)).id=u,h=(new g.ContextModel).modelFromDictionary(l,this.options),a.FlagApi.get(e,h,this.serviceContainer).then((function(e){o.resolve(e)})).catch((function(){o.resolve(s)})),[3,4];case 3:return y=i.sent(),this.serviceContainer.getLogManager().errorLog("EXECUTION_FAILED",{apiName:n,err:(0,_.getFormattedErrorMessage)(y)},{an:E.ApiEnum.GET_FLAG}),o.resolve(s),[3,4];case 4:return[2,o.promise]}}))}))},e.prototype.trackEvent=function(e,t){return o(this,arguments,void 0,(function(e,t,n){var o,a,s,l,h,v,y;return void 0===n&&(n={}),i(this,(function(i){switch(i.label){case 0:o=E.ApiEnum.TRACK_EVENT,a=new f.Deferred,i.label=1;case 1:if(i.trys.push([1,3,,4]),this.serviceContainer.getLogManager().debug((0,d.buildMessage)(c.DebugLogMessagesEnum.API_CALLED,{apiName:o})),!(0,p.isString)(e))throw this.serviceContainer.getLogManager().errorLog("INVALID_PARAM",{apiName:o,key:"eventName",type:(0,p.getType)(e),correctType:"string"},{an:E.ApiEnum.TRACK_EVENT},!1),new TypeError("TypeError: Event-name should be a string, got "+(0,p.getType)(e));if(!(0,p.isObject)(n))throw this.serviceContainer.getLogManager().errorLog("INVALID_PARAM",{apiName:o,key:"eventProperties",type:(0,p.getType)(n),correctType:"object"},{an:E.ApiEnum.TRACK_EVENT},!1),new TypeError("TypeError: eventProperties should be an object, got "+(0,p.getType)(n));if(!this.isSettingsValid)throw this.serviceContainer.getLogManager().errorLog("INVALID_SETTINGS_SCHEMA",{},{an:E.ApiEnum.TRACK_EVENT},!1),new Error("TypeError: Invalid Settings");if(!t||!t.id)throw this.serviceContainer.getLogManager().errorLog("INVALID_CONTEXT_PASSED",{},{an:E.ApiEnum.TRACK_EVENT},!1),new TypeError("TypeError: Invalid context");return[4,(0,m.getUserId)(t.id,this.isAliasingEnabled,this.serviceContainer)];case 2:return s=i.sent(),(l=r({},t)).id=s,h=(new g.ContextModel).modelFromDictionary(l,this.options),(new u.TrackApi).track(this.serviceContainer,e,h,n).then((function(e){a.resolve(e)})).catch((function(){var t;a.resolve(((t={})[e]=!1,t))})),[3,4];case 3:return v=i.sent(),this.serviceContainer.getLogManager().errorLog("EXECUTION_FAILED",{apiName:o,err:(0,_.getFormattedErrorMessage)(v)},{an:E.ApiEnum.TRACK_EVENT}),a.resolve(((y={})[e]=!1,y)),[3,4];case 4:return[2,a.promise]}}))}))},e.prototype.setAttribute=function(e,t,n){return o(this,void 0,void 0,(function(){var o,a,u,l,f,h,v,y,S,I;return i(this,(function(i){switch(i.label){case 0:o=E.ApiEnum.SET_ATTRIBUTE,i.label=1;case 1:if(i.trys.push([1,8,,9]),!(0,p.isObject)(e))return[3,4];if(this.serviceContainer.getLogManager().debug((0,d.buildMessage)(c.DebugLogMessagesEnum.API_CALLED,{apiName:o})),Object.entries(e).length<1)throw new TypeError("TypeError: Attributes should be an object containing at least 1 key-value pair");if(a=e,!(0,p.isObject)(a))throw new TypeError("TypeError: attributes should be an object containing key-value pairs");if(Object.entries(a).forEach((function(e){var t=e[0],n=e[1];if("boolean"!=typeof n&&"string"!=typeof n&&"number"!=typeof n)throw new TypeError('Invalid attribute type for key "'.concat(t,'". Expected boolean, string or number, but got ').concat((0,p.getType)(n)));if(Array.isArray(n)||"object"==typeof n&&null!==n)throw new TypeError('Invalid attribute value for key "'.concat(t,'". Arrays and objects are not supported.'))})),!n&&t&&(n=t),!n||!n.id)throw this.serviceContainer.getLogManager().errorLog("INVALID_CONTEXT_PASSED",{},{an:E.ApiEnum.SET_ATTRIBUTE},!1),new TypeError("TypeError: Invalid context");return[4,(0,m.getUserId)(n.id,this.isAliasingEnabled,this.serviceContainer)];case 2:return f=i.sent(),(h=r({},n)).id=f,v=(new g.ContextModel).modelFromDictionary(h,this.options),[4,(new s.SetAttributeApi).setAttribute(this.serviceContainer,a,v)];case 3:return i.sent(),[3,7];case 4:if(u=e,l=t,!(0,p.isString)(u))throw new TypeError("attributeKey should be a string");if(!(0,p.isBoolean)(l)&&!(0,p.isString)(l)&&!(0,p.isNumber)(l))throw new TypeError("attributeValue should be a boolean, string, or number");if(!n||!n.id)throw new TypeError("Invalid context");return[4,(0,m.getUserId)(n.id,this.isAliasingEnabled,this.serviceContainer)];case 5:return f=i.sent(),(h=r({},n)).id=f,v=(new g.ContextModel).modelFromDictionary(h,this.options),(I={})[u]=l,y=I,[4,(new s.SetAttributeApi).setAttribute(this.serviceContainer,y,v)];case 6:i.sent(),i.label=7;case 7:return[3,9];case 8:return S=i.sent(),this.serviceContainer.getLogManager().errorLog("EXECUTION_FAILED",{apiName:o,err:(0,_.getFormattedErrorMessage)(S)},{an:E.ApiEnum.SET_ATTRIBUTE}),[3,9];case 9:return[2]}}))}))},e.prototype.updateSettings=function(e){return o(this,arguments,void 0,(function(e,t){var n,r,o,a,s;return void 0===t&&(t=!0),i(this,(function(i){switch(i.label){case 0:n=E.ApiEnum.UPDATE_SETTINGS,i.label=1;case 1:return i.trys.push([1,5,,6]),this.serviceContainer.getLogManager().debug((0,d.buildMessage)(c.DebugLogMessagesEnum.API_CALLED,{apiName:n})),e&&0!==Object.keys(e).length?[3,3]:[4,this.serviceContainer.getSettingsService().fetchSettings(t,n)];case 2:return o=i.sent(),[3,4];case 3:o=e,i.label=4;case 4:if(r=o,a=this.serviceContainer.getSettingsService().normalizeSettings(r),!(new l.SettingsSchema).isSettingsValid(a))throw new Error("TypeError: Invalid Settings schema");return(0,h.setSettingsAndAddCampaignsToRules)(a,this.vwoClientInstance,this.serviceContainer.getLogManager()),this.serviceContainer.setSettings(this.vwoClientInstance.settings),this.serviceContainer.injectServiceContainer(this.serviceContainer),this.serviceContainer.getLogManager().info((0,d.buildMessage)(c.InfoLogMessagesEnum.SETTINGS_UPDATED,{apiName:n,isViaWebhook:t})),[3,6];case 5:return s=i.sent(),this.serviceContainer.getLogManager().errorLog("UPDATING_CLIENT_INSTANCE_FAILED_WHEN_WEBHOOK_TRIGGERED",{apiName:n,isViaWebhook:t,err:(0,_.getFormattedErrorMessage)(s)},{an:E.ApiEnum.UPDATE_SETTINGS}),[3,6];case 6:return[2]}}))}))},e.prototype.flushEvents=function(){return o(this,void 0,void 0,(function(){var e,t,n,r,o,a,s,u=this;return i(this,(function(i){switch(i.label){case 0:e=E.ApiEnum.FLUSH_EVENTS,i.label=1;case 1:return i.trys.push([1,3,,4]),this.serviceContainer.getLogManager().debug((0,d.buildMessage)(c.DebugLogMessagesEnum.API_CALLED,{apiName:e})),this.serviceContainer.getBatchEventsQueue()?(t=[this.serviceContainer.getBatchEventsQueue().flushAndClearTimer()],(null===(o=this.options)||void 0===o?void 0:o.edgeConfig)&&Object.keys(this.options.edgeConfig).length>0&&(null===(a=this.options)||void 0===a?void 0:a.accountId)&&(null===(s=this.options)||void 0===s?void 0:s.sdkKey)&&(n=new b.StorageService(this.serviceContainer),t.push(n.setFreshSettingsInStorage(parseInt(this.options.accountId),this.options.sdkKey).catch((function(e){u.serviceContainer.getLogManager().errorLog("ERROR_STORING_SETTINGS_IN_STORAGE",{err:(0,_.getFormattedErrorMessage)(e)},{an:E.ApiEnum.FLUSH_EVENTS})})))),[4,Promise.all(t)]):(this.serviceContainer.getLogManager().errorLog("BATCHING_NOT_ENABLED",{},{an:E.ApiEnum.FLUSH_EVENTS}),[2,{status:"error",events:[]}]);case 2:return[2,i.sent()[0]];case 3:return r=i.sent(),this.serviceContainer.getLogManager().errorLog("EXECUTION_FAILED",{apiName:e,err:(0,_.getFormattedErrorMessage)(r)},{an:E.ApiEnum.FLUSH_EVENTS}),[2,{status:"error",events:[]}];case 4:return[2]}}))}))},e.prototype.setAlias=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:n=E.ApiEnum.SET_ALIAS,i.label=1;case 1:if(i.trys.push([1,3,,4]),this.serviceContainer.getLogManager().debug((0,d.buildMessage)(c.DebugLogMessagesEnum.API_CALLED,{apiName:n})),!this.isAliasingEnabled)return this.serviceContainer.getLogManager().errorLog("ALIAS_CALLED_BUT_NOT_PASSED",{},{an:E.ApiEnum.SET_ALIAS}),[2,!1];if(!this.serviceContainer.getSettingsService().isGatewayServiceProvided)return this.serviceContainer.getLogManager().errorLog("INVALID_GATEWAY_URL",{},{an:E.ApiEnum.SET_ALIAS}),[2,!1];if(!t)throw new TypeError("TypeError: Invalid aliasId");if((0,S.isArray)(t))throw new TypeError("TypeError: aliasId cannot be an array");if(t=t.trim(),r=void 0,"string"==typeof e){if((e=e.trim())===t)throw new TypeError("UserId and aliasId cannot be the same.");if(!e)throw new TypeError("TypeError: Invalid userId");if((0,S.isArray)(e))throw new TypeError("TypeError: userId cannot be an array");r=e}else{if(!e||!e.id)throw new TypeError("TypeError: Invalid context");if((0,S.isArray)(e.id))throw new TypeError("TypeError: context.id cannot be an array");if(e.id=e.id.trim(),e.id===t)throw new TypeError("UserId and aliasId cannot be the same.");r=e.id}return[4,y.AliasingUtil.setAlias(r,t,this.serviceContainer)];case 2:return i.sent(),[2,!0];case 3:return o=i.sent(),this.serviceContainer.getLogManager().errorLog("EXECUTION_FAILED",{apiName:n,err:(0,_.getFormattedErrorMessage)(o)},{an:E.ApiEnum.SET_ALIAS}),[2,!1];case 4:return[2]}}))}))},e}();t.VWOClient=O},3903:e=>{"use strict";e.exports=require("uuid")},3904:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentOperandEvaluator=void 0;var i=n(7131),a=n(9227),s=n(3585),u=n(2106),c=n(7173),l=n(596),g=n(2478),p=n(6167),d=n(6089),f=function(){function e(e){this.serviceContainer=e}return e.prototype.evaluateCustomVariableDSL=function(e,t,n){return r(this,void 0,void 0,(function(){var r,a,s,u,c,f,h,v,E,y,m,S,_,I,T,b,O;return o(this,(function(o){switch(o.label){case 0:if(r=(0,i.getKeyValue)(e),a=r.key,s=r.value,u=a,c=s,!Object.prototype.hasOwnProperty.call(t,u))return[2,!1];if(!c.includes("inlist"))return[3,5];if(f=/inlist\(([^)]+)\)/,!(h=c.match(f))||h.length<2)return this.serviceContainer.getLogManager().errorLog("INVALID_ATTRIBUTE_LIST_FORMAT",{},{an:p.ApiEnum.GET_FLAG,uuid:n.getUuid(),sId:n.getSessionId()}),[2,!1];_=t[u],v=this.preProcessTagValue(_),E=h[1],y={attribute:v,listId:E},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,(0,l.getFromGatewayService)(this.serviceContainer,y,g.UrlEnum.ATTRIBUTE_CHECK,n)];case 2:return(m=o.sent())&&void 0!==m&&"false"!==m&&0!==m.status?[2,m]:[2,!1];case 3:return S=o.sent(),this.serviceContainer.getLogManager().errorLog("ERROR_FETCHING_DATA_FROM_GATEWAY",{err:(0,d.getFormattedErrorMessage)(S)},{an:p.ApiEnum.GET_FLAG,uuid:n.getUuid(),sId:n.getSessionId()}),[2,!1];case 4:return[3,6];case 5:return _=t[u],_=this.preProcessTagValue(_),I=this.preProcessOperandValue(c),T=I.operandType,b=I.operandValue,O=this.processValues(b,_),_=O.tagValue,[2,this.extractResult(T,O.operandValue,_)];case 6:return[2]}}))}))},e.prototype.evaluateUserDSL=function(e,t){for(var n=e.split(","),r=0;r<n.length;r++)if(n[r].trim()==t._vwoUserId)return!0;return!1},e.prototype.evaluateUserAgentDSL=function(e,t){var n=e;if(!t.getUserAgent()||void 0===t.getUserAgent())return this.serviceContainer.getLogManager().errorLog("INVALID_USER_AGENT_IN_CONTEXT_FOR_PRE_SEGMENTATION",{},{an:p.ApiEnum.GET_FLAG,uuid:t.getUuid(),sId:t.getSessionId()}),!1;var r=decodeURIComponent(t.getUserAgent()),o=this.preProcessOperandValue(n),i=o.operandType,a=o.operandValue,s=this.processValues(a,r);return r=s.tagValue,this.extractResult(i,s.operandValue,r)},e.prototype.preProcessTagValue=function(e){return void 0===e&&(e=""),(0,c.isBoolean)(e)&&(e=!!e),null!==e&&(e=e.toString()),e},e.prototype.preProcessOperandValue=function(e){var t,n;if((0,i.matchWithRegex)(e,s.SegmentOperandRegexEnum.LOWER_MATCH))t=a.SegmentOperandValueEnum.LOWER_VALUE,n=this.extractOperandValue(e,s.SegmentOperandRegexEnum.LOWER_MATCH);else if((0,i.matchWithRegex)(e,s.SegmentOperandRegexEnum.WILDCARD_MATCH)){n=this.extractOperandValue(e,s.SegmentOperandRegexEnum.WILDCARD_MATCH);var r=(0,i.matchWithRegex)(n,s.SegmentOperandRegexEnum.STARTING_STAR),o=(0,i.matchWithRegex)(n,s.SegmentOperandRegexEnum.ENDING_STAR);r&&o?t=a.SegmentOperandValueEnum.STARTING_ENDING_STAR_VALUE:r?t=a.SegmentOperandValueEnum.STARTING_STAR_VALUE:o&&(t=a.SegmentOperandValueEnum.ENDING_STAR_VALUE),n=n.replace(new RegExp(s.SegmentOperandRegexEnum.STARTING_STAR),"").replace(new RegExp(s.SegmentOperandRegexEnum.ENDING_STAR),"")}else(0,i.matchWithRegex)(e,s.SegmentOperandRegexEnum.REGEX_MATCH)?(t=a.SegmentOperandValueEnum.REGEX_VALUE,n=this.extractOperandValue(e,s.SegmentOperandRegexEnum.REGEX_MATCH)):(0,i.matchWithRegex)(e,s.SegmentOperandRegexEnum.GREATER_THAN_MATCH)?(t=a.SegmentOperandValueEnum.GREATER_THAN_VALUE,n=this.extractOperandValue(e,s.SegmentOperandRegexEnum.GREATER_THAN_MATCH)):(0,i.matchWithRegex)(e,s.SegmentOperandRegexEnum.GREATER_THAN_EQUAL_TO_MATCH)?(t=a.SegmentOperandValueEnum.GREATER_THAN_EQUAL_TO_VALUE,n=this.extractOperandValue(e,s.SegmentOperandRegexEnum.GREATER_THAN_EQUAL_TO_MATCH)):(0,i.matchWithRegex)(e,s.SegmentOperandRegexEnum.LESS_THAN_MATCH)?(t=a.SegmentOperandValueEnum.LESS_THAN_VALUE,n=this.extractOperandValue(e,s.SegmentOperandRegexEnum.LESS_THAN_MATCH)):(0,i.matchWithRegex)(e,s.SegmentOperandRegexEnum.LESS_THAN_EQUAL_TO_MATCH)?(t=a.SegmentOperandValueEnum.LESS_THAN_EQUAL_TO_VALUE,n=this.extractOperandValue(e,s.SegmentOperandRegexEnum.LESS_THAN_EQUAL_TO_MATCH)):(t=a.SegmentOperandValueEnum.EQUAL_VALUE,n=e);return{operandType:t,operandValue:n}},e.prototype.extractOperandValue=function(e,t){return(0,i.matchWithRegex)(e,t)&&(0,i.matchWithRegex)(e,t)[1]},e.prototype.processValues=function(t,n,r){if(void 0===r&&(r=void 0),r===u.SegmentOperatorValueEnum.IP||r===u.SegmentOperatorValueEnum.BROWSER_VERSION||r===u.SegmentOperatorValueEnum.OS_VERSION)return{operandValue:t,tagValue:n};if(e.NON_NUMERIC_PATTERN.test(n))return{operandValue:t,tagValue:n};var o=parseFloat(t),i=parseFloat(n);return o&&i?{operandValue:o.toString(),tagValue:i.toString()}:{operandValue:t,tagValue:n}},e.prototype.extractResult=function(e,t,n){var r=!1;if(null===n)return!1;var o=String(t),i=String(n);switch(e){case a.SegmentOperandValueEnum.LOWER_VALUE:r=o.toLowerCase()===i.toLowerCase();break;case a.SegmentOperandValueEnum.STARTING_ENDING_STAR_VALUE:r=-1!==i.indexOf(o);break;case a.SegmentOperandValueEnum.STARTING_STAR_VALUE:r=i.endsWith(o);break;case a.SegmentOperandValueEnum.ENDING_STAR_VALUE:r=i.startsWith(o);break;case a.SegmentOperandValueEnum.REGEX_VALUE:try{r=null!==new RegExp(o).exec(i)}catch(e){r=!1}break;case a.SegmentOperandValueEnum.GREATER_THAN_VALUE:r=this.compareVersions(i,o)>0;break;case a.SegmentOperandValueEnum.GREATER_THAN_EQUAL_TO_VALUE:r=this.compareVersions(i,o)>=0;break;case a.SegmentOperandValueEnum.LESS_THAN_VALUE:r=this.compareVersions(i,o)<0;break;case a.SegmentOperandValueEnum.LESS_THAN_EQUAL_TO_VALUE:r=this.compareVersions(i,o)<=0;break;default:r=this.isVersionString(i)&&this.isVersionString(o)?0===this.compareVersions(i,o):i===o}return r},e.prototype.evaluateStringOperandDSL=function(e,t,n){var r=String(e),o=this.getTagValueForOperandType(t,n);if(null===o)return this.logMissingContextError(n),!1;var i=this.preProcessOperandValue(r),a=this.processValues(i.operandValue,o,n),s=a.tagValue;return this.extractResult(i.operandType,String(a.operandValue).trim().replace(/"/g,""),s)},e.prototype.getTagValueForOperandType=function(e,t){return t===u.SegmentOperatorValueEnum.IP?e.getIpAddress()||null:t===u.SegmentOperatorValueEnum.BROWSER_VERSION?this.getBrowserVersionFromContext(e):this.getOsVersionFromContext(e)},e.prototype.getBrowserVersionFromContext=function(e){var t,n=null===(t=e.getVwo())||void 0===t?void 0:t.getUaInfo();return n&&"object"==typeof n&&0!==Object.keys(n).length&&"browser_version"in n&&null!==n.browser_version?String(n.browser_version):null},e.prototype.getOsVersionFromContext=function(e){var t,n=null===(t=e.getVwo())||void 0===t?void 0:t.getUaInfo();return n&&"object"==typeof n&&0!==Object.keys(n).length&&"os_version"in n&&null!==n.os_version?String(n.os_version):null},e.prototype.logMissingContextError=function(e){e===u.SegmentOperatorValueEnum.IP?this.serviceContainer.getLogManager().info("To evaluate IP segmentation, please provide ipAddress in context"):e===u.SegmentOperatorValueEnum.BROWSER_VERSION?this.serviceContainer.getLogManager().info("To evaluate browser version segmentation, please provide userAgent in context"):this.serviceContainer.getLogManager().info("To evaluate OS version segmentation, please provide userAgent in context")},e.prototype.isVersionString=function(e){return/^(\d+\.)*\d+$/.test(e)},e.prototype.compareVersions=function(e,t){for(var n=e.split(".").map((function(e){return e.match(/^\d+$/)?parseInt(e,10):0})),r=t.split(".").map((function(e){return e.match(/^\d+$/)?parseInt(e,10):0})),o=Math.max(n.length,r.length),i=0;i<o;i++){var a=i<n.length?n[i]:0,s=i<r.length?r[i]:0;if(a<s)return-1;if(a>s)return 1}return 0},e.NON_NUMERIC_PATTERN=/[^0-9.]/,e}();t.SegmentOperandEvaluator=f},3991:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.CampaignDecisionService=void 0;var i=n(6365),a=n(477),s=n(6947),u=n(2974),c=n(7173),l=n(5076),g=function(){function e(){}return e.prototype.isUserPartOfCampaign=function(e,t,n){if(!t||!e)return!1;var r=t.getType()===s.CampaignTypeEnum.ROLLOUT||t.getType()===s.CampaignTypeEnum.PERSONALIZE,o=r?t.getVariations()[0].getSalt():t.getSalt(),a=r?t.getVariations()[0].getWeight():t.getTraffic(),c=o?"".concat(o,"_").concat(e):"".concat(t.getId(),"_").concat(e),g=(new i.DecisionMaker).getBucketValueForUser(c),p=0!==g&&g<=a;return n.getLogManager().info((0,l.buildMessage)(u.InfoLogMessagesEnum.USER_PART_OF_CAMPAIGN,{userId:e,notPart:p?"":"not",campaignKey:t.getType()===s.CampaignTypeEnum.AB?t.getKey():t.getName()+"_"+t.getRuleKey()})),p},e.prototype.getVariation=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t>=r.getStartRangeVariation()&&t<=r.getEndRangeVariation())return r}return null},e.prototype.checkInRange=function(e,t){if(t>=e.getStartRangeVariation()&&t<=e.getEndRangeVariation())return e},e.prototype.bucketUserToVariation=function(e,t,n,r){var o;if(!n||!e)return null;n.getTraffic()&&(o=1);var s=n.getTraffic(),c=n.getSalt(),g=c?"".concat(c,"_").concat(t,"_").concat(e):"".concat(n.getId(),"_").concat(t,"_").concat(e),p=(new i.DecisionMaker).generateHashValue(g),d=(new i.DecisionMaker).generateBucketValue(p,a.Constants.MAX_TRAFFIC_VALUE,o);return r.getLogManager().debug((0,l.buildMessage)(u.DebugLogMessagesEnum.USER_BUCKET_TO_VARIATION,{userId:e,campaignKey:n.getKey(),percentTraffic:s,bucketValue:d,hashValue:p})),this.getVariation(n.getVariations(),d)},e.prototype.getPreSegmentationDecision=function(e,t,n){return r(this,void 0,void 0,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:return r=e.getType(),i={},r===s.CampaignTypeEnum.ROLLOUT||r===s.CampaignTypeEnum.PERSONALIZE?i=e.getVariations()[0].getSegments():r===s.CampaignTypeEnum.AB&&(i=e.getSegments()),!(0,c.isObject)(i)||Object.keys(i).length?[3,1]:(n.getLogManager().info((0,l.buildMessage)(u.InfoLogMessagesEnum.SEGMENTATION_SKIP,{userId:t.getId(),campaignKey:e.getType()===s.CampaignTypeEnum.AB?e.getKey():e.getName()+"_"+e.getRuleKey()})),[2,!0]);case 1:return[4,n.getSegmentationManager().validateSegmentation(i,t.getCustomVariables())];case 2:return o.sent()?(n.getLogManager().info((0,l.buildMessage)(u.InfoLogMessagesEnum.SEGMENTATION_STATUS,{userId:t.getId(),campaignKey:e.getType()===s.CampaignTypeEnum.AB?e.getKey():e.getName()+"_"+e.getRuleKey(),status:"passed"})),[2,!0]):(n.getLogManager().info((0,l.buildMessage)(u.InfoLogMessagesEnum.SEGMENTATION_STATUS,{userId:t.getId(),campaignKey:e.getType()===s.CampaignTypeEnum.AB?e.getKey():e.getName()+"_"+e.getRuleKey(),status:"failed"})),[2,!1])}}))}))},e.prototype.getVariationAlloted=function(e,t,n,r){var o=this.isUserPartOfCampaign(e,n,r);return n.getType()===s.CampaignTypeEnum.ROLLOUT||n.getType()===s.CampaignTypeEnum.PERSONALIZE?o?n.getVariations()[0]:null:o?this.bucketUserToVariation(e,t,n,r):null},e}();t.CampaignDecisionService=g},4059:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=void 0;var r=n(1946);Object.defineProperty(t,"Storage",{enumerable:!0,get:function(){return r.Storage}})},4334:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomUUID=function(e){var t=(0,i.v5)(e,i.v5.DNS);return(0,i.v5)((0,o.v4)(),t)},t.getUUID=function(e,t){var n=(0,i.v5)(r.SEED_URL,i.v5.URL);e=String(e);var o=a(t=String(t),n),s=a(e,o);return null==s?void 0:s.replace(/-/gi,"").toUpperCase()},t.generateUUID=a;var r=n(3388),o=n(3903),i=n(3903);function a(e,t){if(e&&t)return(0,i.v5)(e,t)}},4464:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseModel=t.RequestModel=t.GlobalRequestModel=t.NetworkManager=void 0;var r=n(119);Object.defineProperty(t,"NetworkManager",{enumerable:!0,get:function(){return r.NetworkManager}});var o=n(7666);Object.defineProperty(t,"GlobalRequestModel",{enumerable:!0,get:function(){return o.GlobalRequestModel}});var i=n(3725);Object.defineProperty(t,"RequestModel",{enumerable:!0,get:function(){return i.RequestModel}});var a=n(3647);Object.defineProperty(t,"ResponseModel",{enumerable:!0,get:function(){return a.ResponseModel}})},4868:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendGetCall=function(e,t){u(r.HttpMethodEnum.GET,e,t)},t.sendPostCall=function(e,t){u(r.HttpMethodEnum.POST,e,t)};var r=n(5212),o=n(7111),i=n(3647),a=n(6089),s=function(){};function u(e,t,n){var u=t.requestModel,c=t.successCallback,l=void 0===c?s:c,g=t.errorCallback,p=void 0===g?s:g,d=u.getOptions(),f=0,h=d.retryConfig.shouldRetry,v=d.retryConfig.maxRetries;!function t(){var s=new i.ResponseModel,c="".concat(d.scheme,"://").concat(d.hostname).concat(d.path);d.port&&(c="".concat(d.scheme,"://").concat(d.hostname,":").concat(d.port).concat(d.path));var g=d.body,E=d.headers||{},y=d.timeout,m=new XMLHttpRequest;function S(e){if(h&&f<v){var r=d.retryConfig.initialDelay*Math.pow(d.retryConfig.backoffMultiplier,f)*1e3;f++,n.errorLog("ATTEMPTING_RETRY_FOR_FAILED_NETWORK_CALL",{endPoint:c.split("?")[0],err:(0,a.getFormattedErrorMessage)(e),delay:r/1e3,attempt:f,maxRetries:v},{},!1),u.setLastError(e),setTimeout(t,r)}else String(d.path).includes(o.EventEnum.VWO_DEBUGGER_EVENT)||n.errorLog("NETWORK_CALL_FAILURE_AFTER_MAX_RETRIES",{extraData:c.split("?")[0],attempts:f,err:(0,a.getFormattedErrorMessage)(e)},{},!1),s.setTotalAttempts(f),s.setError((0,a.getFormattedErrorMessage)(e)),p(s)}for(var _ in y&&(m.timeout=y),m.onload=function(){if(s.setStatusCode(m.status),m.status>=200&&m.status<300){var t=m.responseText;if(f>0&&(s.setTotalAttempts(f),s.setError(u.getLastError())),e===r.HttpMethodEnum.GET){var n=JSON.parse(t);s.setData(n),l(s)}else s.setData(t),l(s)}else 400===m.status?(s.setTotalAttempts(f),s.setError(m.responseText),p(s)):S(m.statusText)},m.onerror=function(){S("".concat(m.statusText,", status: ").concat(m.status))},y&&(m.ontimeout=function(){S("Request timed out")}),m.open(e,c,!0),E)_ in E&&"Content-Type"!==_&&"Content-Length"!==_&&m.setRequestHeader(_,E[_]);e===r.HttpMethodEnum.POST&&"string"!=typeof g?m.send(JSON.stringify(g)):e===r.HttpMethodEnum.GET&&m.send()}()}},5017:e=>{e.exports={version:"1.37.0"}},5076:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildMessage=function(e,t){void 0===e&&(e=""),void 0===t&&(t={});try{return e.replace(o,(function(n,o,i){if("{"===e[i-1]&&"}"===e[i+n.length])return o;var a=t[o];return null==a?"":(0,r.isFunction)(a)?a():a}))}catch(t){return e}};var r=n(7173),o=/\{([0-9a-zA-Z_]+)\}/g},5212:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.HttpMethodEnum=void 0,function(e){e.GET="GET",e.POST="POST"}(n||(t.HttpMethodEnum=n={}))},5224:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;t.Logger=function(){}},5291:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UsageStatsUtil=void 0;var r=n(1202),o=function(){function e(e){this.usageStatsData={},this.setUsageStats(e)}return e.prototype.setUsageStats=function(e){var t,n=e.storage,o=e.logger,i=e.batchEventData,a=e.gatewayService,s=e.integrations,u=e.pollInterval,c=e._vwo_meta,l=e.shouldWaitForTrackingCalls,g={};g.a=e.accountId,g.env=e.sdkKey,s&&(g.ig=1),i&&(g.eb=1),o&&(o.transport||o.transports)&&(g.cl=1),n&&(g.ss=1),(null==o?void 0:o.level)&&(g.ll=null!==(t=r.LogLevelNumberEnum[o.level.toUpperCase()])&&void 0!==t?t:-1),a&&(g.gs=1),u&&(g.pi=u),l&&(g.swtc=1),c&&c.ea&&(g._ea=1),"undefined"!=typeof process&&process.version&&(g.lv=process.version),this.usageStatsData=g},e.prototype.getUsageStats=function(){return this.usageStatsData},e.prototype.clearUsageStats=function(){this.usageStatsData={}},e}();t.UsageStatsUtil=o},5479:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setVariationAllocation=function(e,t){if(e.getType()===o.CampaignTypeEnum.ROLLOUT||e.getType()===o.CampaignTypeEnum.PERSONALIZE)!function(e,t){for(var n=0;n<e.getVariations().length;n++){var r=e.getVariations()[n],o=100*e.getVariations()[n].getWeight();r.setStartRange(1),r.setEndRange(o),t.info((0,s.buildMessage)(i.InfoLogMessagesEnum.VARIATION_RANGE_ALLOCATION,{variationKey:r.getKey(),campaignKey:e.getKey(),variationWeight:r.getWeight(),startRange:1,endRange:o}))}}(e,t);else{var n=0;e.getVariations().forEach((function(r){var o=u(r,n);n+=o,t.info((0,s.buildMessage)(i.InfoLogMessagesEnum.VARIATION_RANGE_ALLOCATION,{variationKey:r.getKey(),campaignKey:e.getKey(),variationWeight:r.getWeight(),startRange:r.getStartRangeVariation(),endRange:r.getEndRangeVariation()}))}))}},t.assignRangeValues=u,t.scaleVariationWeights=function(e){var t=e.reduce((function(e,t){return e+t.weight}),0);if(t)e.forEach((function(e){return e.weight=e.weight/t*100}));else{var n=100/e.length;e.forEach((function(e){return e.weight=n}))}},t.getBucketingSeed=function(e,t,n){if(n)return"".concat(n,"_").concat(e);var r=t.getType()===o.CampaignTypeEnum.ROLLOUT||t.getType()===o.CampaignTypeEnum.PERSONALIZE?t.getVariations()[0].getSalt():t.getSalt();return r?"".concat(r,"_").concat(e):"".concat(t.getId(),"_").concat(e)},t.getVariationFromCampaignKey=function(e,t,n){var r=e.getCampaigns().find((function(e){return e.getKey()===t}));if(r){var o=r.getVariations().find((function(e){return e.getId()===n}));if(o)return(new a.VariationModel).modelFromDictionary(o)}return null},t.getCampaignKeyFromCampaignId=function(e,t){var n=e.getCampaigns().find((function(e){return e.getId()===t}));return n?n.getKey():null},t.getVariationNameFromCampaignIdAndVariationId=function(e,t,n){var r=e.getCampaigns().find((function(e){return e.getId()===t}));if(r){var o=r.getVariations().find((function(e){return e.getId()===n}));if(o)return o.getKey()}return null},t.getCampaignTypeFromCampaignId=function(e,t){var n=e.getCampaigns().find((function(e){return e.getId()===t}));return n?n.getType():null},t.isFeatureIdPresentInSettings=function(e,t){return e.getFeatures().some((function(e){return e.getId()===t}))},t.setCampaignAllocation=function(e){for(var t=0,n=0;t<e.length;t++)n+=c(e[t],n)},t.getGroupDetailsIfCampaignPartOfIt=function(e,t,n){void 0===n&&(n=null);var r=t.toString();return null!==n&&(r="".concat(t,"_").concat(n).toString()),e.getCampaignGroups()&&Object.prototype.hasOwnProperty.call(e.getCampaignGroups(),r)?{groupId:e.getCampaignGroups()[r],groupName:e.getGroups()[e.getCampaignGroups()[r]].name}:{}},t.getCampaignsByGroupId=function(e,t){var n=e.getGroups()[t];return n?n.campaigns:[]},t.getFeatureKeysFromCampaignIds=function(e,t){for(var n=[],r=function(t){var r=t.split("_").map(Number),o=r[0],i=r[1];e.getFeatures().forEach((function(e){-1===n.indexOf(e.getKey())&&e.getRules().forEach((function(t){t.getCampaignId()===o&&(null!=i?t.getVariationId()===i&&n.push(e.getKey()):n.push(e.getKey()))}))}))},o=0,i=t;o<i.length;o++)r(i[o]);return n},t.getCampaignIdsFromFeatureKey=function(e,t){var n=[];return e.getFeatures().forEach((function(e){e.getKey()===t&&e.getRules().forEach((function(e){n.push(e.getCampaignId())}))})),n},t.assignRangeValuesMEG=c;var r=n(477),o=n(6947),i=n(2974),a=n(1463),s=n(5076);function u(e,t){var n=l(e.getWeight());return n?(e.setStartRange(t+1),e.setEndRange(t+n)):(e.setStartRange(-1),e.setEndRange(-1)),n}function c(e,t){var n=l(e.weight);return n?(e.startRangeVariation=t+1,e.endRangeVariation=t+n):(e.startRangeVariation=-1,e.endRangeVariation=-1),n}function l(e){if(!e||0===e)return 0;var t=Math.ceil(100*e);return Math.min(t,r.Constants.MAX_TRAFFIC_VALUE)}},5576:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=function(){var e=this;return this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),this}},5600:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsSchema=void 0;var r=n(6190),o=function(){function e(){this.initializeSchemas()}return e.prototype.initializeSchemas=function(){this.campaignMetricSchema=(0,r.type)({id:(0,r.union)([(0,r.number)(),(0,r.string)()]),type:(0,r.string)(),identifier:(0,r.string)(),mca:(0,r.optional)((0,r.union)([(0,r.number)(),(0,r.string)()])),hasProps:(0,r.optional)((0,r.boolean)()),revenueProp:(0,r.optional)((0,r.string)())}),this.variableObjectSchema=(0,r.type)({id:(0,r.union)([(0,r.number)(),(0,r.string)()]),type:(0,r.string)(),key:(0,r.string)(),value:(0,r.union)([(0,r.number)(),(0,r.string)(),(0,r.boolean)(),(0,r.object)()])}),this.campaignVariationSchema=(0,r.type)({id:(0,r.union)([(0,r.number)(),(0,r.string)()]),name:(0,r.string)(),weight:(0,r.union)([(0,r.number)(),(0,r.string)()]),segments:(0,r.optional)((0,r.object)()),variables:(0,r.optional)((0,r.array)(this.variableObjectSchema)),startRangeVariation:(0,r.optional)((0,r.number)()),endRangeVariation:(0,r.optional)((0,r.number)()),salt:(0,r.optional)((0,r.string)())}),this.campaignObjectSchema=(0,r.type)({id:(0,r.union)([(0,r.number)(),(0,r.string)()]),type:(0,r.string)(),key:(0,r.string)(),percentTraffic:(0,r.optional)((0,r.number)()),status:(0,r.string)(),variations:(0,r.array)(this.campaignVariationSchema),segments:(0,r.object)(),isForcedVariationEnabled:(0,r.optional)((0,r.boolean)()),isAlwaysCheckSegment:(0,r.optional)((0,r.boolean)()),name:(0,r.string)(),salt:(0,r.optional)((0,r.string)())}),this.ruleSchema=(0,r.type)({type:(0,r.string)(),ruleKey:(0,r.string)(),campaignId:(0,r.number)(),variationId:(0,r.optional)((0,r.number)())}),this.featureSchema=(0,r.type)({id:(0,r.union)([(0,r.number)(),(0,r.string)()]),key:(0,r.string)(),status:(0,r.string)(),name:(0,r.string)(),type:(0,r.string)(),metrics:(0,r.array)(this.campaignMetricSchema),impactCampaign:(0,r.optional)((0,r.object)()),rules:(0,r.optional)((0,r.array)(this.ruleSchema)),variables:(0,r.optional)((0,r.array)(this.variableObjectSchema))}),this.settingsSchema=(0,r.type)({sdkKey:(0,r.optional)((0,r.string)()),version:(0,r.union)([(0,r.number)(),(0,r.string)()]),accountId:(0,r.union)([(0,r.number)(),(0,r.string)()]),usageStatsAccountId:(0,r.optional)((0,r.number)()),features:(0,r.optional)((0,r.array)(this.featureSchema)),campaigns:(0,r.array)(this.campaignObjectSchema),groups:(0,r.optional)((0,r.object)()),campaignGroups:(0,r.optional)((0,r.object)()),collectionPrefix:(0,r.optional)((0,r.string)()),sdkMetaInfo:(0,r.optional)((0,r.object)({wasInitializedEarlier:(0,r.optional)((0,r.boolean)())})),pollInterval:(0,r.optional)((0,r.number)())})},e.prototype.isSettingsValid=function(e){return!!e&&!(0,r.validate)(e,this.settingsSchema)[0]},e}();t.SettingsSchema=o},5692:e=>{"use strict";e.exports=require("https")},5810:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SetAttributeApi=void 0;var i=n(7111),a=n(1943),s=function(){function e(){}return e.prototype.setAttribute=function(e,t,n){return r(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return e.getShouldWaitForTrackingCalls()?[4,u(e,t,n)]:[3,2];case 1:return r.sent(),[3,3];case 2:u(e,t,n),r.label=3;case 3:return[2]}}))}))},e}();t.SetAttributeApi=s;var u=function(e,t,n){return r(void 0,void 0,void 0,(function(){var r,s;return o(this,(function(o){switch(o.label){case 0:return r=(0,a.getEventsBaseProperties)(e.getSettingsService(),i.EventEnum.VWO_SYNC_VISITOR_PROP,encodeURIComponent(n.getUserAgent()),n.getIpAddress()),s=(0,a.getAttributePayloadData)(e,i.EventEnum.VWO_SYNC_VISITOR_PROP,t,n),e.getBatchEventsQueue()?(e.getBatchEventsQueue().enqueue(s),[3,3]):[3,1];case 1:return[4,(0,a.sendPostApiRequest)(e,r,s,n.getId())];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))}},5946:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BatchEventsQueue=void 0;var a=n(477),s=n(7173),u=n(5076),c=n(2974),l=i(n(6977)),g=function(){function e(e,t){return void 0===e&&(e={}),this.queue=[],this.timer=null,this.isEdgeEnvironment=!1,this.logManager=t,(0,s.isBoolean)(e.isEdgeEnvironment)&&(this.isEdgeEnvironment=e.isEdgeEnvironment),(0,s.isNumber)(e.requestTimeInterval)&&e.requestTimeInterval>=1?this.requestTimeInterval=e.requestTimeInterval:(this.requestTimeInterval=a.Constants.DEFAULT_REQUEST_TIME_INTERVAL,this.isEdgeEnvironment||this.logManager.info((0,u.buildMessage)(c.InfoLogMessagesEnum.EVENT_BATCH_DEFAULTS,{parameter:"requestTimeInterval",minLimit:0,defaultValue:this.requestTimeInterval.toString()}))),(0,s.isNumber)(e.eventsPerRequest)&&e.eventsPerRequest>0&&e.eventsPerRequest<=a.Constants.MAX_EVENTS_PER_REQUEST?this.eventsPerRequest=e.eventsPerRequest:e.eventsPerRequest>a.Constants.MAX_EVENTS_PER_REQUEST?(this.eventsPerRequest=a.Constants.MAX_EVENTS_PER_REQUEST,this.logManager.info((0,u.buildMessage)(c.InfoLogMessagesEnum.EVENT_BATCH_MAX_LIMIT,{parameter:"eventsPerRequest",maxLimit:a.Constants.MAX_EVENTS_PER_REQUEST.toString()}))):(this.eventsPerRequest=a.Constants.DEFAULT_EVENTS_PER_REQUEST,this.logManager.info((0,u.buildMessage)(c.InfoLogMessagesEnum.EVENT_BATCH_DEFAULTS,{parameter:"eventsPerRequest",minLimit:0,defaultValue:this.eventsPerRequest.toString()}))),this.flushCallback=(0,s.isFunction)(e.flushCallback)?e.flushCallback:function(){},this.accountId=e.accountId,this.isEdgeEnvironment||this.createNewBatchTimer(),this}return e.prototype.injectServiceContainer=function(e){this.serviceContainer=e},e.prototype.enqueue=function(e){this.queue.push(e),this.logManager.info((0,u.buildMessage)(c.InfoLogMessagesEnum.EVENT_QUEUE,{queueType:"batch",event:JSON.stringify(e)})),this.queue.length>=this.eventsPerRequest&&this.flush()},e.prototype.flush=function(e){var t=this;if(void 0===e&&(e=!1),this.queue.length){this.logManager.debug((0,u.buildMessage)(c.DebugLogMessagesEnum.EVENT_BATCH_BEFORE_FLUSHING,{manually:e?"manually":"",length:this.queue.length,accountId:this.accountId,timer:e?"Timer will be cleared and registered again":""}));var n=this.queue;return this.queue=[],l.default.dispatch(this.serviceContainer,{ev:n},this.flushCallback,Object.assign({},{a:this.accountId,env:this.serviceContainer.getSettingsService().sdkKey,sn:a.Constants.SDK_NAME,sv:a.Constants.SDK_VERSION})).then((function(r){var o;return"success"===r.status?(t.logManager.info((0,u.buildMessage)(c.InfoLogMessagesEnum.EVENT_BATCH_After_FLUSHING,{manually:e?"manually":"",length:n.length})),r):((o=t.queue).push.apply(o,n),r)})).catch((function(){var e;return(e=t.queue).push.apply(e,n),{status:"error",events:n}}))}return this.logManager.debug((0,u.buildMessage)(c.DebugLogMessagesEnum.BATCH_QUEUE_EMPTY)),new Promise((function(e){e({status:"success",events:[]})}))},e.prototype.createNewBatchTimer=function(){var e=this;this.timer=setInterval((function(){return r(e,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,this.flush()];case 1:return e.sent(),[2]}}))}))}),1e3*this.requestTimeInterval)},e.prototype.clearRequestTimer=function(){clearTimeout(this.timer),this.timer=null},e.prototype.flushAndClearTimer=function(){return this.flush(!0)},e}();t.BatchEventsQueue=g,t.default=g},6089:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.cloneObject=function(e){return e?JSON.parse(JSON.stringify(e)):e},t.getCurrentTime=function(){return(new Date).toISOString()},t.getCurrentUnixTimestamp=function(){return Math.ceil(+new Date/1e3)},t.getCurrentUnixTimestampInMillis=function(){return+new Date},t.getRandomNumber=function(){return Math.random()},t.getSpecificRulesBasedOnType=function(e,t){return void 0===t&&(t=null),e&&!(null==e?void 0:e.getRulesLinkedCampaign())?[]:e&&e.getRulesLinkedCampaign()&&t&&(0,a.isString)(t)?e.getRulesLinkedCampaign().filter((function(e){return(new i.CampaignModel).modelFromDictionary(e).getType()===t})):e.getRulesLinkedCampaign()},t.getAllExperimentRules=function(e){return(null==e?void 0:e.getRulesLinkedCampaign().filter((function(e){return e.getType()===o.CampaignTypeEnum.AB||e.getType()===o.CampaignTypeEnum.PERSONALIZE})))||[]},t.getFeatureFromKey=function(e,t){var n;return null===(n=null==e?void 0:e.getFeatures())||void 0===n?void 0:n.find((function(e){return e.getKey()===t}))},t.doesEventBelongToAnyFeature=function(e,t){return t.getFeatures().some((function(t){return t.getMetrics().some((function(t){return t.getIdentifier()===e}))}))},t.addLinkedCampaignsToSettings=function(e){for(var t=new Map(e.getCampaigns().map((function(e){return[e.getId(),e]}))),n=0,o=e.getFeatures();n<o.length;n++){var a=o[n],s=a.getRules().map((function(e){var n=t.get(e.getCampaignId());if(!n)return null;var o=r(r({key:n.getKey()},n),{ruleKey:e.getRuleKey()});if(e.getVariationId()){var i=n.getVariations().find((function(t){return t.getId()===e.getVariationId()}));i&&(o.variations=[i])}return o})).filter((function(e){return null!==e})).map((function(e){var t=new i.CampaignModel;return t.modelFromDictionary(e),t}));a.setRulesLinkedCampaign(s)}},t.getFormattedErrorMessage=function(e){var t="";return e instanceof Error?t=e.message:"string"==typeof e?t=e:e&&"object"==typeof e&&(t=JSON.stringify(e)),t};var o=n(6947),i=n(8198),a=n(7173)},6167:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ApiEnum=void 0,function(e){e.INIT="init",e.ON_INIT="onInit",e.GET_FLAG="getFlag",e.TRACK_EVENT="trackEvent",e.SET_ATTRIBUTE="setAttribute",e.FLUSH_EVENTS="flushEvents",e.UPDATE_SETTINGS="updateSettings",e.SET_ALIAS="setAlias"}(n||(t.ApiEnum=n={}))},6178:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevelEnum=t.LogManager=void 0;var r=n(7623);Object.defineProperty(t,"LogManager",{enumerable:!0,get:function(){return r.LogManager}});var o=n(8858);Object.defineProperty(t,"LogLevelEnum",{enumerable:!0,get:function(){return o.LogLevelEnum}})},6190:e=>{"use strict";e.exports=require("superstruct")},6254:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateGroups=void 0,t.getFeatureKeysFromGroup=m;var i=n(477),a=n(834),s=n(6947),u=n(2974),c=n(8198),l=n(1463),g=n(6365),p=n(3991),d=n(689),f=n(5479),h=n(7173),v=n(9455),E=n(6089),y=n(5076);function m(e,t){var n=(0,f.getCampaignsByGroupId)(e,t);return{featureKeys:(0,f.getFeatureKeysFromCampaignIds)(e,n),groupCampaignIds:n}}t.evaluateGroups=function(e,t,n,i,a,s){return r(void 0,void 0,void 0,(function(){var r,u,c,l,g,p,d,f,h,v,y,T;return o(this,(function(b){switch(b.label){case 0:r=[],u=new Map,c=m(e.getSettings(),n),l=c.featureKeys,g=c.groupCampaignIds,p=function(t){var n;return o(this,(function(o){switch(o.label){case 0:return n=(0,E.getFeatureFromKey)(e.getSettings(),t),r.includes(t)?[2,"continue"]:[4,S(e,n,i,r,s,a)];case 1:return o.sent()&&e.getSettings().getFeatures().forEach((function(e){e.getKey()===t&&e.getRulesLinkedCampaign().forEach((function(e){(g.includes(e.getId().toString())||g.includes("".concat(e.getId(),"_").concat(e.getVariations()[0].getId()).toString()))&&(u.has(t)||u.set(t,[]),-1===u.get(t).findIndex((function(t){return t.ruleKey===e.getRuleKey()}))&&u.get(t).push(e))}))})),[2]}}))},d=0,f=l,b.label=1;case 1:return d<f.length?(h=f[d],[5,p(h)]):[3,4];case 2:b.sent(),b.label=3;case 3:return d++,[3,1];case 4:return[4,_(e,u,a,s)];case 5:return v=b.sent(),y=v.eligibleCampaigns,T=v.eligibleCampaignsWithStorage,[4,I(e,t.getKey(),y,T,n,a,s)];case 6:return[2,b.sent()]}}))}))};var S=function(e,t,n,i,a,l){return r(void 0,void 0,void 0,(function(){var r,g,p,f,m,S,_;return o(this,(function(o){switch(o.label){case 0:if(n.has(t.getKey())&&"rolloutId"in n.get(t.getKey()))return[2,!0];if(!((r=(0,E.getSpecificRulesBasedOnType)(t,s.CampaignTypeEnum.ROLLOUT)).length>0))return[3,5];g=null,p=0,f=r,o.label=1;case 1:return p<f.length?(m=f[p],[4,(0,d.evaluateRule)(e,t,m,l,n,null,a,{})]):[3,4];case 2:return o.sent().preSegmentationResult?(g=m,[3,4]):[3,3];case 3:return p++,[3,1];case 4:return null!==g&&(S=(new c.CampaignModel).modelFromDictionary(g),_=(0,v.evaluateTrafficAndGetVariation)(e,S,l.getId()),(0,h.isObject)(_)&&Object.keys(_).length>0)?(n.set(t.getKey(),{rolloutId:g.id,rolloutKey:g.key,rolloutVariationId:g.variations[0].id}),[2,!0]):(i.push(t.getKey()),[2,!1]);case 5:return e.getLogManager().info((0,y.buildMessage)(u.InfoLogMessagesEnum.MEG_SKIP_ROLLOUT_EVALUATE_EXPERIMENTS,{featureKey:t.getKey()})),[2,!0]}}))}))},_=function(e,t,n,i){return r(void 0,void 0,void 0,(function(){var r,l,g,d,h,v,E,m,S,_,I,T,b;return o(this,(function(O){switch(O.label){case 0:r=[],l=[],g=[],d=Array.from(t),h=0,v=d,O.label=1;case 1:if(!(h<v.length))return[3,6];E=v[h],m=E[0],S=E[1],_=function(t){var d;return o(this,(function(o){switch(o.label){case 0:return[4,(new a.StorageDecorator).getFeatureFromStorage(m,n,i,e)];case 1:return(null==(d=o.sent())?void 0:d.experimentVariationId)&&d.experimentKey&&d.experimentKey===t.getKey()&&(0,f.getVariationFromCampaignKey)(e.getSettings(),d.experimentKey,d.experimentVariationId)?(e.getLogManager().info((0,y.buildMessage)(u.InfoLogMessagesEnum.MEG_CAMPAIGN_FOUND_IN_STORAGE,{campaignKey:d.experimentKey,userId:n.getId()})),-1===l.findIndex((function(e){return e.key===t.getKey()}))&&l.push(t),[2,"continue"]):[4,(new p.CampaignDecisionService).getPreSegmentationDecision((new c.CampaignModel).modelFromDictionary(t),n,e)];case 2:return o.sent()&&(new p.CampaignDecisionService).isUserPartOfCampaign(n.getId(),t,e)?(e.getLogManager().info((0,y.buildMessage)(u.InfoLogMessagesEnum.MEG_CAMPAIGN_ELIGIBLE,{campaignKey:t.getType()===s.CampaignTypeEnum.AB?t.getKey():t.getName()+"_"+t.getRuleKey(),userId:n.getId()})),r.push(t),[2,"continue"]):(g.push(t),[2])}}))},I=0,T=S,O.label=2;case 2:return I<T.length?(b=T[I],[5,_(b)]):[3,5];case 3:O.sent(),O.label=4;case 4:return I++,[3,2];case 5:return h++,[3,1];case 6:return[2,Promise.resolve({eligibleCampaigns:r,eligibleCampaignsWithStorage:l,inEligibleCampaigns:g})]}}))}))},I=function(e,t,n,a,c,l,g){return r(void 0,void 0,void 0,(function(){var r,p,d,v,E;return o(this,(function(o){return r=null,p=(0,f.getCampaignIdsFromFeatureKey)(e.getSettings(),t),d=(0,h.isUndefined)(null===(E=null===(v=e.getSettings())||void 0===v?void 0:v.getGroups()[c])||void 0===E?void 0:E.et)?i.Constants.RANDOM_ALGO:e.getSettings().getGroups()[c].et,1===a.length?(r=a[0],e.getLogManager().info((0,y.buildMessage)(u.InfoLogMessagesEnum.MEG_WINNER_CAMPAIGN,{campaignKey:a[0].getType()===s.CampaignTypeEnum.AB?a[0].getKey():a[0].getName()+"_"+a[0].getRuleKey(),groupId:c,userId:l.getId(),algo:""}))):a.length>1&&d===i.Constants.RANDOM_ALGO?r=T(e,a,l,p,c,g):a.length>1&&(r=b(e,a,l,p,c,g)),0===a.length&&(1===n.length?(r=n[0],e.getLogManager().info((0,y.buildMessage)(u.InfoLogMessagesEnum.MEG_WINNER_CAMPAIGN,{campaignKey:n[0].getType()===s.CampaignTypeEnum.AB?n[0].getKey():n[0].getName()+"_"+n[0].getRuleKey(),groupId:c,userId:l.getId(),algo:""}))):n.length>1&&d===i.Constants.RANDOM_ALGO?r=T(e,n,l,p,c,g):n.length>1&&(r=b(e,n,l,p,c,g))),[2,r]}))}))},T=function(e,t,n,r,o,c){t.forEach((function(e){e.weight=Math.round(100/t.length*1e4)/1e4})),t=t.map((function(e){return(new l.VariationModel).modelFromDictionary(e)})),(0,f.setCampaignAllocation)(t);var d=(new p.CampaignDecisionService).getVariation(t,(new g.DecisionMaker).calculateBucketValue((0,f.getBucketingSeed)(n.getId(),void 0,o)));return e.getLogManager().info((0,y.buildMessage)(u.InfoLogMessagesEnum.MEG_WINNER_CAMPAIGN,{campaignKey:d.getType()===s.CampaignTypeEnum.AB?d.getKey():d.getKey()+"_"+d.getRuleKey(),groupId:o,userId:n.getId(),algo:"using random algorithm"})),d&&((new a.StorageDecorator).setDataInStorage({featureKey:"".concat(i.Constants.VWO_META_MEG_KEY).concat(o),context:n,experimentId:d.getId(),experimentKey:d.getKey(),experimentVariationId:d.getType()===s.CampaignTypeEnum.PERSONALIZE?d.getVariations()[0].getId():-1},c,e),r.includes(d.getId()))?d:null},b=function(e,t,n,r,o,c){for(var d=null,v=!1,m=(0,h.isUndefined)(e.getSettings().getGroups()[o].p)?{}:e.getSettings().getGroups()[o].p,S=(0,h.isUndefined)(e.getSettings().getGroups()[o].wt)?{}:e.getSettings().getGroups()[o].wt,_=0;_<m.length;_++){for(var I=0;I<t.length;I++){if(t[I].id==m[_]){d=(0,E.cloneObject)(t[I]),v=!0;break}if(t[I].id+"_"+t[I].variations[0].id===m[_]){d=(0,E.cloneObject)(t[I]),v=!0;break}}if(!0===v)break}if(null===d){var T=[];for(_=0;_<t.length;_++){var b=t[_].id;if((0,h.isUndefined)(S[b])){if(!(0,h.isUndefined)(S[b+"_"+t[_].variations[0].id])){var O;(O=(0,E.cloneObject)(t[_])).weight=S[b+"_"+t[_].variations[0].id],T.push(O)}}else(O=(0,E.cloneObject)(t[_])).weight=S[b],T.push(O)}T=T.map((function(e){return(new l.VariationModel).modelFromDictionary(e)})),(0,f.setCampaignAllocation)(T),d=(new p.CampaignDecisionService).getVariation(T,(new g.DecisionMaker).calculateBucketValue((0,f.getBucketingSeed)(n.getId(),void 0,o)))}return d?e.getLogManager().info((0,y.buildMessage)(u.InfoLogMessagesEnum.MEG_WINNER_CAMPAIGN,{campaignKey:d.type===s.CampaignTypeEnum.AB?d.key:d.key+"_"+d.ruleKey,groupId:o,userId:n.getId(),algo:"using advanced algorithm"})):e.getLogManager().info("No winner campaign found for MEG group: ".concat(o)),d&&((new a.StorageDecorator).setDataInStorage({featureKey:"".concat(i.Constants.VWO_META_MEG_KEY).concat(o),context:n,experimentId:d.id,experimentKey:d.key,experimentVariationId:d.type===s.CampaignTypeEnum.PERSONALIZE?d.variations[0].id:-1},c,e),r.includes(d.id))?d:null}},6365:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DecisionMaker=void 0;var o=r(n(9708)).default;o.v3||(o.v3=o);var i=function(){function e(){}return e.prototype.generateBucketValue=function(e,t,n){void 0===n&&(n=1);var r=(t*(e/Math.pow(2,32))+1)*n;return Math.floor(r)},e.prototype.getBucketValueForUser=function(e,t){void 0===t&&(t=100);var n=o.v3(e,1);return this.generateBucketValue(n,t)},e.prototype.calculateBucketValue=function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=1e4);var r=this.generateHashValue(e);return this.generateBucketValue(r,n,t)},e.prototype.generateHashValue=function(e){return o.v3(e,1)},e}();t.DecisionMaker=i},6787:function(e,t,n){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&o(t,e,n[a]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkClient=void 0;var s=a(n(8611)),u=a(n(5692)),c=n(5576),l=n(3388),g=n(3647),p=n(7111),d=n(6089),f=function(){function e(e){this.logManager=e}return e.prototype.GET=function(e){var t=this,n=function(r){var o=new c.Deferred,i=e.getOptions(),a=new g.ResponseModel;try{var p=(i.scheme===l.HTTPS?u:s).get(i,(function(s){a.setStatusCode(s.statusCode);var u,c=s.headers["content-type"],l="";if(/^application\/json/.test(c)||(u="Invalid content-type.\nExpected application/json but received ".concat(c,". Status Code: ").concat(null==s?void 0:s.statusCode)),u)return s.resume(),t.retryOrReject(u,r,o,i,n,e,a);s.setEncoding("utf8"),s.on("data",(function(e){l+=e})),s.on("end",(function(){try{var s=JSON.parse(l);if(a.getStatusCode()<200||a.getStatusCode()>=300){var u="".concat(l,", Status Code: ").concat(a.getStatusCode());return 400===a.getStatusCode()?(a.setError(u),a.setTotalAttempts(r),void o.reject(a)):t.retryOrReject(u,r,o,i,n,e,a)}r>0&&(a.setTotalAttempts(r),a.setError(e.getLastError())),a.setData(s),o.resolve(a)}catch(s){return t.retryOrReject(s,r,o,i,n,e,a)}}))}));p.on("timeout",(function(){return t.retryOrReject(new Error("timeout"),r,o,i,n,e,a)})),p.on("error",(function(s){return t.retryOrReject(s,r,o,i,n,e,a)}))}catch(s){t.retryOrReject(s,r,o,i,n,e,a)}return o.promise};return n(0)},e.prototype.POST=function(e){var t=this,n=function(r){var o=new c.Deferred,i=e.getOptions(),a=new g.ResponseModel;try{var p=(i.scheme===l.HTTPS?u:s).request(i,(function(s){var u="";s.setEncoding("utf8"),s.on("data",(function(e){u+=e})),s.on("end",(function(){try{if(200!==s.statusCode){var c="Raw Data: ".concat(u,", Status Code: ").concat(s.statusCode);return a.setStatusCode(s.statusCode),400===s.statusCode?(a.setError(c),a.setTotalAttempts(r),void o.reject(a)):t.retryOrReject(c,r,o,i,n,e,a)}a.setStatusCode(s.statusCode),a.setData(e.getBody()),a.setTotalAttempts(r),a.setError(e.getLastError()),o.resolve(a)}catch(s){return t.retryOrReject(s,r,o,i,n,e,a)}}))}));p.on("timeout",(function(){var s="Timeout: ".concat(i.timeout);return t.retryOrReject(s,r,o,i,n,e,a)})),p.on("error",(function(s){return t.retryOrReject(s,r,o,i,n,e,a)})),p.write(JSON.stringify(i.body)),p.end()}catch(s){t.retryOrReject(s,r,o,i,n,e,a)}return o.promise};return n(0)},e.prototype.retryOrReject=function(e,t,n,r,o,i,a){var s=i.getRetryConfig(),u=i.getExtraInfo(),c=String(r.path).split("?")[0],l=s.initialDelay*Math.pow(s.backoffMultiplier,t)*1e3;s.shouldRetry&&t<s.maxRetries?(this.logManager.errorLog("ATTEMPTING_RETRY_FOR_FAILED_NETWORK_CALL",{endPoint:c,err:(0,d.getFormattedErrorMessage)(e),delay:l/1e3,attempt:t+1,maxRetries:s.maxRetries},u,!1),i.setLastError(e),setTimeout((function(){o(t+1).then(n.resolve).catch(n.reject)}),l)):(String(r.path).includes(p.EventEnum.VWO_DEBUGGER_EVENT)||this.logManager.errorLog("NETWORK_CALL_FAILURE_AFTER_MAX_RETRIES",{extraData:c,attempts:t,err:(0,d.getFormattedErrorMessage)(e)},u,!1),a.setTotalAttempts(t),a.setError(e),n.reject(a))},e}();t.NetworkClient=f},6826:e=>{"use strict";e.exports=require("vwo-fme-sdk-log-messages")},6887:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getUserId=function(e,t,n){return r(this,void 0,void 0,(function(){var r,u;return o(this,(function(o){switch(o.label){case 0:return t?n.getSettingsService().isGatewayServiceProvided?[4,i.AliasingUtil.getAlias(e,n)]:[3,2]:[3,4];case 1:return r=o.sent(),u=r.find((function(t){return t.aliasId===e})),n.getLogManager().info((0,s.buildMessage)(a.InfoLogMessagesEnum.ALIAS_ENABLED,{userId:null==u?void 0:u.userId})),[2,(null==u?void 0:u.userId)||e];case 2:return n.getLogManager().error((0,s.buildMessage)(a.ErrorLogMessagesEnum.INVALID_GATEWAY_URL)),[2,e];case 3:return[3,5];case 4:return[2,e];case 5:return[2]}}))}))};var i=n(1013),a=n(2974),s=n(5076)},6947:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CampaignTypeEnum=void 0,function(e){e.ROLLOUT="FLAG_ROLLOUT",e.AB="FLAG_TESTING",e.PERSONALIZE="FLAG_PERSONALIZE"}(n||(t.CampaignTypeEnum=n={}))},6977:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.BatchEventsDispatcher=void 0;var i=n(4464),a=n(5212),s=n(2478),u=n(5076),c=n(2974),l=n(7173),g=n(5576),p=n(6089),d=n(477),f=n(7543),h=n(1943),v=n(7111),E=function(){function e(){}return e.dispatch=function(e,t,n,i){return r(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,this.sendPostApiRequest(e,i,t,n)];case 1:return[2,r.sent()]}}))}))},e.sendPostApiRequest=function(e,t,n,u){return r(this,void 0,void 0,(function(){var r,c,l,v,E,y,m,S,_,I=this;return o(this,(function(o){r=new g.Deferred,c=e.getNetworkManager().getRetryConfig(),(l={}).Authorization=e.getSettingsService().sdkKey,v=new i.RequestModel(e.getSettingsService().hostname,a.HttpMethodEnum.POST,e.getUpdatedEndpointWithCollectionPrefix(s.UrlEnum.BATCH_EVENTS),t,n,l,e.getSettingsService().protocol,e.getSettingsService().port,c),E=this.extractEventCounts(n),y=E.variationShownCount,m=E.setAttributeCount,S=E.customEventCount,_="".concat(d.Constants.BATCH_EVENTS," having "),y>0&&(_+="getFlag events: ".concat(y,", ")),S>0&&(_+="conversion events: ".concat(S,", ")),m>0&&(_+="setAttribute events: ".concat(m,", "));try{return e.getNetworkManager().post(v).then((function(o){if(o.getTotalAttempts()>0){var i=(0,h.createNetWorkAndRetryDebugEvent)(o,"",d.Constants.BATCH_EVENTS,_);(0,f.sendDebugEventToVWO)(e,i)}var a=I.handleBatchResponse(e.getLogManager(),s.UrlEnum.BATCH_EVENTS,n,t,null,o,u);r.resolve(a)})).catch((function(o){var i=(0,h.createNetWorkAndRetryDebugEvent)(o,"",d.Constants.BATCH_EVENTS,_);(0,f.sendDebugEventToVWO)(e,i);var a=I.handleBatchResponse(e.getLogManager(),s.UrlEnum.BATCH_EVENTS,n,t,null,o,u);r.resolve(a)})),[2,r.promise]}catch(t){return e.getLogManager().errorLog("EXECUTION_FAILED",{apiName:d.Constants.BATCH_EVENTS,err:(0,p.getFormattedErrorMessage)(t)},{an:d.Constants.BATCH_EVENTS}),r.resolve({status:"error",events:n}),[2,r.promise]}return[2]}))}))},e.handleBatchResponse=function(e,t,n,r,o,i,s){var g=n.ev.length,p=r.a,d=o||(null==i?void 0:i.getError());if(!d||d instanceof Error||((0,l.isString)(d)?d=new Error(d):d instanceof Object&&(d=new Error(JSON.stringify(d)))),d)return e.info((0,u.buildMessage)(c.InfoLogMessagesEnum.IMPRESSION_BATCH_FAILED)),e.errorLog("NETWORK_CALL_FAILED",{method:a.HttpMethodEnum.POST,err:d.message},{},!1),s(d,n),{status:"error",events:n};var f=null==i?void 0:i.getStatusCode();return 200===f?(e.info((0,u.buildMessage)(c.InfoLogMessagesEnum.IMPRESSION_BATCH_SUCCESS,{accountId:p,endPoint:t})),s(null,n),{status:"success",events:n}):413===f?(e.errorLog("CONFIG_BATCH_EVENT_LIMIT_EXCEEDED",{accountId:p,endPoint:t,eventsPerRequest:g},{},!1),e.errorLog("NETWORK_CALL_FAILED",{method:a.HttpMethodEnum.POST,err:d.message},{},!1),s(d,n),{status:"error",events:n}):(e.errorLog("IMPRESSION_BATCH_FAILED",{},{},!1),e.errorLog("NETWORK_CALL_FAILED",{method:a.HttpMethodEnum.POST,err:d.message},{},!1),s(d,n),{status:"error",events:n})},e.extractEventCounts=function(e){for(var t,n,r,o={variationShownCount:0,setAttributeCount:0,customEventCount:0},i=new Set(Object.values(v.EventEnum)),a=0,s=null!==(t=null==e?void 0:e.ev)&&void 0!==t?t:[];a<s.length;a++){var u=s[a],c=null===(r=null===(n=null==u?void 0:u.d)||void 0===n?void 0:n.event)||void 0===r?void 0:r.name;c&&(c!==v.EventEnum.VWO_VARIATION_SHOWN?c!==v.EventEnum.VWO_SYNC_VISITOR_PROP?i.has(c)||(o.customEventCount+=1):o.setAttributeCount+=1:o.variationShownCount+=1)}return o},e}();t.BatchEventsDispatcher=E,t.default=E},7005:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkBrowserClient=void 0;var r=n(4868),o=n(5576),i=function(){function e(e){this.logManager=e}return e.prototype.GET=function(e){var t=new o.Deferred;return(0,r.sendGetCall)({requestModel:e,successCallback:function(e){t.resolve(e)},errorCallback:function(e){t.reject(e)}},this.logManager),t.promise},e.prototype.POST=function(e){var t=new o.Deferred;return(0,r.sendPostCall)({requestModel:e,successCallback:function(e){t.resolve(e)},errorCallback:function(e){t.reject(e)}},this.logManager),t.promise},e}();t.NetworkBrowserClient=i},7111:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.EventEnum=void 0,function(e){e.VWO_VARIATION_SHOWN="vwo_variationShown",e.VWO_SYNC_VISITOR_PROP="vwo_syncVisitorProp",e.VWO_LOG_EVENT="vwo_log",e.VWO_INIT_CALLED="vwo_fmeSdkInit",e.VWO_USAGE_STATS="vwo_sdkUsageStats",e.VWO_DEBUGGER_EVENT="vwo_sdkDebug"}(n||(t.EventEnum=n={}))},7131:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getKeyValue=function(e){if((0,r.isObject)(e)){var t=Object.keys(e)[0];return{key:t,value:e[t]}}},t.matchWithRegex=function(e,t){try{return e.match(new RegExp(t))}catch(e){return null}};var r=n(7173)},7173:(e,t)=>{"use strict";function n(e){return"[object Object]"===Object.prototype.toString.call(e)}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}function o(e){return"[object Null]"===Object.prototype.toString.call(e)}function i(e){return"[object Undefined]"===Object.prototype.toString.call(e)}function a(e){return"[object Number]"===Object.prototype.toString.call(e)}function s(e){return"[object String]"===Object.prototype.toString.call(e)}function u(e){return"[object Boolean]"===Object.prototype.toString.call(e)}function c(e){return"[object Function]"===Object.prototype.toString.call(e)}function l(e){return"[object Promise]"===Object.prototype.toString.call(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isObject=n,t.isEmptyObject=function(e){return n(e)&&0===Object.keys(e).length},t.isArray=r,t.isNull=o,t.isUndefined=i,t.isNumber=a,t.isString=s,t.isBoolean=u,t.isFunction=c,t.isPromise=l,t.getType=function(e){return n(e)?"Object":r(e)?"Array":o(e)?"Null":i(e)?"Undefined":a(e)?"Number":s(e)?"String":u(e)?"Boolean":c(e)?"Function":l(e)?"Promise":"Unknown Type"}},7294:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DebuggerCategoryEnum=void 0,function(e){e.NETWORK="network",e.DECISION="decision",e.INITIALIZATION="initialization",e.RETRY="retry",e.ERROR="error"}(n||(t.DebuggerCategoryEnum=n={}))},7385:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentEvaluator=void 0;var i=n(834),a=n(1566),s=n(7173),u=n(2106),c=n(7131),l=n(6167),g=n(6089),p=function(){function e(){}return e.prototype.isSegmentationValid=function(e,t){return r(this,void 0,void 0,(function(){var n,r,i,a;return o(this,(function(o){switch(o.label){case 0:switch(n=(0,c.getKeyValue)(e),r=n.key,i=n.value,a=i,r){case u.SegmentOperatorValueEnum.NOT:return[3,1];case u.SegmentOperatorValueEnum.AND:return[3,3];case u.SegmentOperatorValueEnum.OR:return[3,5];case u.SegmentOperatorValueEnum.CUSTOM_VARIABLE:return[3,7];case u.SegmentOperatorValueEnum.USER:return[3,9];case u.SegmentOperatorValueEnum.UA:return[3,10];case u.SegmentOperatorValueEnum.IP:return[3,11];case u.SegmentOperatorValueEnum.BROWSER_VERSION:return[3,12];case u.SegmentOperatorValueEnum.OS_VERSION:return[3,13]}return[3,14];case 1:return[4,this.isSegmentationValid(a,t)];case 2:return[2,!o.sent()];case 3:return[4,this.every(a,t)];case 4:case 6:case 8:return[2,o.sent()];case 5:return[4,this.some(a,t)];case 7:return[4,this.segmentOperandEvaluator.evaluateCustomVariableDSL(a,t,this.context)];case 9:return[2,this.segmentOperandEvaluator.evaluateUserDSL(a,t)];case 10:return[2,this.segmentOperandEvaluator.evaluateUserAgentDSL(a,this.context)];case 11:return[2,this.segmentOperandEvaluator.evaluateStringOperandDSL(a,this.context,u.SegmentOperatorValueEnum.IP)];case 12:return[2,this.segmentOperandEvaluator.evaluateStringOperandDSL(a,this.context,u.SegmentOperatorValueEnum.BROWSER_VERSION)];case 13:return[2,this.segmentOperandEvaluator.evaluateStringOperandDSL(a,this.context,u.SegmentOperatorValueEnum.OS_VERSION)];case 14:return[2,!1]}}))}))},e.prototype.some=function(e,t){return r(this,void 0,void 0,(function(){var n,r,i,a,s,c,p,d,f,h,v,E,y,m;return o(this,(function(S){switch(S.label){case 0:n={},r=0,i=!1,a=0,s=e,S.label=1;case 1:if(!(a<s.length))return[3,12];for(v in c=s[a],p=function(e){var t,a,s,g,p,f,h,v;return o(this,(function(o){switch(o.label){case 0:return e!==u.SegmentOperatorValueEnum.OPERATING_SYSTEM&&e!==u.SegmentOperatorValueEnum.BROWSER_AGENT&&e!==u.SegmentOperatorValueEnum.DEVICE_TYPE&&e!==u.SegmentOperatorValueEnum.DEVICE||(i=!0,t=c[e],n[e]||(n[e]=[]),(Array.isArray(t)?t:[t]).forEach((function(t){"string"==typeof t&&n[e].push(t)})),r++),e!==u.SegmentOperatorValueEnum.FEATURE_ID?[3,3]:(a=c[e],s=Object.keys(a)[0],"on"!==(g=a[s])&&"off"!==g?[3,3]:(p=d.serviceContainer.getSettings().getFeatures(),(f=p.find((function(e){return e.getId()===parseInt(s)})))?(h=f.getKey(),[4,d.checkInUserStorage(d.serviceContainer.getSettings(),h,d.context)]):[3,2]));case 1:return v=o.sent(),"off"===g?[2,{value:!v}]:[2,{value:v}];case 2:return d.serviceContainer.getLogManager().errorLog("FEATURE_NOT_FOUND_WITH_ID",{featureId:s},{an:l.ApiEnum.GET_FLAG,uuid:d.context.getUuid(),sId:d.context.getSessionId()}),[2,{value:null}];case 3:return[2]}}))},d=this,h=[],f=c)h.push(v);E=0,S.label=2;case 2:return E<h.length?(v=h[E])in f?[5,p(v)]:[3,4]:[3,5];case 3:if("object"==typeof(y=S.sent()))return[2,y.value];S.label=4;case 4:return E++,[3,2];case 5:if(!i||r!==e.length)return[3,9];S.label=6;case 6:return S.trys.push([6,8,,9]),[4,this.checkUserAgentParser(n)];case 7:return[2,S.sent()];case 8:return m=S.sent(),this.serviceContainer.getLogManager().errorLog("USER_AGENT_VALIDATION_ERROR",{err:(0,g.getFormattedErrorMessage)(m)},{an:l.ApiEnum.GET_FLAG,uuid:this.context.getUuid(),sId:this.context.getSessionId()}),[3,9];case 9:return[4,this.isSegmentationValid(c,t)];case 10:if(S.sent())return[2,!0];S.label=11;case 11:return a++,[3,1];case 12:return[2,!1]}}))}))},e.prototype.every=function(e,t){return r(this,void 0,void 0,(function(){var n,r,i,a;return o(this,(function(o){switch(o.label){case 0:n={},r=0,i=e,o.label=1;case 1:return r<i.length?(a=i[r],u.SegmentOperatorValueEnum.COUNTRY in a||u.SegmentOperatorValueEnum.REGION in a||u.SegmentOperatorValueEnum.CITY in a?(this.addLocationValuesToMap(a,n),Object.keys(n).length!==e.length?[3,3]:[4,this.checkLocationPreSegmentation(n)]):[3,4]):[3,7];case 2:return[2,o.sent()];case 3:return[3,6];case 4:return[4,this.isSegmentationValid(a,t)];case 5:if(!o.sent())return[2,!1];o.label=6;case 6:return r++,[3,1];case 7:return[2,!0]}}))}))},e.prototype.addLocationValuesToMap=function(e,t){u.SegmentOperatorValueEnum.COUNTRY in e&&(t[u.SegmentOperatorValueEnum.COUNTRY]=e[u.SegmentOperatorValueEnum.COUNTRY]),u.SegmentOperatorValueEnum.REGION in e&&(t[u.SegmentOperatorValueEnum.REGION]=e[u.SegmentOperatorValueEnum.REGION]),u.SegmentOperatorValueEnum.CITY in e&&(t[u.SegmentOperatorValueEnum.CITY]=e[u.SegmentOperatorValueEnum.CITY])},e.prototype.checkLocationPreSegmentation=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i,a,s,u,c,g;return o(this,(function(o){return void 0===(null===(t=this.context)||void 0===t?void 0:t.getIpAddress())&&"undefined"!=typeof process?(this.serviceContainer.getLogManager().errorLog("INVALID_IP_ADDRESS_IN_CONTEXT_FOR_PRE_SEGMENTATION",{},{an:l.ApiEnum.GET_FLAG,uuid:this.context.getUuid(),sId:this.context.getSessionId()}),[2,!1]):(null===(r=null===(n=this.context)||void 0===n?void 0:n.getVwo())||void 0===r?void 0:r.getLocation())&&void 0!==(null===(a=null===(i=this.context)||void 0===i?void 0:i.getVwo())||void 0===a?void 0:a.getLocation())&&null!==(null===(u=null===(s=this.context)||void 0===s?void 0:s.getVwo())||void 0===u?void 0:u.getLocation())?[2,this.valuesMatch(e,null===(g=null===(c=this.context)||void 0===c?void 0:c.getVwo())||void 0===g?void 0:g.getLocation())]:[2,!1]}))}))},e.prototype.checkUserAgentParser=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i,a,s,u,c;return o(this,(function(o){return(null===(t=this.context)||void 0===t?void 0:t.getUserAgent())&&void 0!==(null===(n=this.context)||void 0===n?void 0:n.getUserAgent())?(null===(i=null===(r=this.context)||void 0===r?void 0:r.getVwo())||void 0===i?void 0:i.getUaInfo())&&void 0!==(null===(s=null===(a=this.context)||void 0===a?void 0:a.getVwo())||void 0===s?void 0:s.getUaInfo())?[2,this.checkValuePresent(e,null===(c=null===(u=this.context)||void 0===u?void 0:u.getVwo())||void 0===c?void 0:c.getUaInfo())]:[2,!1]:(this.serviceContainer.getLogManager().errorLog("INVALID_USER_AGENT_IN_CONTEXT_FOR_PRE_SEGMENTATION",{},{an:l.ApiEnum.GET_FLAG,uuid:this.context.getUuid(),sId:this.context.getSessionId()}),[2,!1])}))}))},e.prototype.checkInUserStorage=function(e,t,n){return r(this,void 0,void 0,(function(){var e,r;return o(this,(function(o){switch(o.label){case 0:return e=new a.StorageService(this.serviceContainer),[4,(new i.StorageDecorator).getFeatureFromStorage(t,n,e,this.serviceContainer)];case 1:return r=o.sent(),(0,s.isObject)(r)&&Object.keys(r).length>0?[2,!0]:[2,!1]}}))}))},e.prototype.checkValuePresent=function(e,t){return r(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){for(r in n=function(n){if(Object.prototype.hasOwnProperty.call(e,n)){var r=e[n];r.forEach((function(e,t){r[t]=e.toLowerCase()}));for(var o=t[n],i=0,a=r;i<a.length;i++){var s=a[i];if(s.startsWith("wildcard(")&&s.endsWith(")")){var u=s.slice(9,-1);if(new RegExp(u.replace(/\*/g,".*"),"i").test(o))return{value:!0}}}if(r.includes(null==o?void 0:o.toLowerCase()))return{value:!0}}},t)if("object"==typeof(i=n(r)))return[2,i.value];return[2,!1]}))}))},e.prototype.valuesMatch=function(e,t){return r(this,void 0,void 0,(function(){var n,r,i,a,s,u,c;return o(this,(function(o){for(n=0,r=Object.entries(e);n<r.length;n++){if(i=r[n],a=i[0],s=i[1],!(a in t))return[2,!1];if(u=this.normalizeValue(s),c=this.normalizeValue(t[a]),u!==c)return[2,!1]}return[2,!0]}))}))},e.prototype.normalizeValue=function(e){return null==e?null:e.toString().replace(/^"|"$/g,"").trim()},e}();t.SegmentEvaluator=p},7543:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.extractDecisionKeys=function(e){void 0===e&&(e={});var t={};return e.rolloutId&&(t.rId=e.rolloutId),e.rolloutVariationId&&(t.rvId=e.rolloutVariationId),e.experimentId&&(t.eId=e.experimentId),e.experimentVariationId&&(t.evId=e.experimentVariationId),t},t.sendDebugEventToVWO=function(e){return r(this,arguments,void 0,(function(e,t){var n,r;return void 0===t&&(t={}),o(this,(function(o){switch(o.label){case 0:return n=(0,i.getEventsBaseProperties)(e.getSettingsService(),a.EventEnum.VWO_DEBUGGER_EVENT,null,null),r=(0,i.getDebuggerEventPayload)(e.getSettingsService(),t),e.getBatchEventsQueue()?(e.getBatchEventsQueue().enqueue(r),[3,3]):[3,1];case 1:return[4,(0,i.sendEvent)(e,n,r,a.EventEnum.VWO_DEBUGGER_EVENT).catch((function(){}))];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))};var i=n(1943),a=n(7111)},7623:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.LogManager=void 0;var a=n(3903),s=n(5224),u=n(1202),c=n(7173),l=n(8858),g=n(5076),p=n(7294),d=n(7543),f=n(2974),h=n(6089),v=function(e){function t(t){var n=e.call(this)||this;return n.name="VWO Logger",n.requestId=(0,a.v4)(),n.level=l.LogLevelEnum.ERROR,n.prefix="VWO-SDK",n.shouldLogToStandardOutput=!1,n.config=t,n.config.name=t.name||n.name,n.config.requestId=t.requestId||n.requestId,n.config.level=t.level||n.level,n.config.prefix=t.prefix||n.prefix,n.config.dateTimeFormat=t.dateTimeFormat||n.dateTimeFormat,n.config.shouldLogToStandardOutput=t.shouldLogToStandardOutput||n.shouldLogToStandardOutput,n.transportManager=new u.LogTransportManager(n.config),n.handleTransports(),n}return o(t,e),t.prototype.dateTimeFormat=function(){return(new Date).toISOString()},t.prototype.injectServiceContainer=function(e){this.serviceContainer=e},t.prototype.handleTransports=function(){var e=this.config.transports;(null==e?void 0:e.length)?this.addTransports(this.config.transports):this.config.transport&&(0,c.isObject)(this.config.transport)&&this.addTransport(this.config.transport)},t.prototype.addTransport=function(e){this.transportManager.addTransport(e)},t.prototype.addTransports=function(e){for(var t=0;t<e.length;t++)this.addTransport(e[t])},t.prototype.trace=function(e){this.transportManager.log(l.LogLevelEnum.TRACE,e)},t.prototype.debug=function(e){this.transportManager.log(l.LogLevelEnum.DEBUG,e)},t.prototype.info=function(e){this.transportManager.log(l.LogLevelEnum.INFO,e)},t.prototype.warn=function(e){this.transportManager.log(l.LogLevelEnum.WARN,e)},t.prototype.error=function(e){this.transportManager.log(l.LogLevelEnum.ERROR,e)},t.prototype.errorLog=function(e,t,n,r){void 0===t&&(t={}),void 0===n&&(n={}),void 0===r&&(r=!0);try{var o=(0,g.buildMessage)(f.ErrorLogMessagesEnum[e],t);if(this.error(o),r){var a=i(i(i({},n),t),{msg_t:e,msg:o,lt:l.LogLevelEnum.ERROR.toString(),cg:p.DebuggerCategoryEnum.ERROR});(0,d.sendDebugEventToVWO)(this.serviceContainer,a)}}catch(e){console.error("Got error while logging error"+(0,h.getFormattedErrorMessage)(e))}},t}(s.Logger);t.LogManager=v},7666:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalRequestModel=void 0;var r=n(477),o=function(){function e(e,t,n,o){this.timeout=r.Constants.EVENTS_CALL_TIMEOUT,this.url=e,this.query=t,this.body=n,this.headers=o}return e.prototype.setQuery=function(e){this.query=e},e.prototype.getQuery=function(){return this.query},e.prototype.setBody=function(e){this.body=e},e.prototype.getBody=function(){return this.body},e.prototype.setBaseUrl=function(e){this.url=e},e.prototype.getBaseUrl=function(){return this.url},e.prototype.setTimeout=function(e){this.timeout=e},e.prototype.getTimeout=function(){return this.timeout},e.prototype.setHeaders=function(e){this.headers=e},e.prototype.getHeaders=function(){return this.headers},e.prototype.setDevelopmentMode=function(e){this.isDevelopmentMode=e},e.prototype.getDevelopmentMode=function(){return this.isDevelopmentMode},e}();t.GlobalRequestModel=o},7788:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSettingsAndAddCampaignsToRules=function(e,t,n){t.settings=new r.SettingsModel(e),t.originalSettings=e;var s=t.settings.getCampaigns();s.forEach((function(e,t){(0,o.setVariationAllocation)(e,n),s[t]=e})),(0,i.addLinkedCampaignsToSettings)(t.settings),(0,a.addIsGatewayServiceRequiredFlag)(t.settings)};var r=n(9540),o=n(5479),i=n(6089),a=n(596)},7846:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogMessageBuilder=void 0;var r=n(8858),o="[1m",i="[0m",a=function(){function e(e,t){this.loggerConfig=e,this.transportConfig=t,this.prefix=this.transportConfig.prefix||this.loggerConfig.prefix||"",this.dateTimeFormat=this.transportConfig.dateTimeFormat||this.loggerConfig.dateTimeFormat}return e.prototype.formatMessage=function(e,t){return"[".concat(this.getFormattedLevel(e),"]: ").concat(this.getFormattedPrefix(this.prefix)," ").concat(this.getFormattedDateTime()," ").concat(t)},e.prototype.getFormattedPrefix=function(e){return this.loggerConfig.isAnsiColorEnabled?"".concat(o).concat("[32m").concat(e).concat(i):"".concat(e)},e.prototype.getFormattedLevel=function(e){var t,n,a,s=e.toUpperCase();return this.loggerConfig.isAnsiColorEnabled?((t={})[r.LogLevelEnum.TRACE]="".concat(o).concat("[30m").concat(s).concat(i),t[r.LogLevelEnum.DEBUG]="".concat(o).concat("[94m").concat(s).concat(i),t[r.LogLevelEnum.INFO]="".concat(o).concat("[36m").concat(s).concat(i),t[r.LogLevelEnum.WARN]="".concat(o).concat("[33m").concat(s).concat(i),t[r.LogLevelEnum.ERROR]="".concat(o).concat("[31m").concat(s).concat(i),a=t):((n={})[r.LogLevelEnum.TRACE]=s,n[r.LogLevelEnum.DEBUG]=s,n[r.LogLevelEnum.INFO]=s,n[r.LogLevelEnum.WARN]=s,n[r.LogLevelEnum.ERROR]=s,a=n),a[e]},e.prototype.getFormattedDateTime=function(){return this.dateTimeFormat()},e}();t.LogMessageBuilder=a},8198:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CampaignModel=void 0;var r=n(976),o=n(2160),i=n(1463),a=function(){function e(){this.variations=[],this.metrics=[],this.variables=[]}return e.prototype.copy=function(e){this.metrics=e.metrics,this.variations=e.variations,this.variables=e.variables,this.processCampaignKeys(e)},e.prototype.modelFromDictionary=function(e){return this.processCampaignProperties(e),this.processCampaignKeys(e),this},e.prototype.processCampaignProperties=function(e){var t=this;e.variables&&(e.variables.constructor==={}.constructor?this.variables=[]:e.variables.forEach((function(e){t.variables.push(o.VariableModel.modelFromDictionary(e))}))),e.variations&&(e.variations.constructor==={}.constructor?this.variations=[]:e.variations.forEach((function(e){t.variations.push((new i.VariationModel).modelFromDictionary(e))}))),e.metrics&&(e.metrics&&e.metrics.constructor==={}.constructor?this.metrics=[]:(e.metrics||[]).forEach((function(e){t.metrics.push((new r.MetricModel).modelFromDictionary(e))})))},e.prototype.processCampaignKeys=function(e){this.id=e.id,this.percentTraffic=e.percentTraffic,this.name=e.name,this.variationId=e.variationId,this.campaignId=e.campaignId,this.ruleKey=e.ruleKey,this.isForcedVariationEnabled=e.isForcedVariationEnabled,this.isUserListEnabled=e.isUserListEnabled,this.segments=e.segments,this.key=e.key,this.type=e.type,this.salt=e.salt},e.prototype.getId=function(){return this.id},e.prototype.getName=function(){return this.name},e.prototype.getSegments=function(){return this.segments},e.prototype.getTraffic=function(){return this.percentTraffic},e.prototype.getType=function(){return this.type},e.prototype.getIsForcedVariationEnabled=function(){return this.isForcedVariationEnabled},e.prototype.getIsUserListEnabled=function(){return this.isUserListEnabled},e.prototype.getKey=function(){return this.key},e.prototype.getMetrics=function(){return this.metrics},e.prototype.getVariations=function(){return this.variations},e.prototype.getVariables=function(){return this.variables},e.prototype.getRuleKey=function(){return this.ruleKey},e.prototype.getSalt=function(){return this.salt},e}();t.CampaignModel=a},8296:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceContainer=void 0;var o=n(2404),i=r(n(3289)),a=n(7173),s=function(){function e(e){this.vwoOptions=e,this.HooksService=new i.default(this.vwoOptions),this.SegmentationManager=new o.SegmentationManager}return e.prototype.getLogManager=function(){return this.logManager},e.prototype.setLogManager=function(e){this.logManager=e},e.prototype.getSettingsService=function(){return this.SettingsService},e.prototype.setSettingsService=function(e){this.SettingsService=e},e.prototype.getHooksService=function(){return this.HooksService},e.prototype.getVWOOptions=function(){return this.vwoOptions},e.prototype.getBatchEventsQueue=function(){return this.BatchEventsQueue},e.prototype.setBatchEventsQueue=function(e){this.BatchEventsQueue=e},e.prototype.getSegmentationManager=function(){return this.SegmentationManager},e.prototype.getSettings=function(){return this.SettingsModel},e.prototype.setSettings=function(e){this.SettingsModel=e},e.prototype.getUpdatedEndpointWithCollectionPrefix=function(e){return this.SettingsModel&&e&&this.SettingsModel.getCollectionPrefix()&&(0,a.isString)(this.SettingsModel.getCollectionPrefix())?"/".concat(this.SettingsModel.getCollectionPrefix()).concat(e):e},e.prototype.getNetworkManager=function(){return this.NetworkManager},e.prototype.setNetworkManager=function(e){this.NetworkManager=e},e.prototype.getStorageConnector=function(){return this.Storage?this.Storage.getConnector():null},e.prototype.setStorage=function(e){this.Storage=e},e.prototype.injectServiceContainer=function(e){this.SettingsService&&this.SettingsService.injectServiceContainer(e),this.NetworkManager&&this.NetworkManager.injectServiceContainer(e),this.BatchEventsQueue&&this.BatchEventsQueue.injectServiceContainer(e),this.logManager&&this.logManager.injectServiceContainer(e)},e.prototype.setShouldWaitForTrackingCalls=function(e){this.shouldWaitForTrackingCalls=e},e.prototype.getShouldWaitForTrackingCalls=function(){return this.shouldWaitForTrackingCalls},e}();t.ServiceContainer=s},8341:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkServerLessClient=void 0;var r=n(1913),o=n(5576),i=function(){function e(e){this.logManager=e}return e.prototype.GET=function(e){var t=new o.Deferred;return(0,r.sendGetCall)(e,this.logManager).then((function(e){t.resolve(e)})).catch((function(e){t.reject(e)})),t.promise},e.prototype.POST=function(e){var t=new o.Deferred;return(0,r.sendPostCall)(e,this.logManager).then((function(e){t.resolve(e)})).catch((function(e){t.reject(e)})),t.promise},e}();t.NetworkServerLessClient=i},8606:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextModel=void 0;var r=n(3166),o=n(4334),i=n(6089),a=function(){function e(){}return e.prototype.modelFromDictionary=function(e,t){return this.id=e.id,this.userAgent=e.userAgent,this.ipAddress=e.ipAddress,"undefined"!=typeof process||"undefined"==typeof XMLHttpRequest||e.userAgent||(this.userAgent=navigator.userAgent),(null==e?void 0:e.customVariables)&&(this.customVariables=e.customVariables),(null==e?void 0:e.variationTargetingVariables)&&(this.variationTargetingVariables=e.variationTargetingVariables),(null==e?void 0:e._vwo)&&(this._vwo=(new r.ContextVWOModel).modelFromDictionary(e._vwo)),(null==e?void 0:e.postSegmentationVariables)&&(this.postSegmentationVariables=e.postSegmentationVariables),this._vwo_uuid=(0,o.getUUID)(this.id.toString(),t.accountId.toString()),(null==e?void 0:e.sessionId)?this.sessionId=e.sessionId:this.sessionId=(0,i.getCurrentUnixTimestamp)(),this},e.prototype.getId=function(){var e;return null===(e=this.id)||void 0===e?void 0:e.toString()},e.prototype.getUserAgent=function(){return this.userAgent},e.prototype.getIpAddress=function(){return this.ipAddress},e.prototype.getCustomVariables=function(){return this.customVariables},e.prototype.setCustomVariables=function(e){this.customVariables=e},e.prototype.getVariationTargetingVariables=function(){return this.variationTargetingVariables},e.prototype.setVariationTargetingVariables=function(e){this.variationTargetingVariables=e},e.prototype.getVwo=function(){return this._vwo},e.prototype.setVwo=function(e){this._vwo=e},e.prototype.getPostSegmentationVariables=function(){return this.postSegmentationVariables},e.prototype.setPostSegmentationVariables=function(e){this.postSegmentationVariables=e},e.prototype.getUuid=function(){return this._vwo_uuid},e.prototype.getSessionId=function(){return this.sessionId},e}();t.ContextModel=a},8611:e=>{"use strict";e.exports=require("http")},8634:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EdgeConfigModel=void 0;var r=n(477),o=function(){function e(){this.shouldWaitForTrackingCalls=!0}return e.prototype.modelFromDictionary=function(e){return e.shouldWaitForTrackingCalls&&(this.shouldWaitForTrackingCalls=e.shouldWaitForTrackingCalls),e.maxEventsToBatch?this.maxEventsToBatch=e.maxEventsToBatch:this.maxEventsToBatch=r.Constants.MAX_EVENTS_PER_REQUEST,this},e.prototype.getShouldWaitForTrackingCalls=function(){return this.shouldWaitForTrackingCalls},e.prototype.getMaxEventsToBatch=function(){return this.maxEventsToBatch},e}();t.EdgeConfigModel=o},8671:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsoleTransport=void 0;var r=n(8858),o=function(){function e(e){void 0===e&&(e={}),this.config=e,this.level=this.config.level}return e.prototype.trace=function(e){this.consoleLog(r.LogLevelEnum.TRACE,e)},e.prototype.debug=function(e){this.consoleLog(r.LogLevelEnum.DEBUG,e)},e.prototype.info=function(e){this.consoleLog(r.LogLevelEnum.INFO,e)},e.prototype.warn=function(e){this.consoleLog(r.LogLevelEnum.WARN,e)},e.prototype.error=function(e){this.consoleLog(r.LogLevelEnum.ERROR,e)},e.prototype.consoleLog=function(e,t){console[e](t)},e}();t.ConsoleTransport=o},8858:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevelEnum=void 0,function(e){e.TRACE="trace",e.DEBUG="debug",e.INFO="info",e.WARN="warn",e.ERROR="error"}(n||(t.LogLevelEnum=n={}))},8996:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImpactCapmaignModel=void 0;var n=function(){function e(){}return e.prototype.modelFromDictionary=function(e){return this.type=e.type,this.campaignId=e.campaignId,this},e.prototype.getCampaignId=function(){return this.campaignId},e.prototype.getType=function(){return this.type},e}();t.ImpactCapmaignModel=n},9227:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentOperandValueEnum=void 0,function(e){e[e.LOWER_VALUE=1]="LOWER_VALUE",e[e.STARTING_ENDING_STAR_VALUE=2]="STARTING_ENDING_STAR_VALUE",e[e.STARTING_STAR_VALUE=3]="STARTING_STAR_VALUE",e[e.ENDING_STAR_VALUE=4]="ENDING_STAR_VALUE",e[e.REGEX_VALUE=5]="REGEX_VALUE",e[e.EQUAL_VALUE=6]="EQUAL_VALUE",e[e.GREATER_THAN_VALUE=7]="GREATER_THAN_VALUE",e[e.GREATER_THAN_EQUAL_TO_VALUE=8]="GREATER_THAN_EQUAL_TO_VALUE",e[e.LESS_THAN_VALUE=9]="LESS_THAN_VALUE",e[e.LESS_THAN_EQUAL_TO_VALUE=10]="LESS_THAN_EQUAL_TO_VALUE"}(n||(t.SegmentOperandValueEnum=n={}))},9284:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.createAndSendImpressionForVariationShown=void 0;var i=n(1943),a=n(7111),s=n(5479),u=n(5479),c=n(477);t.createAndSendImpressionForVariationShown=function(e,t,n,l,g){return r(void 0,void 0,void 0,(function(){var r,p,d,f,h,v;return o(this,(function(o){switch(o.label){case 0:return r=(0,i.getEventsBaseProperties)(e.getSettingsService(),a.EventEnum.VWO_VARIATION_SHOWN,encodeURIComponent(l.getUserAgent()),l.getIpAddress()),p=(0,i.getTrackUserPayloadData)(e,a.EventEnum.VWO_VARIATION_SHOWN,t,n,l),d=(0,s.getCampaignKeyFromCampaignId)(e.getSettings(),t),f=(0,u.getVariationNameFromCampaignIdAndVariationId)(e.getSettings(),t,n),h="",h=g===d?c.Constants.IMPACT_ANALYSIS:null==d?void 0:d.split("".concat(g,"_"))[1],v=(0,s.getCampaignTypeFromCampaignId)(e.getSettings(),t),e.getBatchEventsQueue()?(e.getBatchEventsQueue().enqueue(p),[3,3]):[3,1];case 1:return[4,(0,i.sendPostApiRequest)(e,r,p,l.getId(),{},{campaignKey:h,variationName:f,featureKey:g,campaignType:v})];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))}},9308:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.sendSdkInitEvent=function(e,t,n){return r(this,void 0,void 0,(function(){var r,s;return o(this,(function(o){switch(o.label){case 0:return r=(0,i.getEventsBaseProperties)(n.getSettingsService(),a.EventEnum.VWO_INIT_CALLED),s=(0,i.getSDKInitEventPayload)(n.getSettingsService(),a.EventEnum.VWO_INIT_CALLED,e,t),n.getBatchEventsQueue()?(n.getBatchEventsQueue().enqueue(s),[3,3]):[3,1];case 1:return[4,(0,i.sendEvent)(n,r,s,a.EventEnum.VWO_INIT_CALLED).catch((function(){}))];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))},t.sendSDKUsageStatsEvent=function(e,t,n){return r(this,void 0,void 0,(function(){var r,s;return o(this,(function(o){switch(o.label){case 0:return r=(0,i.getEventsBaseProperties)(t.getSettingsService(),a.EventEnum.VWO_USAGE_STATS,null,null,!0,e),s=(0,i.getSDKUsageStatsEventPayload)(t.getSettingsService(),a.EventEnum.VWO_USAGE_STATS,e,n),t.getBatchEventsQueue()?(t.getBatchEventsQueue().enqueue(s),[3,3]):[3,1];case 1:return[4,(0,i.sendEvent)(t,r,s,a.EventEnum.VWO_USAGE_STATS).catch((function(){}))];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))};var i=n(1943),a=n(7111)},9376:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Connector=void 0;t.Connector=function(){}},9455:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateTrafficAndGetVariation=t.checkWhitelistingAndPreSeg=void 0;var i=n(7173),a=n(6947),s=n(1155),u=n(2974),c=n(6365),l=n(3991),g=n(7173),p=n(477),d=n(5479),f=n(6089),h=n(5076),v=n(6254),E=n(4334),y=n(834);t.checkWhitelistingAndPreSeg=function(e,t,n,i,s,c,g,f){return r(void 0,void 0,void 0,(function(){var r,S,_,I,T,b,O,A;return o(this,(function(o){switch(o.label){case 0:return r=(0,E.getUUID)(i.getId(),e.getSettings().getAccountId()),S=n.getId(),n.getType()!==a.CampaignTypeEnum.AB?[3,3]:(i.setVariationTargetingVariables(Object.assign({},i.getVariationTargetingVariables(),{_vwoUserId:n.getIsUserListEnabled()?r:i.getId()})),Object.assign(f,{variationTargetingVariables:i.getVariationTargetingVariables()}),n.getIsForcedVariationEnabled()?[4,m(n,i,e)]:[3,2]);case 1:return(_=o.sent())&&Object.keys(_).length>0?[2,[!0,_]]:[3,3];case 2:e.getLogManager().info((0,h.buildMessage)(u.InfoLogMessagesEnum.WHITELISTING_SKIP,{campaignKey:n.getRuleKey(),userId:i.getId()})),o.label=3;case 3:if(i.setCustomVariables(Object.assign({},i.getCustomVariables(),{_vwoUserId:n.getIsUserListEnabled()?r:i.getId()})),Object.assign(f,{customVariables:i.getCustomVariables()}),I=(0,d.getGroupDetailsIfCampaignPartOfIt)(e.getSettings(),n.getId(),n.getType()===a.CampaignTypeEnum.PERSONALIZE?n.getVariations()[0].getId():null).groupId,!(T=null==c?void 0:c.get(I)))return[3,4];if(n.getType()===a.CampaignTypeEnum.AB){if(T===S)return[2,[!0,null]]}else if(n.getType()===a.CampaignTypeEnum.PERSONALIZE&&T===S+"_"+n.getVariations()[0].getId())return[2,[!0,null]];return[2,[!1,null]];case 4:return I?[4,(new y.StorageDecorator).getFeatureFromStorage("".concat(p.Constants.VWO_META_MEG_KEY).concat(I),i,g,e)]:[3,6];case 5:if((b=o.sent())&&b.experimentKey&&b.experimentId)return e.getLogManager().info((0,h.buildMessage)(u.InfoLogMessagesEnum.MEG_CAMPAIGN_FOUND_IN_STORAGE,{campaignKey:b.experimentKey,userId:i.getId()})),b.experimentId===S?n.getType()===a.CampaignTypeEnum.PERSONALIZE?b.experimentVariationId===n.getVariations()[0].getId()?[2,[!0,null]]:(c.set(I,b.experimentId+"_"+b.experimentVariationId),[2,[!1,null]]):[2,[!0,null]]:(-1!=b.experimentVariationId?c.set(I,b.experimentId+"_"+b.experimentVariationId):c.set(I,b.experimentId),[2,[!1,null]]);o.label=6;case 6:return[4,(new l.CampaignDecisionService).getPreSegmentationDecision(n,i,e)];case 7:return(O=o.sent())&&I?[4,(0,v.evaluateGroups)(e,t,I,s,i,g)]:[3,9];case 8:return(A=o.sent())&&A.id===S?A.type===a.CampaignTypeEnum.AB||A.variations[0].id===n.getVariations()[0].getId()?[2,[!0,null]]:(c.set(I,A.id+"_"+A.variations[0].id),[2,[!1,null]]):A?(A.type===a.CampaignTypeEnum.AB?c.set(I,A.id):c.set(I,A.id+"_"+A.variations[0].id),[2,[!1,null]]):(c.set(I,-1),[2,[!1,null]]);case 9:return[2,[O,null]]}}))}))},t.evaluateTrafficAndGetVariation=function(e,t,n){var r=(new l.CampaignDecisionService).getVariationAlloted(n,e.getSettings().getAccountId(),t,e);return r?(e.getLogManager().info((0,h.buildMessage)(u.InfoLogMessagesEnum.USER_CAMPAIGN_BUCKET_INFO,{campaignKey:t.getType()===a.CampaignTypeEnum.AB?t.getKey():t.getName()+"_"+t.getRuleKey(),userId:n,status:"got variation:".concat(r.getKey())})),r):(e.getLogManager().info((0,h.buildMessage)(u.InfoLogMessagesEnum.USER_CAMPAIGN_BUCKET_INFO,{campaignKey:t.getType()===a.CampaignTypeEnum.AB?t.getKey():t.getName()+"_"+t.getRuleKey(),userId:n,status:"did not get any variation"})),null)};var m=function(e,t,n){return r(void 0,void 0,void 0,(function(){var r,i,c;return o(this,(function(o){switch(o.label){case 0:return[4,S(e,t,n)];case 1:return r=o.sent(),i=r?s.StatusEnum.PASSED:s.StatusEnum.FAILED,c=r?r.variation.key:"",n.getLogManager().info((0,h.buildMessage)(u.InfoLogMessagesEnum.WHITELISTING_STATUS,{userId:t.getId(),campaignKey:e.getType()===a.CampaignTypeEnum.AB?e.getKey():e.getName()+"_"+e.getRuleKey(),status:i,variationString:c})),[2,r]}}))}))},S=function(e,t,n){return r(void 0,void 0,void 0,(function(){var r,s,p,v,E,y;return o(this,(function(o){switch(o.label){case 0:return r=[],s=[],e.getVariations().forEach((function(o){if(!(0,g.isObject)(o.getSegments())||Object.keys(o.getSegments()).length){if((0,g.isObject)(o.getSegments())){var c=n.getSegmentationManager().validateSegmentation(o.getSegments(),t.getVariationTargetingVariables());(c=(0,i.isPromise)(c)?c:Promise.resolve(c)).then((function(e){e&&r.push((0,f.cloneObject)(o))})),s.push(c)}}else n.getLogManager().info((0,h.buildMessage)(u.InfoLogMessagesEnum.WHITELISTING_SKIP,{campaignKey:e.getType()===a.CampaignTypeEnum.AB?e.getKey():e.getName()+"_"+e.getRuleKey(),userId:t.getId(),variation:o.getKey()?"for variation: ".concat(o.getKey()):""}))})),[4,Promise.all(s)];case 1:if(o.sent(),r.length>1){for((0,d.scaleVariationWeights)(r),v=0,E=0,y=0;v<r.length;v++)y=(0,d.assignRangeValues)(r[v],E),E+=y;p=(new l.CampaignDecisionService).getVariation(r,(new c.DecisionMaker).calculateBucketValue((0,d.getBucketingSeed)(t.getId(),e,null)))}else p=r[0];return p?[2,{variation:p,variationName:p.name,variationId:p.id}]:[2]}}))}))}},9540:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsModel=void 0;var r=n(8198),o=n(9594),i=function(){function e(e){var t=this;return this.f=[],this.features=[],this.c=[],this.campaigns=[],this.campaignGroups={},this.cG={},this.groups={},this.g={},this.sdkKey=e.sK||e.sdkKey,this.accountId=e.a||e.accountId,this.version=e.v||e.version,this.collectionPrefix=e.collectionPrefix,this.usageStatsAccountId=e.usageStatsAccountId,(e.f&&e.f.constructor!=={}.constructor||e.features&&e.features.constructor!=={}.constructor)&&(e.f||e.features).forEach((function(e){t.features.push((new o.FeatureModel).modelFromDictionary(e))})),(e.c&&e.c.constructor!=={}.constructor||e.campaigns&&e.campaigns.constructor!=={}.constructor)&&(e.c||e.campaigns).forEach((function(e){t.campaigns.push((new r.CampaignModel).modelFromDictionary(e))})),(e.cG||e.campaignGroups)&&(this.campaignGroups=e.cG||e.campaignGroups),(e.g||e.groups)&&(this.groups=e.g||e.groups),e.pollInterval&&(this.pollInterval=e.pollInterval),this}return e.prototype.getFeatures=function(){return this.features},e.prototype.getCampaigns=function(){return this.campaigns},e.prototype.getSdkkey=function(){return this.sdkKey},e.prototype.getAccountId=function(){return this.accountId},e.prototype.getVersion=function(){return this.version},e.prototype.getCollectionPrefix=function(){return this.collectionPrefix},e.prototype.getCampaignGroups=function(){return this.campaignGroups},e.prototype.getGroups=function(){return this.groups},e.prototype.setPollInterval=function(e){this.pollInterval=e},e.prototype.getPollInterval=function(){return this.pollInterval},e.prototype.getUsageStatsAccountId=function(){return this.usageStatsAccountId},e}();t.SettingsModel=i},9594:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureModel=void 0;var r=n(8996),o=n(976),i=n(2258),a=function(){function e(){this.m=[],this.metrics=[],this.rules=[],this.impactCampaign=null,this.isDebuggerEnabled=!1,this.rulesLinkedCampaign=[],this.isGatewayServiceRequired=!1}return e.prototype.modelFromDictionary=function(e){var t,n,a,s=this;if(this.id=e.id,this.key=e.key,this.name=e.name,this.type=e.type,(null==e?void 0:e.isDebuggerEnabled)&&(this.isDebuggerEnabled=e.isDebuggerEnabled),(null==e?void 0:e.isGatewayServiceRequired)&&(this.isGatewayServiceRequired=e.isGatewayServiceRequired),e.impactCampaign&&(this.impactCampaign=(new r.ImpactCapmaignModel).modelFromDictionary(e.impactCampaign)),e.m&&e.m.constructor==={}.constructor||(null===(t=e.metrics)||void 0===t?void 0:t.constructor)==={}.constructor)this.metrics=[];else{var u=e.m||e.metrics;null==u||u.forEach((function(e){s.metrics.push((new o.MetricModel).modelFromDictionary(e))}))}if((null===(n=null==e?void 0:e.rules)||void 0===n?void 0:n.constructor)==={}.constructor)this.rules=[];else{var c=e.rules;null==c||c.forEach((function(e){s.rules.push((new i.RuleModel).modelFromDictionary(e))}))}if((null==e?void 0:e.rulesLinkedCampaign)&&(null===(a=e.rulesLinkedCampaign)||void 0===a?void 0:a.constructor)!=={}.constructor){var l=e.rulesLinkedCampaign;this.rulesLinkedCampaign=l}return this},e.prototype.getName=function(){return this.name},e.prototype.getType=function(){return this.type},e.prototype.getId=function(){return this.id},e.prototype.getKey=function(){return this.key},e.prototype.getRules=function(){return this.rules},e.prototype.getImpactCampaign=function(){return this.impactCampaign},e.prototype.getRulesLinkedCampaign=function(){return this.rulesLinkedCampaign},e.prototype.setRulesLinkedCampaign=function(e){this.rulesLinkedCampaign=e},e.prototype.getMetrics=function(){return this.metrics},e.prototype.getIsGatewayServiceRequired=function(){return this.isGatewayServiceRequired},e.prototype.setIsGatewayServiceRequired=function(e){this.isGatewayServiceRequired=e},e.prototype.getIsDebuggerEnabled=function(){return this.isDebuggerEnabled},e}();t.FeatureModel=a},9600:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsService=void 0;var a=n(4464),s=n(5576),u=n(477),c=n(3388),l=n(5212),g=n(2974),p=n(5600),d=n(5076),f=n(1943),h=n(7543),v=n(6089),E=n(6167),y=n(1566),m=n(7173),S=function(){function e(e,t){var n,r,o,i,a,s;if(this.isGatewayServiceProvided=!1,this.settingsFetchTime=void 0,this.isSettingsValid=!1,this.proxyProvided=!1,this.isStorageServiceProvided=!1,this.isEdgeEnvironment=!1,this.isSettingsProvidedInInit=!1,this.startTimeForInit=void 0,this.gatewayServiceConfig={hostname:null,protocol:null,port:null},this.logManager=t,this.sdkKey=e.sdkKey,this.accountId=e.accountId,this.expiry=(null===(n=null==e?void 0:e.settings)||void 0===n?void 0:n.expiry)||u.Constants.SETTINGS_EXPIRY,this.networkTimeout=(null===(r=null==e?void 0:e.settings)||void 0===r?void 0:r.timeout)||u.Constants.SETTINGS_TIMEOUT,this.isStorageServiceProvided=(null==e?void 0:e.isStorageServiceProvided)||!1,(null==e?void 0:e.edgeConfig)&&Object.keys(null==e?void 0:e.edgeConfig).length>0&&(this.isEdgeEnvironment=!0),"undefined"==typeof process&&"undefined"!=typeof XMLHttpRequest&&(this.isGatewayServiceProvided=!0),null==e?void 0:e.proxyUrl){this.proxyProvided=!0;var l=void 0;l=e.proxyUrl.startsWith(c.HTTP_PROTOCOL)||e.proxyUrl.startsWith(c.HTTPS_PROTOCOL)?new URL("".concat(e.proxyUrl)):new URL("".concat(c.HTTPS_PROTOCOL).concat(e.proxyUrl)),this.hostname=l.hostname,this.protocol=l.protocol.replace(":",""),l.port&&(this.port=parseInt(l.port))}(null===(o=null==e?void 0:e.gatewayService)||void 0===o?void 0:o.url)?(l=void 0,this.isGatewayServiceProvided=!0,l=e.gatewayService.url.startsWith(c.HTTP_PROTOCOL)||e.gatewayService.url.startsWith(c.HTTPS_PROTOCOL)?new URL("".concat(e.gatewayService.url)):(null===(i=e.gatewayService)||void 0===i?void 0:i.protocol)?new URL("".concat(e.gatewayService.protocol,"://").concat(e.gatewayService.url)):new URL("".concat(c.HTTPS_PROTOCOL).concat(e.gatewayService.url)),this.proxyProvided?(this.gatewayServiceConfig.hostname=l.hostname,this.gatewayServiceConfig.protocol=l.protocol.replace(":",""),l.port?this.gatewayServiceConfig.port=parseInt(l.port):(null===(s=e.gatewayService)||void 0===s?void 0:s.port)&&(this.gatewayServiceConfig.port=e.gatewayService.port)):(this.hostname=l.hostname,this.protocol=l.protocol.replace(":",""),l.port?this.port=parseInt(l.port):(null===(a=e.gatewayService)||void 0===a?void 0:a.port)&&(this.port=e.gatewayService.port))):this.proxyProvided||(this.hostname=u.Constants.HOST_NAME),this.logManager.debug((0,d.buildMessage)(g.DebugLogMessagesEnum.SERVICE_INITIALIZED,{service:"Settings Manager"}))}return e.prototype.injectServiceContainer=function(e){this.serviceContainer=e},e.prototype.isProxyProvided=function(){return this.proxyProvided},e.prototype.normalizeSettings=function(e){var t=r({},e);return t.features&&0!==Object.keys(t.features).length||(t.features=[]),t.campaigns&&0!==Object.keys(t.campaigns).length||(t.campaigns=[]),t},e.prototype.fetchSettings=function(e,t){var n=this;void 0===e&&(e=!1),void 0===t&&(t=E.ApiEnum.INIT);var r=new s.Deferred;this.sdkKey&&this.accountId||r.reject(new Error("sdkKey is required for fetching account settings. Aborting!"));var o=(0,f.getSettingsPath)(this.sdkKey,this.accountId),i=this.serviceContainer.getNetworkManager().getRetryConfig();o.platform=u.Constants.PLATFORM,o.sn=u.Constants.SDK_NAME,o.sv=u.Constants.SDK_VERSION,o["api-version"]=u.Constants.API_VERSION,this.serviceContainer.getNetworkManager().getConfig().getDevelopmentMode()||(o.s="prod");var c=u.Constants.SETTINGS_ENDPOINT;e&&(c=u.Constants.WEBHOOK_SETTINGS_ENDPOINT);try{var g=Date.now(),p=new a.RequestModel(this.hostname,l.HttpMethodEnum.GET,c,o,null,null,this.protocol,this.port,i);return p.setTimeout(this.networkTimeout),this.serviceContainer.getNetworkManager().get(p).then((function(o){if(n.settingsFetchTime=Date.now()-g,o.getTotalAttempts()>0){var i=(0,f.createNetWorkAndRetryDebugEvent)(o,"",e?E.ApiEnum.UPDATE_SETTINGS:t,c);(0,h.sendDebugEventToVWO)(n.serviceContainer,i)}r.resolve(o.getData())})).catch((function(o){var i=(0,f.createNetWorkAndRetryDebugEvent)(o,"",e?E.ApiEnum.UPDATE_SETTINGS:t,c);(0,h.sendDebugEventToVWO)(n.serviceContainer,i),r.reject(o)})),r.promise}catch(n){return this.logManager.errorLog("ERROR_FETCHING_SETTINGS",{err:(0,v.getFormattedErrorMessage)(n)},{an:e?E.ApiEnum.UPDATE_SETTINGS:t},!1),r.reject(n),r.promise}},e.prototype.getSettings=function(){return o(this,void 0,void 0,(function(){var e,t,n,r,o,a;return i(this,(function(i){switch(i.label){case 0:e=new s.Deferred,i.label=1;case 1:return i.trys.push([1,13,,14]),this.isStorageServiceProvided?[4,(t=new y.StorageService(this.serviceContainer)).getSettingsFromStorage(this.accountId,this.sdkKey,!this.isEdgeEnvironment)]:[3,9];case 2:return!(n=i.sent())||(0,m.isEmptyObject)(n)?[3,3]:(this.logManager.info((0,d.buildMessage)(g.InfoLogMessagesEnum.SETTINGS_FETCH_FROM_CACHE)),e.resolve(n),[3,8]);case 3:return this.logManager.info((0,d.buildMessage)(g.InfoLogMessagesEnum.SETTINGS_CACHE_MISS)),[4,this.fetchSettings()];case 4:return r=i.sent(),[4,this.normalizeSettings(r)];case 5:return o=i.sent(),this.isSettingsValid=(new p.SettingsSchema).isSettingsValid(o),this.isSettingsValid?(this.logManager.info((0,d.buildMessage)(g.InfoLogMessagesEnum.SETTINGS_FETCH_SUCCESS)),[4,t.setSettingsInStorage(this.accountId,this.sdkKey,o)]):[3,7];case 6:return i.sent(),e.resolve(o),[3,8];case 7:this.logManager.errorLog("INVALID_SETTINGS_SCHEMA",{},{an:E.ApiEnum.INIT},!1),e.resolve({}),i.label=8;case 8:return[3,12];case 9:return[4,this.fetchSettings()];case 10:return r=i.sent(),[4,this.normalizeSettings(r)];case 11:o=i.sent(),this.isSettingsValid=(new p.SettingsSchema).isSettingsValid(o),this.isSettingsValid?(this.logManager.info(g.InfoLogMessagesEnum.SETTINGS_FETCH_SUCCESS),e.resolve(o)):(this.logManager.errorLog("INVALID_SETTINGS_SCHEMA",{},{an:E.ApiEnum.INIT},!1),e.resolve({})),i.label=12;case 12:return[3,14];case 13:return a=i.sent(),this.logManager.errorLog("ERROR_FETCHING_SETTINGS",{err:(0,v.getFormattedErrorMessage)(a)},{an:E.ApiEnum.INIT},!1),e.resolve({}),[3,14];case 14:return[2,e.promise]}}))}))},e}();t.SettingsService=S},9708:e=>{"use strict";e.exports=require("murmurhash")},9717:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequestHandler=void 0;var n=function(){function e(){}return e.prototype.createRequest=function(e,t){if(!(null!==t.getBaseUrl()&&void 0!==t.getBaseUrl()||null!==e.getUrl()&&void 0!==e.getUrl()))return null;e.setUrl(e.getUrl()||t.getBaseUrl()),e.setTimeout(e.getTimeout()||t.getTimeout()),e.setBody(e.getBody()||t.getBody()),e.setHeaders(e.getHeaders()||t.getHeaders());var n=e.getQuery()||{},r=t.getQuery()||{};for(var o in r)Object.prototype.hasOwnProperty.call(n,o)||(n[o]=r[o]);return e.setQuery(n),e},e}();t.RequestHandler=n},9799:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.VWO=void 0,t.init=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i,h;return o(this,(function(o){t=g.ApiEnum.INIT,n=(new Date).toISOString();try{return r="[ERROR]: VWO-SDK ".concat(n," "),(0,a.isObject)(e)||(h=r+(0,c.buildMessage)(u.ErrorLogMessagesEnum.INVALID_OPTIONS),console.error(h)),(null==e?void 0:e.sdkKey)&&(0,a.isString)(null==e?void 0:e.sdkKey)||(h=r+(0,c.buildMessage)(u.ErrorLogMessagesEnum.INVALID_SDK_KEY_IN_OPTIONS),console.error(h)),e.accountId||(h=r+(0,c.buildMessage)(u.ErrorLogMessagesEnum.INVALID_ACCOUNT_ID_IN_OPTIONS),console.error(h)),e.isAliasingEnabled&&!e.gatewayService&&(h=r+(0,c.buildMessage)(u.ErrorLogMessagesEnum.INVALID_GATEWAY_URL,{date:n}),console.error(h)),"undefined"==typeof process?e.platform=l.PlatformEnum.CLIENT:e.platform=l.PlatformEnum.SERVER,i=new d(e),f={vwoInitDeferred:new s.Deferred,isSettingsFetched:!1,instance:null},[2,i.then((function(e){return f.isSettingsFetched=!0,f.instance=e,f.vwoInitDeferred.resolve(e),e}))]}catch(e){h=(0,c.buildMessage)(u.ErrorLogMessagesEnum.EXECUTION_FAILED,{apiName:t,err:(0,p.getFormattedErrorMessage)(e)}),console.info("[INFO]: VWO-SDK ".concat((new Date).toISOString()," ").concat(h))}return[2]}))}))},t.onInit=function(){return r(this,void 0,void 0,(function(){var e,t,n;return o(this,(function(r){e=g.ApiEnum.ON_INIT;try{return f.vwoInitDeferred=new s.Deferred,t=(new Date).toISOString(),f.isSettingsFetched?(n=(0,c.buildMessage)(u.InfoLogMessagesEnum.ON_INIT_ALREADY_RESOLVED,{date:t,apiName:e}),console.info(n),f.vwoInitDeferred.resolve(f.instance)):setTimeout((function(){if(!f.isSettingsFetched){var e=(0,c.buildMessage)(u.InfoLogMessagesEnum.ON_INIT_SETTINGS_FAILED,{date:t});console.error(e),f.vwoInitDeferred.reject(new Error("VWO settings could not be fetched"))}}),5e3),[2,f.vwoInitDeferred.promise]}catch(t){n=(0,c.buildMessage)(u.ErrorLogMessagesEnum.EXECUTION_FAILED,{apiName:e,err:(0,p.getFormattedErrorMessage)(t)}),console.info("[INFO]: VWO-SDK ".concat((new Date).toISOString()," ").concat(n))}return[2]}))}))};var i=n(2676),a=n(7173),s=n(5576),u=n(2974),c=n(5076),l=n(2550),g=n(6167),p=n(6089),d=function(){function e(t){return e.setInstance(t)}return e.setInstance=function(e){var t=this,n=Date.now(),r=null==e?void 0:e.vwoBuilder;return this.vwoBuilder=r||new i.VWOBuilder(e),this.instance=this.vwoBuilder.setLogger().setSettingsService().setStorage().setNetworkManager().initPolling().initBatching(),this.vwoBuilder.getSettingsService().startTimeForInit=n,(null==e?void 0:e.settings)?(this.vwoBuilder.getSettingsService().isSettingsProvidedInInit=!0,Promise.resolve(this.vwoBuilder.build(e.settings))):this.vwoBuilder.getSettings().then((function(e){return t.vwoBuilder.build(e)}))},Object.defineProperty(e,"Instance",{get:function(){return this.instance},enumerable:!1,configurable:!0}),e}();t.VWO=d;var f={}},9955:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.TrackApi=void 0;var i=n(6167),a=n(6089),s=n(1943),u=function(){function e(){}return e.prototype.track=function(e,t,n,s){return r(this,void 0,void 0,(function(){var r,u;return o(this,(function(o){switch(o.label){case 0:return(0,a.doesEventBelongToAnyFeature)(t,e.getSettings())?e.getShouldWaitForTrackingCalls()?[4,c(e,t,n,s)]:[3,2]:[3,4];case 1:return o.sent(),[3,3];case 2:c(e,t,n,s),o.label=3;case 3:return e.getHooksService().set({eventName:t,api:i.ApiEnum.TRACK_EVENT}),e.getHooksService().execute(e.getHooksService().get()),[2,(r={},r[t]=!0,r)];case 4:return e.getLogManager().errorLog("EVENT_NOT_FOUND",{eventName:t},{an:i.ApiEnum.TRACK_EVENT,uuid:n.getUuid(),sId:n.getSessionId()}),[2,(u={},u[t]=!1,u)]}}))}))},e}();t.TrackApi=u;var c=function(e,t,n,i){return r(void 0,void 0,void 0,(function(){var r,a;return o(this,(function(o){switch(o.label){case 0:return r=(0,s.getEventsBaseProperties)(e.getSettingsService(),t,encodeURIComponent(n.getUserAgent()),n.getIpAddress()),a=(0,s.getTrackGoalPayloadData)(e,t,i,n),e.getBatchEventsQueue()?(e.getBatchEventsQueue().enqueue(a),[3,3]):[3,1];case 1:return[4,(0,s.sendPostApiRequest)(e,r,a,n.getId(),i)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r={};(()=>{"use strict";var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.getUUID=e.Flag=e.StorageConnector=e.LogLevelEnum=e.onInit=e.init=void 0;var t=n(8858);Object.defineProperty(e,"LogLevelEnum",{enumerable:!0,get:function(){return t.LogLevelEnum}});var o=n(9376);Object.defineProperty(e,"StorageConnector",{enumerable:!0,get:function(){return o.Connector}});var i=n(3090);Object.defineProperty(e,"Flag",{enumerable:!0,get:function(){return i.Flag}});var a=n(4334);Object.defineProperty(e,"getUUID",{enumerable:!0,get:function(){return a.getUUID}});var s=n(9799);Object.defineProperty(e,"init",{enumerable:!0,get:function(){return s.init}}),Object.defineProperty(e,"onInit",{enumerable:!0,get:function(){return s.onInit}})})(),module.exports=r})();
//# sourceMappingURL=vwo-fme-node-sdk.min.js.map